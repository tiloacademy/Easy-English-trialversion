<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>B√© H·ªçc Ti·∫øng Anh</title>
<style>
/* ======================================================
   APP VERSION: 1.2 (Full Architecture)
   RELEASE DATE: 2025-12-20
   STRUCTURE:
   1. VIEW (HTML/CSS)
   2. DATA ENGINE (24 Lessons)
   3. LOGIC ENGINES (Audio, Game, Snake, Learning)
   ====================================================== */

/* --- CSS C∆† B·∫¢N --- */
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #87CEEB; margin: 0; padding: 0; height: 100vh; width: 100vw;
overflow: hidden; display: flex; flex-direction: column; user-select: none; }

/* --- MENU --- */
#menu-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 9999; display: flex; flex-direction: column;
align-items: center; justify-content: flex-start; gap: 10px; overflow-y: auto; padding: 20px 0; }
.menu-title { font-size: 32px; color: #ff6f00; font-weight: bold; margin-bottom: 20px; flex-shrink: 0;}
.btn-menu { background: white; border: 3px solid #00A4EF; color: #00A4EF; padding: 15px 30px; border-radius: 50px; font-size: 18px; font-weight: bold;
box-shadow: 0 5px #ccebfd; cursor: pointer; width: 90%; max-width: 400px; transition: transform 0.1s; margin-bottom: 5px; flex-shrink: 0; }
.btn-menu:active { transform: scale(0.95); background: #f0f8ff; }

/* --- CONTAINER CH√çNH --- */
#main-container { width: 100%; height: 100%; position: relative; }
#learning-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column;
padding: 5px 10px 90px 10px; background: #fff; z-index: 10; }

/* UI H·ªçc T·∫≠p */
.top-bar { height: 50px; display: flex; align-items: center; justify-content: space-between; padding: 0 5px; flex-shrink: 0; }
.btn-home { background: #eee; border: none; width: 40px; height: 40px; border-radius: 50%; font-size: 20px; cursor: pointer; }
.header-title { color: #ff6f00; font-size: 20px; font-weight: bold; }
.learn-img-wrapper { flex: 1; width: 100%; min-height: 0; display: flex; align-items: center; justify-content: center; margin: 5px 0; }
#learn-img { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 15px; }
.info-area { height: 110px; flex-shrink: 0; display: flex; flex-direction: row; align-items: center; justify-content: center; gap: 0px; flex-wrap: wrap; }
.char-block { display: flex; flex-direction: column; align-items: center; justify-content: flex-end; margin: 0; }
.cb-ipa { font-size: 24px; color: red; font-weight: bold; font-family: sans-serif; height: 30px; line-height: 30px; }
.cb-text { font-size: 40px; color: #333; font-weight: bold; height: 50px; line-height: 50px; }
.sent-ipa { font-size: 16px; color: red; font-weight: bold; height: 20px; }
.sent-text { font-size: 24px; color: #333; font-weight: bold; height: 30px; }
.spacer { width: 15px; }
.stars { height: 30px; text-align: center; font-size: 32px; color: #e0e0e0; flex-shrink: 0; }
.stars.active { color: #FFD700; text-shadow: 0 0 5px orange; }
.feedback-text { height: 20px; text-align: center; font-size: 16px; color: #555; font-style: italic; margin-bottom: 5px; }
.action-row { height: 60px; flex-shrink: 0; display: flex; justify-content: center; gap: 15px; align-items: center; margin-bottom: 10px; }
.btn-action { flex: 1; height: 55px; border-radius: 30px; border: none; font-size: 20px; font-weight: bold; cursor: pointer; color: white; display: flex;
align-items: center; justify-content: center; gap: 8px; box-shadow: 0 4px rgba(0,0,0,0.2); max-width: 45%; }
.btn-mic { background: #27ae60; }
.btn-listen { background: #2980b9; }
.btn-game-entry { background: #9b59b6; width: 80%; max-width: none; animation: pulse 1.5s infinite; }
@keyframes pulse { 0% {transform: scale(1);} 50% {transform: scale(1.05);} 100% {transform: scale(1);} }
.nav-row { height: 60px; flex-shrink: 0; display: flex; justify-content: space-between; align-items: center; padding: 0 15px; margin-bottom: 15px; }
.btn-nav { width: 60px; height: 60px; border-radius: 50%; background: #f39c12; color: white; border: none; font-size: 30px; font-weight: bold; cursor: pointer;
box-shadow: 0 4px #d35400; }
.btn-nav:active { transform: translateY(2px); box-shadow: none; }

/* UI Game Chung */
#game-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #fff3e0; z-index: 20; flex-direction: column; }
.game-header { height: 60px; display: flex; justify-content: center; align-items: center; position: relative; background: rgba(255,255,255,0.9); border-bottom: 1px solid #ddd; flex-shrink: 0; z-index: 200; }
.timer-badge { background: white; border: 3px solid #d35400; color: #d35400; padding: 5px 25px; border-radius: 25px; font-size: 24px; font-weight: bold; }
.btn-close { position: absolute; right: 10px; background: #c0392b; color: white; width: 45px; height: 45px; border-radius: 50%; border: none; font-weight: bold; font-size: 20px; }
.game-footer { height: 100px; display: flex; justify-content: center; align-items: center; background: white; border-top: 1px solid #ccc; padding-bottom: 30px; flex-shrink: 0; z-index: 200;}
#win-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.98); z-index: 300; flex-direction: column; align-items: center; justify-content: center; }

/* CSS Game C≈© (Mole/Flip) */
.tower-container { flex: 1; width: 100%; display: flex; flex-direction: column; justify-content: center; padding: 10px 0; }
.tower-row { flex: 1; width: 100%; display: flex; justify-content: center; align-items: center; gap: 10px; margin-bottom: 5px; }
.card-flip { height: 95%; aspect-ratio: 0.75; position: relative; perspective: 1000px; }
.card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.4s; transform-style: preserve-3d; border-radius: 12px; box-shadow: 0 3px 6px rgba(0,0,0,0.3); }
.card-flip.flipped .card-inner { transform: rotateY(180deg); }
.card-flip.matched .card-inner { opacity: 0; pointer-events: none; }
.face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 12px; display: flex; align-items: center; justify-content: center; border: 2px solid #5d4037; }
.front { background: #8d6e63; color: #3e2723; font-size: 6vh; font-weight: 900; }
.back { background: white; transform: rotateY(180deg); padding: 2px; }
.back img { width: 95%; height: 95%; object-fit: contain; }
.game-card-text { display: flex; flex-direction: row; align-items: center; justify-content: center; height: 100%; width: 100%; flex-wrap: wrap; }
.gc-block { display: flex; flex-direction: column; align-items: center; margin: 0 1px; }
.gc-ipa { color: red; font-weight: bold; font-size: 1.8vh; height: 2vh; }
.gc-word { color: #333; font-weight: bold; font-size: 2.5vh; }
#whack-wrapper { flex: 1; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; overflow: hidden; background: linear-gradient(to bottom, #87CEEB 0%, #87CEEB 40%, #8bc34a 40%, #8bc34a 100%); position: relative; padding-bottom: 20px; }
#whack-wrapper::before { content: ' ‚òÅ Ô∏è'; font-size: 60px; position: absolute; top: 30px; left: 20px; opacity: 0.8; }
#whack-wrapper::after { content: ' ‚òÅ Ô∏è'; font-size: 50px; position: absolute; top: 60px; right: 40px; opacity: 0.8; }
.wood-sign { background: #8d6e63; background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(0,0,0,0.05) 10px, rgba(0,0,0,0.05) 20px); border: 4px solid #5d4037; color: white; padding: 5px 15px; border-radius: 10px; font-weight: bold; box-shadow: 0 5px 10px rgba(0,0,0,0.4); text-align: center; min-width: 130px; text-shadow: 1px 1px 0px rgba(0,0,0,0.5); z-index: 10; }
.hud-row { display: flex; gap: 10px; margin-bottom: 10px; margin-top: 5px; z-index: 5; justify-content: center; width: 100%; }
#target-word-container { display: flex; flex-direction: row; justify-content: center; align-items: flex-end; background: white; padding: 5px 15px; border-radius: 8px; border: 2px solid #5d4037; margin-top: 5px; min-height: 45px; }
.target-char { display: flex; flex-direction: column; align-items: center; margin: 0 1px; }
.target-ipa { color: red; font-weight: bold; font-size: 14px; height: 16px; }
.target-txt { color: #333; font-weight: bold; font-size: 24px; }
.score-text { font-size: 24px; color: #fff; font-weight: 900; }
.game-field-3d { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; width: 90%; max-width: 400px; transform: perspective(800px) rotateX(25deg); padding: 20px; background-color: #6d4c41; background-image: radial-gradient(circle, #795548 10%, transparent 10%); background-size: 20px 20px; border-radius: 20px; border: 8px solid #388e3c; box-shadow: 0 20px 0 #2e7d32, 0 25px 25px rgba(0,0,0,0.6); }
.hole { position: relative; aspect-ratio: 1; background: #2b1b13; border-radius: 50%; box-shadow: inset 0 10px 20px black; overflow: hidden; border: 2px solid #5d4037; }
.mole { position: absolute; top: 100%; left: 10%; width: 80%; height: 95%; background: #D2691E; border-radius: 45% 45% 10% 10%; transition: top 0.2s cubic-bezier(0.68, -0.55, 0.265, 1.55); display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding-top: 5px; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.4); }
.mole::before { content: ' üëÄ '; font-size: 20px; position: absolute; top: 5px; }
.mole::after { content: ' üêΩ '; font-size: 16px; position: absolute; top: 22px; }
.mole.up { top: 0%; }
.mole-card { width: 120%; height: 60%; background: white; border: 3px solid #eee; border-radius: 8px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(0,0,0,0.4); z-index: 2; position: absolute; top: 45%; left: -10%; transform: rotate(-3deg); }
.mole-card img { width: 95%; height: 95%; object-fit: contain; pointer-events: none; }
.hammer { position: fixed; width: 100px; height: 100px; pointer-events: none; z-index: 100000; background-image: url('hammer.png'); background-size: contain; background-repeat: no-repeat; transform-origin: bottom right; display: none; filter: drop-shadow(5px 5px 5px rgba(0,0,0,0.3)); }
.hammer.active { display: block; animation: hammer-hit 0.15s ease-in; }
@keyframes hammer-hit { 0% { transform: rotate(30deg); } 50% { transform: rotate(-45deg) scale(0.9); } 100% { transform: rotate(0deg); } }
.floating-text { position: fixed; font-weight: 900; font-size: 28px; pointer-events: none; z-index: 1000; animation: floatUp 0.8s ease-out forwards; text-shadow: 2px 2px 0px black, -2px -2px 0px white; }
@keyframes floatUp { 0% { opacity: 1; transform: translateY(0) scale(1); } 100% { opacity: 0; transform: translateY(-60px) scale(1.5); } }
.mole.bonked { filter: brightness(1.3) sepia(0.5) hue-rotate(-30deg) saturate(2); transition: none; transform: scale(0.95); }

/* --- CSS GAME R·∫ÆN SƒÇN M·ªíI --- */
#snake-game-container {
    flex: 1; width: 100%; display: none; flex-direction: column; align-items: center; justify-content: flex-start;
    background-color: #dcedc8; background-image: radial-gradient(#8bc34a 2px, transparent 2.5px); background-size: 30px 30px; 
    position: relative; overflow: hidden;
}
#snake-target-bar {
    width: 95%; background: rgba(255,255,255,0.95); padding: 5px 15px; border-radius: 12px;
    margin-top: 10px; display: flex; justify-content: space-between; align-items: center;
    box-shadow: 0 4px 6px rgba(0,0,0,0.3); z-index: 200; height: 60px; flex-shrink: 0;
}
.target-label { font-weight: bold; color: #555; font-size: 16px; margin-right: 5px; }
#snake-target-content { display: flex; flex-direction: column; align-items: center; justify-content: center; }
#snake-score { font-size: 22px; font-weight: bold; color: #27ae60; }
#snake-lives { font-size: 22px; font-weight: bold; color: #e74c3c; margin-right: 10px;}
.btn-pause { background: #f39c12; color: white; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 20px; font-weight: bold; cursor: pointer; box-shadow: 0 3px #d35400; }
.btn-pause:active { transform: translateY(2px); box-shadow: none; }

#snake-board {
    margin: 5px auto; width: 95vw; flex: 1; max-width: 450px;
    background-color: transparent; border: none;
    display: grid; position: relative; z-index: 10;
}
.grid-cell { width: 100%; height: 100%; position: relative; border: none; }

/* R·∫ÆN: Z-INDEX 1000 */
.snake-part {
    width: 100%; height: 100%;
    position: absolute; top: 0; left: 0;
    background-image: url('snake-body.png'); background-size: contain; background-repeat: no-repeat; background-position: center;
    z-index: 1000 !important; 
}
.snake-head {
    position: absolute; top: 0; left: 0;
    background-image: url('snake-head.png');
    z-index: 1001 !important;
    transform-origin: center center; transition: transform 0.1s linear; 
    background-size: contain; background-repeat: no-repeat; background-position: center;
}
.head-up { transform: rotate(180deg); }
.head-down { transform: rotate(0deg); }
.head-left { transform: rotate(90deg); }
.head-right { transform: rotate(-90deg); }

/* M·ªíI: Z-INDEX 10 */
.food-item {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    z-index: 10; pointer-events: none;
}
.food-img { 
    width: 350%; height: 350%; object-fit: contain; 
    filter: drop-shadow(0 5px 5px rgba(0,0,0,0.5)); 
    z-index: 10; opacity: 1;
}
.food-core { 
    position: absolute; top: 0px; right: 0px; font-size: 10px; 
    background: white; border-radius: 50%; padding: 1px; z-index: 11; opacity: 0.9; border: 1px solid #ccc;
}

#d-pad {
    position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
    width: 180px; height: 140px;
    display: grid; grid-template-columns: 1fr 1fr 1fr; grid-template-rows: 1fr 1fr;
    gap: 10px; z-index: 200; touch-action: none; opacity: 0.6;
}
.d-btn { background: rgba(255, 255, 255, 0.4); border: 2px solid white; border-radius: 15px; color: #333; font-size: 30px; display: flex; align-items: center; justify-content: center; cursor: pointer; }
.d-btn:active { background: rgba(255, 255, 255, 0.8); transform: scale(0.95); }
.d-up { grid-column: 2; grid-row: 1; }
.d-left { grid-column: 1; grid-row: 2; }
.d-right { grid-column: 3; grid-row: 2; }
.d-down { grid-column: 2; grid-row: 2; }

#pause-modal { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 300; flex-direction: column; align-items: center; justify-content: center; }
.pause-text { color: white; font-size: 40px; font-weight: bold; margin-bottom: 20px; text-shadow: 0 2px 4px black; }
</style>
</head>
<body>
<div id="cursor-hammer" class="hammer"></div>

<div id="menu-screen">
    <div class="menu-title"> üìö  CH·ªåN B√ÄI H·ªåC</div>
    </div>

<div id="main-container" style="display: none;">
    <div id="learning-screen">
        <div class="top-bar">
            <button class="btn-home" onclick="App.goHome()"> üè† </button>
            <div class="header-title"> üêª B√© H·ªçc Ti·∫øng Anh üê∞ </div>
            <div style="width: 40px;"></div>
        </div>
        <div class="learn-img-wrapper"><img id="learn-img" src="" alt="H√¨nh ·∫£nh"></div>
        <div class="info-area" id="info-display"></div>
        <div class="stars" id="stars">‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</div>
        <div class="feedback-text" id="feedback">...</div>
        <div class="action-row" id="action-container">
            <button class="btn-action btn-mic" id="mic-btn" onclick="LearningEngine.startListening()"> üé§ ƒê·ªçc Ngay</button>
            <button class="btn-action btn-listen" id="btn-replay" onclick="LearningEngine.onUserClickSpeak()"> üîä Nghe L·∫°i</button>
        </div>
        <div class="nav-row">
            <button class="btn-nav" onclick="LearningEngine.nav(-1)"> ‚óÄ </button>
            <button class="btn-nav" onclick="LearningEngine.nav(1)"> ‚ñ∂ </button>
        </div>
    </div>

    <div id="game-screen" style="display: none;">
        <div class="game-header">
            <div style="width:40px;"></div>
            <div class="timer-badge"> ‚è± Ô∏è <span id="timer">00:00</span></div>
            <button class="btn-close" onclick="App.exitGame()"> ‚úï </button>
        </div>

        <div id="tower" class="tower-container" style="display:none;"></div>
        <div id="whack-wrapper" style="display:none;">
            <div class="hud-row">
                <div class="wood-sign"><small>M·ª§C TI√äU:</small><br><div id="target-word-container"></div></div>
                <div class="wood-sign"><small>ƒêI·ªÇM S·ªê:</small><br><span id="score-display" class="score-text">0</span></div>
            </div>
            <div class="game-field-3d">
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
            </div>
        </div>

        <div id="snake-game-container">
            <div id="snake-target-bar">
                <button class="btn-pause" onclick="SnakeEngine.togglePause()">‚è∏</button>
                <div class="target-label">SƒÉn t·ª´:</div>
                <div id="snake-target-content"></div>
                <div><span id="snake-lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span>üèÜ <span id="snake-score">0</span></div>
            </div>
            <div id="snake-board"></div>
            <div id="d-pad">
                <div></div><div class="d-btn d-up" onclick="SnakeEngine.changeDirection('up')">‚¨ÜÔ∏è</div><div></div>
                <div class="d-btn d-left" onclick="SnakeEngine.changeDirection('left')">‚¨ÖÔ∏è</div>
                <div class="d-btn d-down" onclick="SnakeEngine.changeDirection('down')">‚¨áÔ∏è</div>
                <div class="d-btn d-right" onclick="SnakeEngine.changeDirection('right')">‚û°Ô∏è</div>
            </div>
            <div id="pause-modal">
                <div class="pause-text">T·∫†M D·ª™NG</div>
                <button class="btn-menu" style="width:auto;" onclick="SnakeEngine.togglePause()">‚ñ∂ Ti·∫øp t·ª•c ch∆°i</button>
            </div>
        </div>

        <div class="game-footer">
            <button class="btn-action btn-nav" style="width: 60%; border-radius: 30px; font-size: 20px; box-shadow: 0 4px #e67e22; background-color: #e67e22;" onclick="GameEngine.restart()"> ‚Üª Ch∆°i l·∫°i</button>
        </div>
        <div id="win-modal">
            <h1 style="color:green; font-size:36px; margin-bottom: 10px;">HO√ÄN TH√ÄNH! üéâ </h1>
            <h2 style="color:#d35400; font-size:40px; margin: 5px 0;">T·ªïng ƒëi·ªÉm: <span id="final-score">0</span></h2>
            <p id="win-msg" style="font-size:20px; color:#555; margin-bottom: 30px;">Th·ªùi gian: 00:00</p>
            <button class="btn-action btn-nav" style="width:auto; padding: 0 40px;" onclick="GameEngine.restart()">Ch∆°i l·∫°i</button>
            <br><br>
            <button class="btn-action btn-listen" style="width:auto; padding: 0 40px;" onclick="LearningEngine.nextItem()">B√†i Ti·∫øp ‚û° </button>
        </div>
    </div>
</div>

<script>
/* ==========================================================================
   PH·∫¶N 3: LOGIC & D·ªÆ LI·ªÜU
   ========================================================================== */

/* === [D√ÅN PH·∫¶N 2 - DATA ENGINE V√ÄO ƒê√ÇY] === */
/* --- DATA ENGINE (FULL 24 LESSONS) --- */
const DataEngine = {
    // --- GIAI ƒêO·∫†N 1: C√ÅC B√ÄI C∆† B·∫¢N (Ch·ªâ t·ª´ v·ª±ng) ---
    lesson1: [
        { img: "tap.jpg", speak: "tap", parts: [{i:"t", t:"t"}, {i:"√¶ p", t:"ap"}] },
        { img: "top.jpg", speak: "top", parts: [{i:"t", t:"t"}, {i:"…í p", t:"op"}] },
        { img: "pot.jpg", speak: "pot", parts: [{i:"p", t:"p"}, {i:"…í", t:"o"}, {i:"t", t:"t"}] },
        { img: "to.jpg", speak: "to", parts: [{i:"t", t:"t"}, {i:"u:", t:"o"}] },
        { img: "tin.jpg", speak: "tin", parts: [{i:"t", t:"t"}, {i:"…™ n", t:"in"}] },
        { img: "dog.jpg", speak: "dog", parts: [{i:"d", t:"d"}, {i:"…í …°", t:"og"}] },
        { img: "dad.jpg", speak: "dad", parts: [{i:"d", t:"d"}, {i:"√¶ d", t:"ad"}] },
        { img: "dig.jpg", speak: "dig", parts: [{i:"d", t:"d"}, {i:"…™ …°", t:"ig"}] },
        { img: "duck.jpg", speak: "duck", parts: [{i:"d", t:"d"}, {i:" å k", t:"uck"}] },
        { img: "do.jpg", speak: "do", parts: [{i:"d", t:"d"}, {i:"u:", t:"o"}] },
        { type: "game", title: "Game /t/ & /d/", pairs: ["tap", "dog", "top", "dad", "pot"], img: "tap.jpg" }
    ],
    lesson2: [
        { img: "pen.jpg", speak: "pen", parts: [{i:"p", t:"p"}, {i:"e n", t:"en"}] },
        { img: "pig.jpg", speak: "pig", parts: [{i:"p", t:"p"}, {i:"…™ …°", t:"ig"}] },
        { img: "pot.jpg", speak: "pot", parts: [{i:"p", t:"p"}, {i:"…í t", t:"ot"}] },
        { img: "pull.jpg", speak: "pull", parts: [{i:"p", t:"p"}, {i:" ä l", t:"ull"}] },
        { img: "pin.jpg", speak: "pin", parts: [{i:"p", t:"p"}, {i:"…™ n", t:"in"}] },
        { img: "bag.jpg", speak: "bag", parts: [{i:"b", t:"b"}, {i:"√¶ …°", t:"ag"}] },
        { img: "book.jpg", speak: "book", parts: [{i:"b", t:"b"}, {i:" ä k", t:"ook"}] },
        { img: "bat.jpg", speak: "bat", parts: [{i:"b", t:"b"}, {i:"√¶ t", t:"at"}] },
        { img: "box.jpg", speak: "box", parts: [{i:"b", t:"b"}, {i:"…í k s", t:"ox"}] },
        { img: "bin.jpg", speak: "bin", parts: [{i:"b", t:"b"}, {i:"…™ n", t:"in"}] },
        { type: "game", title: "Game /p/ & /b/", pairs: ["pen", "bag", "pig", "book", "pin"], img: "pen.jpg" }
    ],
    lesson3: [
        { img: "bat.jpg", speak: "bat", parts: [{i:"b", t:"b"}, {i:"√¶ t", t:"at"}] },
        { img: "dad.jpg", speak: "dad", parts: [{i:"d", t:"d"}, {i:"√¶ d", t:"ad"}] },
        { img: "pat.jpg", speak: "pat", parts: [{i:"p", t:"p"}, {i:"√¶ t", t:"at"}] },
        { img: "tap.jpg", speak: "tap", parts: [{i:"t", t:"t"}, {i:"√¶ p", t:"ap"}] },
        { img: "bad.jpg", speak: "bad", parts: [{i:"b", t:"b"}, {i:"√¶ d", t:"ad"}] },
        { img: "dip.jpg", speak: "dip", parts: [{i:"d", t:"d"}, {i:"…™ p", t:"ip"}] },
        { img: "bit.jpg", speak: "bit", parts: [{i:"b", t:"b"}, {i:"…™ t", t:"it"}] },
        { img: "pit.jpg", speak: "pit", parts: [{i:"p", t:"p"}, {i:"…™ t", t:"it"}] },
        { img: "tip.jpg", speak: "tip", parts: [{i:"t", t:"t"}, {i:"…™ p", t:"ip"}] },
        { img: "bib.jpg", speak: "bib", parts: [{i:"b", t:"b"}, {i:"…™ b", t:"ib"}] },
        { type: "game", title: "Game /√¶/ & /…™/", pairs: ["bat", "dip", "dad", "bit", "tap"], img: "bat.jpg" }
    ],
    lesson4: [
        { img: "duck.jpg", speak: "duck", parts: [{i:"d", t:"d"}, {i:" å k", t:"uck"}] },
        { img: "but.jpg", speak: "but", parts: [{i:"b", t:"b"}, {i:" å t", t:"ut"}] },
        { img: "tub.jpg", speak: "tub", parts: [{i:"t", t:"t"}, {i:" å b", t:"ub"}] },
        { img: "cup.jpg", speak: "cup", parts: [{i:"c", t:"c"}, {i:" å p", t:"up"}] },
        { img: "bud.jpg", speak: "bud", parts: [{i:"b", t:"b"}, {i:" å d", t:"ud"}] },
        { img: "dot.jpg", speak: "dot", parts: [{i:"d", t:"d"}, {i:"…ëÀê t", t:"ot"}] },
        { img: "top.jpg", speak: "top", parts: [{i:"t", t:"t"}, {i:"…ëÀê p", t:"op"}] },
        { img: "pot.jpg", speak: "pot", parts: [{i:"p", t:"p"}, {i:"…ëÀê t", t:"ot"}] },
        { img: "dog.jpg", speak: "dog", parts: [{i:"d", t:"d"}, {i:"…ëÀê …°", t:"og"}] },
        { img: "Bob.jpg", speak: "Bob", parts: [{i:"B", t:"B"}, {i:"…ëÀê b", t:"ob"}] },
        { type: "game", title: "Game / å/ & /…ë:/", pairs: ["duck", "dot", "cup", "pot", "tub"], img: "duck.jpg" }
    ],
    lesson5: [
        { img: "Ted.jpg", speak: "Ted", parts: [{i:"T", t:"T"}, {i:"e d", t:"ed"}] },
        { img: "pen.jpg", speak: "pen", parts: [{i:"p", t:"p"}, {i:"e n", t:"en"}] },
        { img: "ten.jpg", speak: "ten", parts: [{i:"t", t:"t"}, {i:"e n", t:"en"}] },
        { img: "bed.jpg", speak: "bed", parts: [{i:"b", t:"b"}, {i:"e d", t:"ed"}] },
        { img: "pet.jpg", speak: "pet", parts: [{i:"p", t:"p"}, {i:"e t", t:"et"}] },
        { type: "game", title: "Game /e/", pairs: ["Ted", "pen", "ten", "bed", "pet"], img: "bed.jpg" }
    ],
    lesson6: [
        { img: "cat.jpg", speak: "cat", parts: [{i:"k", t:"c"}, {i:"√¶ t", t:"at"}] },
        { img: "kid.jpg", speak: "kid", parts: [{i:"k", t:"k"}, {i:"…™ d", t:"id"}] },
        { img: "cap.jpg", speak: "cap", parts: [{i:"k", t:"c"}, {i:"√¶ p", t:"ap"}] },
        { img: "cot.jpg", speak: "cot", parts: [{i:"k", t:"c"}, {i:"…í t", t:"ot"}] },
        { img: "cup.jpg", speak: "cup", parts: [{i:"k", t:"c"}, {i:" å p", t:"up"}] },
        { img: "gap.jpg", speak: "gap", parts: [{i:"g", t:"g"}, {i:"√¶ p", t:"ap"}] },
        { img: "got.jpg", speak: "got", parts: [{i:"g", t:"g"}, {i:"…í t", t:"ot"}] },
        { img: "dig.jpg", speak: "dig", parts: [{i:"d", t:"d"}, {i:"…™ …°", t:"ig"}] },
        { img: "dog.jpg", speak: "dog", parts: [{i:"d", t:"d"}, {i:"…í …°", t:"og"}] },
        { img: "get.jpg", speak: "get", parts: [{i:"g", t:"g"}, {i:"e t", t:"et"}] },
        { type: "game", title: "Game /k/ & /g/", pairs: ["cat", "gap", "kid", "got", "cup"], img: "cat.jpg" }
    ],

    // --- GIAI ƒêO·∫†N 2: T·ª™ V·ª∞NG + C√ÇU (B√†i 7 - 24) ---
    lesson7: [
        { img: "fog.jpg", speak: "fog", parts: [{i:"f", t:"f"}, {i:"…í g", t:"og"}] },
        { img: "fit.jpg", speak: "fit", parts: [{i:"f", t:"f"}, {i:"…™ t", t:"it"}] },
        { img: "fig.jpg", speak: "fig", parts: [{i:"f", t:"f"}, {i:"…™ g", t:"ig"}] },
        { img: "fat.jpg", speak: "fat", parts: [{i:"f", t:"f"}, {i:"√¶ t", t:"at"}] },
        { img: "fed.jpg", speak: "fed", parts: [{i:"f", t:"f"}, {i:"e d", t:"ed"}] },
        { img: "vat.jpg", speak: "vat", parts: [{i:"v", t:"v"}, {i:"√¶ t", t:"at"}] },
        { img: "vet.jpg", speak: "vet", parts: [{i:"v", t:"v"}, {i:"e t", t:"et"}] },
        { img: "van.jpg", speak: "van", parts: [{i:"v", t:"v"}, {i:"√¶ n", t:"an"}] },
        { type: "sent", img: "sentence_fed.jpg", speak: "Bob fed a fat dog", parts: [{i:"B …í b", t:"Bob"}, {t:" "}, {i:"f e d", t:"fed"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"f √¶ t", t:"fat"}, {t:" "}, {i:"d …í g", t:"dog."}] },
        { type: "sent", img: "sentence_cat.jpg", speak: "A cat got a big cap", parts: [{i:"…ô", t:"A"}, {t:" "}, {i:"k √¶ t", t:"cat"}, {t:" "}, {i:"g …í t", t:"got"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"b …™ g", t:"big"}, {t:" "}, {i:"k √¶ p", t:"cap."}] },
        { type: "game", title: "Game /f/ & /v/", pairs: ["fog", "vat", "fit", "vet", "fat"], img: "fog.jpg" }
    ],
    lesson8: [
        { img: "bus.jpg", speak: "bus", parts: [{i:"b", t:"b"}, {i:" å s", t:"us"}] },
        { img: "kiss.jpg", speak: "kiss", parts: [{i:"k", t:"k"}, {i:"…™ s", t:"iss"}] },
        { img: "sick.jpg", speak: "sick", parts: [{i:"s", t:"s"}, {i:"…™ k", t:"ick"}] },
        { img: "sock.jpg", speak: "sock", parts: [{i:"s", t:"s"}, {i:"…í k", t:"ock"}] },
        { img: "sit.jpg", speak: "sit", parts: [{i:"s", t:"s"}, {i:"…™ t", t:"it"}] },
        { img: "zip.jpg", speak: "zip", parts: [{i:"z", t:"z"}, {i:"…™ p", t:"ip"}] },
        { img: "zigzag.jpg", speak: "zigzag", parts: [{i:"z", t:"z"}, {i:"…™ g", t:"ig"}, {i:"z", t:"z"}, {i:"√¶ g", t:"ag"}] },
        { img: "bugs.jpg", speak: "bugs", parts: [{i:"b", t:"b"}, {i:" å g z", t:"ugs"}] },
        { img: "dogs.jpg", speak: "dogs", parts: [{i:"d", t:"d"}, {i:"…í g z", t:"ogs"}] },
        { img: "is.jpg", speak: "is", parts: [{i:"…™ z", t:"is"}] },
        { type: "sent", img: "sentence_pig.jpg", speak: "A pig gets a cup", parts: [{i:"…ô", t:"A"}, {t:" "}, {i:"p …™ g", t:"pig"}, {t:" "}, {i:"g e t s", t:"gets"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"k  å p", t:"cup."}] },
        { type: "sent", img: "sentence_duck.jpg", speak: "A duck sits on the bed", parts: [{i:"…ô", t:"A"}, {t:" "}, {i:"d  å k", t:"duck"}, {t:" "}, {i:"s …™ t s", t:"sits"}, {t:" "}, {i:"…í n", t:"on"}, {t:" "}, {i:"√∞ …ô", t:"the"}, {t:" "}, {i:"b e d", t:"bed."}] },
        { type: "sent", img: "sentence_dad.jpg", speak: "Dad digs a pit", parts: [{i:"d √¶ d", t:"Dad"}, {t:" "}, {i:"d …™ g s", t:"digs"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"p …™ t", t:"pit."}] },
        { type: "game", title: "Game /s/ & /z/", pairs: ["bus", "zip", "sick", "bugs", "sit"], img: "bus.jpg" }
    ],
    lesson9: [
        { img: "shop.jpg", speak: "shop", parts: [{i:" É", t:"sh"}, {i:"…í p", t:"op"}] },
        { img: "ship.jpg", speak: "ship", parts: [{i:" É", t:"sh"}, {i:"…™ p", t:"ip"}] },
        { img: "fish.jpg", speak: "fish", parts: [{i:"f", t:"f"}, {i:"…™", t:"i"}, {i:" É", t:"sh"}] },
        { img: "dish.jpg", speak: "dish", parts: [{i:"d", t:"d"}, {i:"…™", t:"i"}, {i:" É", t:"sh"}] },
        { img: "measure.jpg", speak: "measure", parts: [{i:"m", t:"m"}, {i:"…õ", t:"ea"}, {i:" í …ôr", t:"sure"}] },
        { img: "treasure.jpg", speak: "treasure", parts: [{i:"t r", t:"tr"}, {i:"…õ", t:"ea"}, {i:" í …ôr", t:"sure"}] },
        { img: "vision.jpg", speak: "vision", parts: [{i:"v", t:"v"}, {i:"…™", t:"i"}, {i:" í …ôn", t:"sion"}] },
        { type: "sent", img: "sentence_shells.jpg", speak: "She sells seashells on the seashore", parts: [{i:" É i:", t:"She"}, {t:" "}, {i:"s …õ l z", t:"sells"}, {t:" "}, {i:"s i:  É …õ l z", t:"seashells"}, {t:" "}, {i:"…í n", t:"on"}, {t:" "}, {i:"√∞ …ô", t:"the"}, {t:" "}, {i:"s i:  É …î:r", t:"seashore."}] },
        { type: "sent", img: "sentence_fish.jpg", speak: "A fat fish sits on a treasure bag", parts: [{i:"…ô", t:"A"}, {t:" "}, {i:"f √¶ t", t:"fat"}, {t:" "}, {i:"f …™  É", t:"fish"}, {t:" "}, {i:"s …™ t s", t:"sits"}, {t:" "}, {i:"…í n", t:"on"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"t r …õ  í …ôr", t:"treasure"}, {t:" "}, {i:"b √¶ …°", t:"bag."}] },
        { type: "game", title: "Game / É/ & / í/", pairs: ["shop", "ship", "fish", "dish", "treasure"], img: "fish.jpg" }
    ],
    lesson10: [
        { img: "chick.jpg", speak: "chick", parts: [{i:"t É", t:"ch"}, {i:"…™ k", t:"ick"}] },
        { img: "chop.jpg", speak: "chop", parts: [{i:"t É", t:"ch"}, {i:"…í p", t:"op"}] },
        { img: "chin.jpg", speak: "chin", parts: [{i:"t É", t:"ch"}, {i:"…™ n", t:"in"}] },
        { img: "chip.jpg", speak: "chip", parts: [{i:"t É", t:"ch"}, {i:"…™ p", t:"ip"}] },
        { img: "chat.jpg", speak: "chat", parts: [{i:"t É", t:"ch"}, {i:"√¶ t", t:"at"}] },
        { img: "jam.jpg", speak: "jam", parts: [{i:"d í", t:"j"}, {i:"√¶ m", t:"am"}] },
        { img: "jet.jpg", speak: "jet", parts: [{i:"d í", t:"j"}, {i:"…õ t", t:"et"}] },
        { img: "jug.jpg", speak: "jug", parts: [{i:"d í", t:"j"}, {i:" å …°", t:"ug"}] },
        { img: "Jack.jpg", speak: "Jack", parts: [{i:"d í", t:"J"}, {i:"√¶ k", t:"ack"}] },
        { img: "job.jpg", speak: "job", parts: [{i:"d í", t:"j"}, {i:"…í b", t:"ob"}] },
        { type: "sent", img: "sentence_cheerful.jpg", speak: "Cheerful children chase chatty chicks", parts: [{i:"t É …™r f …ô l", t:"Cheerful"}, {t:" "}, {i:"t É …™ l d r …ô n", t:"children"}, {t:" "}, {i:"t É e…™ s", t:"chase"}, {t:" "}, {i:"t É √¶ t i", t:"chatty"}, {t:" "}, {i:"t É …™ k s", t:"chicks."}] },
        { type: "sent", img: "sentence_jack_jill.jpg", speak: "Jack and Jill juggle juicy ginger jars", parts: [{i:"d í √¶ k", t:"Jack"}, {t:" "}, {i:"√¶ n d", t:"and"}, {t:" "}, {i:"d í …™ l", t:"Jill"}, {t:" "}, {i:"d í  å …° l", t:"juggle"}, {t:" "}, {i:"d í u: s i", t:"juicy"}, {t:" "}, {i:"d í …™ n d í …ôr", t:"ginger"}, {t:" "}, {i:"d í …ë:r z", t:"jars."}] },
        { type: "sent", img: "sentence_chick.jpg", speak: "The chick checks the jam", parts: [{i:"√∞ …ô", t:"The"}, {t:" "}, {i:"t É …™ k", t:"chick"}, {t:" "}, {i:"t É …õ k s", t:"checks"}, {t:" "}, {i:"√∞ …ô", t:"the"}, {t:" "}, {i:"d í √¶ m", t:"jam."}] },
        { type: "game", title: "Game /t É/ & /d í/", pairs: ["chick", "jam", "chop", "jug", "Jack"], img: "chick.jpg" }
    ],
    lesson11: [
        { type: "sent", img: "sentence_Jack.jpg", speak: "Jack got a fish on the dish", parts: [{i:"d í √¶ k", t:"Jack"}, {t:" "}, {i:"g …í t", t:"got"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"f …™  É", t:"fish"}, {t:" "}, {i:"…í n", t:"on"}, {t:" "}, {i:"√∞ …ô", t:"the"}, {t:" "}, {i:"d …™  É", t:"dish."}] },
        { type: "sent", img: "sentence_vet.jpg", speak: "The vet fed the chick on a big ship", parts: [{i:"√∞ …ô", t:"The"}, {t:" "}, {i:"v e t", t:"vet"}, {t:" "}, {i:"f e d", t:"fed"}, {t:" "}, {i:"√∞ …ô", t:"the"}, {t:" "}, {i:"t É …™ k", t:"chick"}, {t:" "}, {i:"…í n", t:"on"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"b …™ g", t:"big"}, {t:" "}, {i:" É …™ p", t:"ship."}] },
        { type: "sent", img: "sentence_bugs.jpg", speak: "Cats and dogs catch bugs on a big bus", parts: [{i:"k √¶ t s", t:"Cats"}, {t:" "}, {i:"√¶ n d", t:"and"}, {t:" "}, {i:"d …í g s", t:"dogs"}, {t:" "}, {i:"k √¶ t É", t:"catch"}, {t:" "}, {i:"b  å g z", t:"bugs"}, {t:" "}, {i:"…í n", t:"on"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"b …™ g", t:"big"}, {t:" "}, {i:"b  å s", t:"bus."}] }
    ],
    lesson12: [
        { img: "sea.jpg", speak: "sea", parts: [{i:"s", t:"s"}, {i:"i:", t:"ea"}] },
        { img: "sheep.jpg", speak: "sheep", parts: [{i:" É", t:"sh"}, {i:"i: p", t:"eep"}] },
        { img: "feet.jpg", speak: "feet", parts: [{i:"f", t:"f"}, {i:"i: t", t:"eet"}] },
        { img: "bee.jpg", speak: "bee", parts: [{i:"b", t:"b"}, {i:"i:", t:"ee"}] },
        { img: "eat.jpg", speak: "eat", parts: [{i:"i: t", t:"eat"}] },
        { type: "sent", img: "sentence_sheep.jpg", speak: "The sheep sees a bee", parts: [{i:"√∞ …ô", t:"The"}, {t:" "}, {i:" É i: p", t:"sheep"}, {t:" "}, {i:"s i: z", t:"sees"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"b i:", t:"bee."}] },
        { type: "sent", img: "sentence_she.jpg", speak: "She keeps a big seed", parts: [{i:" É i:", t:"She"}, {t:" "}, {i:"k i: p s", t:"keeps"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"b …™ g", t:"big"}, {t:" "}, {i:"s i: d", t:"seed."}] },
        { type: "game", title: "Game /i:/ & /…™/", pairs: ["sea", "sheep", "feet", "bee", "eat"], img: "sheep.jpg" }
    ],
    lesson13: [
        { img: "put.jpg", speak: "put", parts: [{i:"p", t:"p"}, {i:" ä t", t:"ut"}] },
        { img: "bush.jpg", speak: "bush", parts: [{i:"b", t:"b"}, {i:" ä  É", t:"ush"}] },
        { img: "book.jpg", speak: "book", parts: [{i:"b", t:"b"}, {i:" ä k", t:"ook"}] },
        { img: "foot.jpg", speak: "foot", parts: [{i:"f", t:"f"}, {i:" ä t", t:"oot"}] },
        { img: "cook.jpg", speak: "cook", parts: [{i:"k", t:"c"}, {i:" ä k", t:"ook"}] },
        { img: "boot.jpg", speak: "boot", parts: [{i:"b", t:"b"}, {i:"u: t", t:"oot"}] },
        { img: "food.jpg", speak: "food", parts: [{i:"f", t:"f"}, {i:"u: d", t:"ood"}] },
        { img: "goose.jpg", speak: "goose", parts: [{i:"g", t:"g"}, {i:"u: s", t:"oose"}] },
        { img: "zoo.jpg", speak: "zoo", parts: [{i:"z", t:"z"}, {i:"u:", t:"oo"}] },
        { img: "shoot.jpg", speak: "shoot", parts: [{i:" É", t:"sh"}, {i:"u: t", t:"oot"}] },
        { type: "sent", img: "sentence_book.jpg", speak: "Bob put the book in the bush", parts: [{i:"B …í b", t:"Bob"}, {t:" "}, {i:"p  ä t", t:"put"}, {t:" "}, {i:"√∞ …ô", t:"the"}, {t:" "}, {i:"b  ä k", t:"book"}, {t:" "}, {i:"…™ n", t:"in"}, {t:" "}, {i:"√∞ …ô", t:"the"}, {t:" "}, {i:"b  ä  É", t:"bush."}] },
        { type: "sent", img: "sentence_goose.jpg", speak: "The goose eats food at the zoo", parts: [{i:"√∞ …ô", t:"The"}, {t:" "}, {i:"g u: s", t:"goose"}, {t:" "}, {i:"i: t s", t:"eats"}, {t:" "}, {i:"f u: d", t:"food"}, {t:" "}, {i:"√¶ t", t:"at"}, {t:" "}, {i:"√∞ …ô", t:"the"}, {t:" "}, {i:"z u:", t:"zoo."}] },
        { type: "game", title: "Game / ä/ & /u:/", pairs: ["put", "boot", "bush", "food", "book"], img: "book.jpg" }
    ],
    lesson14: [
        { img: "shark.jpg", speak: "shark", parts: [{i:" É", t:"sh"}, {i:"…ë:r k", t:"ark"}] },
        { img: "star.jpg", speak: "star", parts: [{i:"s t", t:"st"}, {i:"…ë:r", t:"ar"}] },
        { img: "cart.jpg", speak: "cart", parts: [{i:"k", t:"c"}, {i:"…ë:r t", t:"art"}] },
        { img: "car.jpg", speak: "car", parts: [{i:"k", t:"c"}, {i:"…ë:r", t:"ar"}] },
        { img: "park.jpg", speak: "park", parts: [{i:"p", t:"p"}, {i:"…ë:r k", t:"ark"}] },
        { img: "torch.jpg", speak: "torch", parts: [{i:"t", t:"t"}, {i:"…î:r t É", t:"orch"}] },
        { img: "shorts.jpg", speak: "shorts", parts: [{i:" É", t:"sh"}, {i:"…î:r t s", t:"orts"}] },
        { img: "board.jpg", speak: "board", parts: [{i:"b", t:"b"}, {i:"…î:r d", t:"oard"}] },
        { img: "door.jpg", speak: "door", parts: [{i:"d", t:"d"}, {i:"…î:r", t:"oor"}] },
        { img: "fork.jpg", speak: "fork", parts: [{i:"f", t:"f"}, {i:"…î:r k", t:"ork"}] },
        { type: "sent", img: "sentence_shark.jpg", speak: "A shark put a star in the jar", parts: [{i:"…ô", t:"A"}, {t:" "}, {i:" É …ë:r k", t:"shark"}, {t:" "}, {i:"p  ä t", t:"put"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"s t …ë:r", t:"star"}, {t:" "}, {i:"…™ n", t:"in"}, {t:" "}, {i:"√∞ …ô", t:"the"}, {t:" "}, {i:"d í …ë:r", t:"jar."}] },
        { type: "sent", img: "sentence_fork.jpg", speak: "A short fork drops on the floor", parts: [{i:"…ô", t:"A"}, {t:" "}, {i:" É …î:r t", t:"short"}, {t:" "}, {i:"f …î:r k", t:"fork"}, {t:" "}, {i:"d r …í p s", t:"drops"}, {t:" "}, {i:"…í n", t:"on"}, {t:" "}, {i:"√∞ …ô", t:"the"}, {t:" "}, {i:"f l …î:r", t:"floor."}] },
        { type: "game", title: "Game /…ë:r/ & /…î:r/", pairs: ["shark", "torch", "star", "door", "car"], img: "shark.jpg" }
    ],
    lesson15: [
        { img: "salad.jpg", speak: "salad", parts: [{i:"s √¶", t:"sal"}, {i:"l …ô d", t:"ad"}] },
        { img: "lemon.jpg", speak: "lemon", parts: [{i:"l e", t:"lem"}, {i:"m …ô n", t:"on"}] },
        { img: "chicken.jpg", speak: "chicken", parts: [{i:"t É …™", t:"chick"}, {i:"k …ô n", t:"en"}] },
        { img: "kitchen.jpg", speak: "kitchen", parts: [{i:"k …™ t", t:"kitch"}, {i:"t É …ô n", t:"en"}] },
        { img: "panda.jpg", speak: "panda", parts: [{i:"p √¶ n", t:"pan"}, {i:"d …ô", t:"da"}] },
        { img: "banana.jpg", speak: "banana", parts: [{i:"b …ô", t:"ba"}, {i:"n √¶", t:"na"}, {i:"n …ô", t:"na"}] },
        { img: "badminton.jpg", speak: "badminton", parts: [{i:"b √¶ d", t:"bad"}, {i:"m …™ n", t:"min"}, {i:"t …ô n", t:"ton"}] },
        { img: "elephant.jpg", speak: "elephant", parts: [{i:"e", t:"e"}, {i:"l …ô", t:"le"}, {i:"f …ô n t", t:"phant"}] },
        { img: "teacher.jpg", speak: "teacher", parts: [{i:"t i:", t:"teach"}, {i:"t É …ôr", t:"er"}] },
        { img: "doctor.jpg", speak: "doctor", parts: [{i:"d …í k", t:"doc"}, {i:"t …ôr", t:"tor"}] },
        { img: "burger.jpg", speak: "burger", parts: [{i:"b 3:r", t:"bur"}, {i:"g …ôr", t:"ger"}] },
        { img: "sister.jpg", speak: "sister", parts: [{i:"s …™ s", t:"sis"}, {i:"t …ôr", t:"ter"}] },
        { img: "rubber.jpg", speak: "rubber", parts: [{i:"r  å", t:"rub"}, {i:"b …ôr", t:"ber"}] },
        { img: "lizard.jpg", speak: "lizard", parts: [{i:"l …™", t:"liz"}, {i:"z …ôr d", t:"ard"}] },
        { img: "under.jpg", speak: "under", parts: [{i:" å n", t:"un"}, {i:"d …ôr", t:"der"}] },
        { img: "superman.jpg", speak: "superman", parts: [{i:"s u:", t:"su"}, {i:"p …ôr", t:"per"}, {i:"m √¶ n", t:"man"}] },
        { type: "game", title: "Game /…ô/ & /3:r/", pairs: ["salad", "teacher", "lemon", "doctor", "panda"], img: "panda.jpg" }
    ],
    // --- B√ÄI 16, 17, 18, 19 (B√†i c≈© 15, 16, 17, 18) ---
    lesson16: [
        { img: "gear.jpg", speak: "gear", pre: "ear", similar: ["near", "year"], parts: [{i:"…™r", t:"gear"}] },
        { img: "deer.jpg", speak: "deer", pre: "ear", similar: ["dear"], parts: [{i:"…™r", t:"deer"}] },
        { img: "cheer.jpg", speak: "cheer", pre: "ear", similar: ["chair"], parts: [{i:"t É", t:"ch"}, {i:"…™r", t:"eer"}] },
        { img: "tear.jpg", speak: "tier", pre: "ear", similar: ["tier", "tea"], parts: [{i:"t", t:"t"}, {i:"…™r", t:"ear"}] },
        { img: "ear.jpg", speak: "ear", pre: "ear", similar: ["year"], parts: [{i:"…™r", t:"ear"}] },
        { img: "bear.jpg", speak: "bear", pre: "air", similar: ["bare"], parts: [{i:"b", t:"b"}, {i:"…õr", t:"ear"}] },
        { img: "pear.jpg", speak: "pear", pre: "air", similar: ["pair"], parts: [{i:"p", t:"p"}, {i:"…õr", t:"ear"}] },
        { img: "share.jpg", speak: "share", pre: "air", similar: ["chair"], parts: [{i:" É", t:"sh"}, {i:"…õr", t:"are"}] },
        { img: "stair.jpg", speak: "stair", pre: "air", similar: ["stare"], parts: [{i:"", t:"st"}, {i:"…õr", t:"air"}] },
        { img: "chair.jpg", speak: "chair", pre: "air", similar: ["cheer"], parts: [{i:"t É", t:"ch"}, {i:"…õr", t:"air"}] },
        { type: "sent", img: "sentence_deer.jpg", speak: "The deer is near the chair", parts: [{i:"√∞…ô", t:"The"}, {t:" "}, {i:"…™r", t:"deer"}, {t:" "}, {i:"…™z", t:"is"}, {t:" "}, {i:"…™r", t:"near"}, {t:" "}, {i:"√∞…ô", t:"the"}, {t:" "}, {i:"t É …õr", t:"chair."}] },
        { type: "sent", img: "sentence_bear.jpg", speak: "The bear shares the pear", parts: [{i:"√∞…ô", t:"The"}, {t:" "}, {i:"…õr", t:"bear"}, {t:" "}, {i:" É …õr z", t:"shares"}, {t:" "}, {i:"√∞…ô", t:"the"}, {t:" "}, {i:"…õr", t:"pear."}] },
        { type: "game", title: "GAME 1: SƒÉn √¢m /…™r/", pairs: ["gear", "deer", "cheer", "tear", "ear"], img: "…™r_card.jpg" },
        { type: "game", title: "GAME 2: SƒÉn √¢m /…õr/", pairs: ["bear", "pear", "share", "stair", "chair"], img: "…õr_card.jpg" }
    ],
    lesson17: [
        { img: "shower.jpg", speak: "shower", pre: "ow", similar: ["show"], parts: [{i:" É", t:"sh"}, {i:"a ä", t:"ow"}, {i:"…ôr", t:"er"}] },
        { img: "shout.jpg", speak: "shout", pre: "ow", similar: ["out"], parts: [{i:" É", t:"sh"}, {i:"a ä", t:"ou"}, {i:"", t:"t"}] },
        { img: "cow.jpg", speak: "cow", pre: "ow", similar: ["how"], parts: [{i:"", t:"c"}, {i:"a ä", t:"ow"}] },
        { img: "brown.jpg", speak: "brown", pre: "ow", similar: ["down"], parts: [{i:"", t:"br"}, {i:"a ä", t:"ow"}, {i:"", t:"n"}] },
        { img: "tower.jpg", speak: "tower", pre: "ow", similar: ["power"], parts: [{i:"", t:"t"}, {i:"a ä", t:"ow"}, {i:"…ôr", t:"er"}] },
        { img: "toe.jpg", speak: "toe", pre: "oh", similar: ["tow"], parts: [{i:"", t:"t"}, {i:"o ä", t:"oe"}] },
        { img: "boat.jpg", speak: "boat", pre: "oh", similar: ["boot"], parts: [{i:"", t:"b"}, {i:"o ä", t:"oa"}, {i:"", t:"t"}] },
        { img: "coat.jpg", speak: "coat", pre: "oh", similar: ["cat"], parts: [{i:"", t:"c"}, {i:"o ä", t:"oa"}, {i:"", t:"t"}] },
        { img: "phone.jpg", speak: "phone", pre: "oh", similar: ["fun"], parts: [{i:"f", t:"ph"}, {i:"o ä", t:"o"}, {i:"", t:"n"}, {i:"_", t:"e"}] },
        { img: "goat.jpg", speak: "goat", pre: "oh", similar: ["got"], parts: [{i:"", t:"g"}, {i:"o ä", t:"oa"}, {i:"", t:"t"}] },
        { type: "sent", img: "sentence_cow.jpg", speak: "The brown cow shouts at the mouse", parts: [{i:"√∞…ô", t:"The"}, {t:" "}, {i:"a ä", t:"brown"}, {t:" "}, {i:"a ä", t:"cow"}, {t:" "}, {i:"a ä", t:"shouts"}, {t:" "}, {i:"√¶", t:"at"}, {t:" "}, {i:"√∞…ô", t:"the"}, {t:" "}, {i:"a ä _", t:"mouse."}] },
        { type: "sent", img: "sentence_joe.jpg", speak: "Joe shows the slow goat the soap", parts: [{i:"d í o ä", t:"Joe"}, {t:" "}, {i:" É o ä z", t:"shows"}, {t:" "}, {i:"√∞…ô", t:"the"}, {t:" "}, {i:"o ä", t:"slow"}, {t:" "}, {i:"o ä", t:"goat"}, {t:" "}, {i:"√∞…ô", t:"the"}, {t:" "}, {i:"o ä", t:"soap."}] },
        { type: "game", title: "GAME 1: SƒÉn √¢m /a ä/", pairs: ["cow", "brown", "shout", "tower", "shower"], img: "a ä_card.jpg" },
        { type: "game", title: "GAME 2: SƒÉn √¢m /o ä/", pairs: ["toe", "boat", "coat", "phone", "goat"], img: "o ä_card.jpg" }
    ],
    lesson18: [
        { img: "face.jpg", speak: "face", pre: "A", similar: [], parts: [{i:"", t:"f"}, {i:"e…™", t:"a"}, {i:"s", t:"c"}, {i:"_", t:"e"}] },
        { img: "cake.jpg", speak: "cake", pre: "A", similar: [], parts: [{i:"", t:"c"}, {i:"e…™", t:"a"}, {i:"", t:"k"}, {i:"_", t:"e"}] },
        { img: "cave.jpg", speak: "cave", pre: "A", similar: [], parts: [{i:"", t:"c"}, {i:"e…™", t:"a"}, {i:"", t:"v"}, {i:"_", t:"e"}] },
        { img: "baby.jpg", speak: "baby", pre: "A", similar: [], parts: [{i:"", t:"b"}, {i:"e…™", t:"a"}, {i:"", t:"b"}, {i:"i:", t:"y"}] },
        { img: "baker.jpg", speak: "baker", pre: "A", similar: [], parts: [{i:"", t:"b"}, {i:"e…™", t:"a"}, {i:"", t:"k"}, {i:"…ôr", t:"er"}] },
        { type: "sent", img: "sentence_vase.jpg", speak: "Kate paints a vase", parts: [{i:"", t:"K"}, {i:"e…™", t:"a"}, {i:"", t:"t"}, {i:"_", t:"e"}, {t:" "}, {i:"", t:"p"}, {i:"e…™", t:"ai"}, {i:"", t:"nts"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"", t:"v"}, {i:"e…™", t:"a"}, {i:"", t:"s"}, {i:"_", t:"e."}] },
        { img: "kite.jpg", speak: "kite", pre: "I", similar: [], parts: [{i:"", t:"k"}, {i:"a…™", t:"i"}, {i:"", t:"t"}, {i:"_", t:"e"}] },
        { img: "bike.jpg", speak: "bike", pre: "I", similar: [], parts: [{i:"", t:"b"}, {i:"a…™", t:"i"}, {i:"", t:"k"}, {i:"_", t:"e"}] },
        { img: "tie.jpg", speak: "tie", pre: "I", similar: [], parts: [{i:"", t:"t"}, {i:"a…™", t:"i"}, {i:"_", t:"e"}] },
        { img: "pine.jpg", speak: "pine", pre: "I", similar: [], parts: [{i:"", t:"p"}, {i:"a…™", t:"i"}, {i:"", t:"n"}, {i:"_", t:"e"}] },
        { img: "cry.jpg", speak: "cry", pre: "I", similar: [], parts: [{i:"", t:"cr"}, {i:"a…™", t:"y"}] },
        { type: "sent", img: "sentence_tiger.jpg", speak: "A tiger bites a kite", parts: [{i:"…ô", t:"A"}, {t:" "}, {i:"", t:"t"}, {i:"a…™", t:"i"}, {i:"", t:"g"}, {i:"…ôr", t:"er"}, {t:" "}, {i:"b", t:"b"}, {i:"a…™", t:"i"}, {i:"", t:"t"}, {i:"_", t:"e"}, {i:"", t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"", t:"k"}, {i:"a…™", t:"i"}, {i:"", t:"t"}, {i:"_", t:"e."}] },
        { type: "game", title: "GAME 1: SƒÉn Chu·ªôt /e…™/", gameType: "mole", phoneme: "e…™", img: "e…™_card.jpg" },
        { type: "game", title: "GAME 2: SƒÉn Chu·ªôt /a…™/", gameType: "mole", phoneme: "a…™", img: "a…™_card.jpg" }
    ],
    lesson19: [
        { img: "coin.jpg", speak: "coin", pre: "oy", similar: [], parts: [{i:"k", t:"c"}, {i:"…î…™", t:"oin"}] },
        { img: "point.jpg", speak: "point", pre: "oy", similar: [], parts: [{i:"p", t:"p"}, {i:"…î…™", t:"oi"}, {i:"n t", t:"nt"}] },
        { img: "joy.jpg", speak: "joy", pre: "oy", similar: [], parts: [{i:"d í", t:"j"}, {i:"…î…™", t:"oy"}] },
        { img: "boy.jpg", speak: "boy", pre: "oy", similar: [], parts: [{i:"b", t:"b"}, {i:"…î…™", t:"oy"}] },
        { img: "toy.jpg", speak: "toy", pre: "oy", similar: [], parts: [{i:"t", t:"t"}, {i:"…î…™", t:"oy"}] },
        { type: "sent", img: "sentence_boy.jpg", speak: "A boy drops a coin and a toy", parts: [ {i:"…ô", t:"A"}, {t:" "}, {i:"b …î…™", t:"boy"}, {t:" "}, {i:"d r …í p s", t:"drops"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"k …î…™ n", t:"coin"}, {t:" "}, {i:"√¶ n d", t:"and"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"t …î…™", t:"toy."} ]},
        { img: "otter.jpg", speak: "otter", pre: "", similar: [], parts: [{i:"…ë", t:"o"}, {i:"tÃ¨", t:"tt"}, {i:"…ôr", t:"er"}] },
        { img: "butter.jpg", speak: "butter", pre: "", similar: [], parts: [{i:"b", t:"b"}, {i:" å", t:"u"}, {i:"tÃ¨", t:"tt"}, {i:"…ôr", t:"er"}] },
        { img: "kitty.jpg", speak: "kitty", pre: "", similar: [], parts: [{i:"k", t:"k"}, {i:"…™", t:"i"}, {i:"tÃ¨", t:"tt"}, {i:"i:", t:"y"}] },
        { img: "party.jpg", speak: "party", pre: "", similar: [], parts: [{i:"p", t:"p"}, {i:"…ëÀêr", t:"ar"}, {i:"tÃ¨", t:"t"}, {i:"i:", t:"y"}] },
        { img: "city.jpg", speak: "city", pre: "", similar: [], parts: [{i:"s", t:"c"}, {i:"…™", t:"i"}, {i:"tÃ¨", t:"t"}, {i:"i:", t:"y"}] },
        { type: "sent", img: "sentence_peter.jpg", speak: "Peter got butter in the party", parts: [ {i:"P i: t …ôr", t:"Peter"}, {t:" "}, {i:"g …í t", t:"got"}, {t:" "}, {i:"b  å t …ôr", t:"butter"}, {t:" "}, {i:"…™ n", t:"in"}, {t:" "}, {i:"√∞ …ô", t:"the"}, {t:" "}, {i:"p …ëÀêr t i:", t:"party."} ]},
        { type: "game", title: "GAME 1: SƒÉn √¢m /…î…™/", gameType: "snake", phoneme: "…î…™", img: "…î…™_card.jpg" },
        { type: "game", title: "GAME 2: SƒÉn √¢m /tÃ¨/", gameType: "snake", phoneme: "tÃ¨", img: "tÃ¨_card.jpg" }
    ],
    lesson20: [
        { img: "mat.jpg", speak: "mat", parts: [{i:"m", t:"m"}, {i:"√¶ t", t:"at"}] },
        { img: "game.jpg", speak: "game", parts: [{i:"g", t:"g"}, {i:"e…™ m", t:"ame"}] },
        { img: "mad.jpg", speak: "mad", parts: [{i:"m", t:"m"}, {i:"√¶ d", t:"ad"}] },
        { img: "time.jpg", speak: "time", parts: [{i:"t", t:"t"}, {i:"a…™ m", t:"ime"}] },
        { img: "mouse.jpg", speak: "mouse", parts: [{i:"m", t:"m"}, {i:"a ä s", t:"ouse"}] },
        { img: "net.jpg", speak: "net", parts: [{i:"n", t:"n"}, {i:"e t", t:"et"}] },
        { img: "sun.jpg", speak: "sun", parts: [{i:"s", t:"s"}, {i:" å n", t:"un"}] },
        { img: "note.jpg", speak: "note", parts: [{i:"n", t:"n"}, {i:"o ä t", t:"ote"}] },
        { img: "nine.jpg", speak: "nine", parts: [{i:"n", t:"n"}, {i:"a…™ n", t:"ine"}] },
        { img: "fun.jpg", speak: "fun", parts: [{i:"f", t:"f"}, {i:" å n", t:"un"}] },
        { type: "sent", img: "sentence_mom.jpg", speak: "Mom is sick. Mika makes milk for mom", parts: [{i:"M …í m", t:"Mom"}, {t:" "}, {i:"…™ z", t:"is"}, {t:" "}, {i:"s …™ k", t:"sick."}, {t:" "}, {i:"M i: k …ô", t:"Mika"}, {t:" "}, {i:"m e…™ k s", t:"makes"}, {t:" "}, {i:"m …™ l k", t:"milk"}, {t:" "}, {i:"f …î:r", t:"for"}, {t:" "}, {i:"m …í m", t:"mom."}] },
        { type: "sent", img: "sentence_nina.jpg", speak: "Nina can run fast and she never gives up", parts: [{i:"N i: n …ô", t:"Nina"}, {t:" "}, {i:"k √¶ n", t:"can"}, {t:" "}, {i:"r  å n", t:"run"}, {t:" "}, {i:"f √¶ s t", t:"fast"}, {t:" "}, {i:"√¶ n d", t:"and"}, {t:" "}, {i:" É i:", t:"she"}, {t:" "}, {i:"n e v …ôr", t:"never"}, {t:" "}, {i:"g …™ v z", t:"gives"}, {t:" "}, {i:" å p", t:"up."}] },
        { type: "game", title: "Game /m/ & /n/", pairs: ["mat", "net", "mouse", "sun", "game"], img: "mat.jpg" }
    ],
    lesson21: [
        { img: "sing.jpg", speak: "sing", parts: [{i:"s", t:"s"}, {i:"…™ ≈ã", t:"ing"}] },
        { img: "finger.jpg", speak: "finger", parts: [{i:"f …™ ≈ã", t:"fing"}, {i:"g …ôr", t:"er"}] },
        { img: "king.jpg", speak: "king", parts: [{i:"k", t:"k"}, {i:"…™ ≈ã", t:"ing"}] },
        { img: "kingfisher.jpg", speak: "kingfisher", parts: [{i:"k …™ ≈ã", t:"king"}, {i:"f …™  É …ôr", t:"fisher"}] },
        { img: "monkey.jpg", speak: "monkey", parts: [{i:"m  å ≈ã", t:"mon"}, {i:"k i", t:"key"}] },
        { img: "hat.jpg", speak: "hat", parts: [{i:"h", t:"h"}, {i:"√¶ t", t:"at"}] },
        { img: "hen.jpg", speak: "hen", parts: [{i:"h", t:"h"}, {i:"e n", t:"en"}] },
        { img: "hippo.jpg", speak: "hippo", parts: [{i:"h", t:"h"}, {i:"…™ p o ä", t:"ippo"}] },
        { img: "heart.jpg", speak: "heart", parts: [{i:"h", t:"h"}, {i:"…ë:r t", t:"eart"}] },
        { img: "horse.jpg", speak: "horse", parts: [{i:"h", t:"h"}, {i:"…î:r s", t:"orse"}] },
        { type: "sent", img: "sentence_monkey.jpg", speak: "The monkey is making an amazing gift for the flamingo", parts: [{i:"√∞ …ô", t:"The"}, {t:" "}, {i:"m  å ≈ã k i", t:"monkey"}, {t:" "}, {i:"…™ z", t:"is"}, {t:" "}, {i:"m e…™ k …™ ≈ã", t:"making"}, {t:" "}, {i:"…ôn", t:"an"}, {t:" "}, {i:"…ô m e…™ z …™ ≈ã", t:"amazing"}, {t:" "}, {i:"g …™ f t", t:"gift"}, {t:" "}, {i:"f …î:r", t:"for"}, {t:" "}, {i:"√∞ …ô", t:"the"}, {t:" "}, {i:"f l …ô m …™ ≈ã g o ä", t:"flamingo."}] },
        { type: "sent", img: "sentence_he.jpg", speak: "He hopes his sister is happy", parts: [{i:"H i:", t:"He"}, {t:" "}, {i:"h o ä p s", t:"hopes"}, {t:" "}, {i:"h …™ z", t:"his"}, {t:" "}, {i:"s …™ s t …ôr", t:"sister"}, {t:" "}, {i:"…™ z", t:"is"}, {t:" "}, {i:"h √¶ p i", t:"happy."}] },
        { type: "game", title: "Game /≈ã/ & /h/", pairs: ["sing", "hat", "king", "hen", "monkey"], img: "sing.jpg" }
    ],
    lesson22: [
        { img: "red.jpg", speak: "red", parts: [{i:"r", t:"r"}, {i:"e d", t:"ed"}] },
        { img: "run.jpg", speak: "run", parts: [{i:"r", t:"r"}, {i:" å n", t:"un"}] },
        { img: "carrot.jpg", speak: "carrot", parts: [{i:"k √¶", t:"car"}, {i:"r …ô t", t:"rot"}] },
        { img: "ring.jpg", speak: "ring", parts: [{i:"r", t:"r"}, {i:"…™ ≈ã", t:"ing"}] },
        { img: "rabbit.jpg", speak: "rabbit", parts: [{i:"r √¶", t:"rab"}, {i:"b …™ t", t:"bit"}] },
        { img: "lion.jpg", speak: "lion", parts: [{i:"l", t:"l"}, {i:"a…™ …ô n", t:"ion"}] },
        { img: "ladder.jpg", speak: "ladder", parts: [{i:"l √¶", t:"lad"}, {i:"d …ôr", t:"der"}] },
        { img: "ball.jpg", speak: "ball", parts: [{i:"b", t:"b"}, {i:"…î: l", t:"all"}] },
        { img: "lips.jpg", speak: "lips", parts: [{i:"l", t:"l"}, {i:"…™ p s", t:"ips"}] },
        { img: "lamp.jpg", speak: "lamp", parts: [{i:"l", t:"l"}, {i:"√¶ m p", t:"amp"}] },
        { type: "sent", img: "sentence_rick.jpg", speak: "Rick is ready to read a good story for Sarah", parts: [{i:"R …™ k", t:"Rick"}, {t:" "}, {i:"…™ z", t:"is"}, {t:" "}, {i:"r e d i", t:"ready"}, {t:" "}, {i:"t u:", t:"to"}, {t:" "}, {i:"r i: d", t:"read"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"g  ä d", t:"good"}, {t:" "}, {i:"s t …î:r i", t:"story"}, {t:" "}, {i:"f …î:r", t:"for"}, {t:" "}, {i:"S …õ r …ô", t:"Sarah."}] },
        { type: "sent", img: "sentence_lily.jpg", speak: "Lily likes to look at her Mom smiling", parts: [{i:"L …™ l i", t:"Lily"}, {t:" "}, {i:"l a…™ k s", t:"likes"}, {t:" "}, {i:"t u:", t:"to"}, {t:" "}, {i:"l  ä k", t:"look"}, {t:" "}, {i:"√¶ t", t:"at"}, {t:" "}, {i:"h …ôr", t:"her"}, {t:" "}, {i:"M …í m", t:"Mom"}, {t:" "}, {i:"s m a…™ l …™ ≈ã", t:"smiling."}] },
        { type: "game", title: "Game /r/ & /l/", pairs: ["red", "lion", "run", "ladder", "rabbit"], img: "red.jpg" }
    ],
    lesson23: [
        { img: "yellow.jpg", speak: "yellow", parts: [{i:"j e", t:"yel"}, {i:"l o ä", t:"low"}] },
        { img: "yoyo.jpg", speak: "yoyo", parts: [{i:"j o ä", t:"yo"}, {i:"j o ä", t:"yo"}] },
        { img: "yogurt.jpg", speak: "yogurt", parts: [{i:"j o ä", t:"yo"}, {i:"g …ô r t", t:"gurt"}] },
        { img: "yam.jpg", speak: "yam", parts: [{i:"j", t:"y"}, {i:"√¶ m", t:"am"}] },
        { img: "yak.jpg", speak: "yak", parts: [{i:"j", t:"y"}, {i:"√¶ k", t:"ak"}] },
        { img: "web.jpg", speak: "web", parts: [{i:"w", t:"w"}, {i:"e b", t:"eb"}] },
        { img: "wolf.jpg", speak: "wolf", parts: [{i:"w", t:"w"}, {i:" ä l f", t:"olf"}] },
        { img: "walk.jpg", speak: "walk", parts: [{i:"w", t:"w"}, {i:"…î: k", t:"alk"}] },
        { img: "winter.jpg", speak: "winter", parts: [{i:"w …™ n", t:"win"}, {i:"t …ôr", t:"ter"}] },
        { img: "water.jpg", speak: "water", parts: [{i:"w …î:", t:"wa"}, {i:"t …ôr", t:"ter"}] },
        { type: "sent", img: "sentence_your.jpg", speak: "Your kindness makes you a young hero", parts: [{i:"J …î:r", t:"Your"}, {t:" "}, {i:"k a…™ n d n …ô s", t:"kindness"}, {t:" "}, {i:"m e…™ k s", t:"makes"}, {t:" "}, {i:"j u:", t:"you"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"j  å ≈ã", t:"young"}, {t:" "}, {i:"h …™ r o ä", t:"hero."}] },
        { type: "sent", img: "sentence_we.jpg", speak: "We work well to win the race", parts: [{i:"W i:", t:"We"}, {t:" "}, {i:"w 3:r k", t:"work"}, {t:" "}, {i:"w e l", t:"well"}, {t:" "}, {i:"t u:", t:"to"}, {t:" "}, {i:"w …™ n", t:"win"}, {t:" "}, {i:"√∞ …ô", t:"the"}, {t:" "}, {i:"r e…™ s", t:"race."}] },
        { type: "game", title: "Game /j/ & /w/", pairs: ["yellow", "web", "yoyo", "wolf", "yogurt"], img: "yellow.jpg" }
    ],
    lesson24: [
        { img: "thin.jpg", speak: "thin", parts: [{i:"Œ∏", t:"th"}, {i:"…™ n", t:"in"}] },
        { img: "teeth.jpg", speak: "teeth", parts: [{i:"t i:", t:"tee"}, {i:"Œ∏", t:"th"}] },
        { img: "thumb.jpg", speak: "thumb", parts: [{i:"Œ∏", t:"th"}, {i:" å m", t:"umb"}] },
        { img: "earth.jpg", speak: "earth", parts: [{i:"3:r", t:"ear"}, {i:"Œ∏", t:"th"}] },
        { img: "birthday.jpg", speak: "birthday", parts: [{i:"b 3:r Œ∏", t:"birth"}, {i:"d e…™", t:"day"}] },
        { img: "father.jpg", speak: "father", parts: [{i:"f …ë:", t:"fa"}, {i:"√∞ …ôr", t:"ther"}] },
        { img: "together.jpg", speak: "together", parts: [{i:"t …ô", t:"to"}, {i:"g e", t:"ge"}, {i:"√∞ …ôr", t:"ther"}] },
        { img: "clothing.jpg", speak: "clothing", parts: [{i:"k l o ä", t:"clo"}, {i:"√∞ …™ ≈ã", t:"thing"}] },
        { img: "feather.jpg", speak: "feather", parts: [{i:"f e", t:"fea"}, {i:"√∞ …ôr", t:"ther"}] },
        { img: "weather.jpg", speak: "weather", parts: [{i:"w e", t:"wea"}, {i:"√∞ …ôr", t:"ther"}] },
        { type: "sent", img: "sentence_think.jpg", speak: "Think good things and say thank you to have a happy heart", parts: [{i:"Œ∏ …™ ≈ã k", t:"Think"}, {t:" "}, {i:"g  ä d", t:"good"}, {t:" "}, {i:"Œ∏ …™ ≈ã z", t:"things"}, {t:" "}, {i:"√¶ n d", t:"and"}, {t:" "}, {i:"s e…™", t:"say"}, {t:" "}, {i:"Œ∏ √¶ ≈ã k", t:"thank"}, {t:" "}, {i:"j u:", t:"you"}, {t:" "}, {i:"t u:", t:"to"}, {t:" "}, {i:"h √¶ v", t:"have"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"h √¶ p i", t:"happy"}, {t:" "}, {i:"h …ë:r t", t:"heart."}] },
        { type: "sent", img: "sentence_they.jpg", speak: "They help their mother with the dishes", parts: [{i:"√∞ e…™", t:"They"}, {t:" "}, {i:"h e l p", t:"help"}, {t:" "}, {i:"√∞ e r", t:"their"}, {t:" "}, {i:"m  å √∞ …ôr", t:"mother"}, {t:" "}, {i:"w …™ √∞", t:"with"}, {t:" "}, {i:"√∞ …ô", t:"the"}, {t:" "}, {i:"d …™  É …™ z", t:"dishes."}] },
        { type: "game", title: "Game /Œ∏/ & /√∞/", pairs: ["thin", "father", "thumb", "feather", "teeth"], img: "thin.jpg" }
    ],

    getLesson: function(num) {
        if(this["lesson" + num]) return this["lesson" + num];
        return [];
    }
};
/* === [D√ÅN PH·∫¶N 3 - LOGIC ENGINES V√ÄO ƒê√ÇY] === */
/* --- 3.2 X·ª¨ L√ù √ÇM THANH (AUDIO ENGINE) --- */
const AudioEngine = {
    isAudioAllowed: false, audioWin: new Audio("win.mp3"), audioCorrect: new Audio("correct.mp3"), audioWrong: new Audio("wrong.mp3"), currentUtterance: null,
    unlock: function() { this.isAudioAllowed = true; if ('speechSynthesis' in window) { const u = new SpeechSynthesisUtterance(''); window.speechSynthesis.speak(u); window.speechSynthesis.cancel(); } },
    stopAllAndBlock: function() { this.isAudioAllowed = false; window.speechSynthesis.cancel(); this.audioWin.pause(); this.audioWin.currentTime = 0; this.audioCorrect.pause(); this.audioCorrect.currentTime = 0; this.audioWrong.pause(); this.audioWrong.currentTime = 0; },
    stopCurrentSound: function() { window.speechSynthesis.cancel(); },
    playTTS: function(text) { if (!this.isAudioAllowed) return; this.stopCurrentSound(); if ('speechSynthesis' in window) { window.currentUtterance = new SpeechSynthesisUtterance(text); window.currentUtterance.lang = 'en-US'; window.currentUtterance.rate = 0.9; window.speechSynthesis.speak(window.currentUtterance); } },
    playEffect: function(type) { if (!this.isAudioAllowed) return; if (type === 'correct') this.audioCorrect.play().catch(e=>{}); if (type === 'wrong') this.audioWrong.play().catch(e=>{}); if (type === 'win') this.audioWin.play().catch(e=>{}); }
};

/* --- 3.3 LOGIC GAME CHUNG (GAME ENGINE) --- */
const GameEngine = {
    active: false, moleLoop: null, moleAudioLoop: null, hammerTimeout: null, timerInt: null, 
    score: 0, sec: 0, moles: [], moleRemainingWords: [], moleTarget: null,
    currentConfig: null, currentDataPool: [],
    
    WINNING_SCORE: 1000, 

    start: function(config, dataPool) {
        this.currentConfig = config; this.currentDataPool = dataPool;
        if (config.gameType === 'snake') { SnakeEngine.start(config, dataPool); return; }
        if (config.gameType === 'mole') this.startMoleGame(); else this.startFlipGame();
    },
    restart: function() { if(this.currentConfig) this.start(this.currentConfig, this.currentDataPool); },
    stop: function() {
        this.active = false; clearInterval(this.moleAudioLoop); clearTimeout(this.moleLoop); clearInterval(this.timerInt); clearTimeout(this.hammerTimeout);
        const allMoles = document.querySelectorAll('.mole'); allMoles.forEach(m => m.classList.remove('up', 'bonked'));
        const hammer = document.getElementById('cursor-hammer'); if(hammer) hammer.classList.remove('active');
        SnakeEngine.stop();
    },
    // MOLE Logic
    startMoleGame: function() {
        this.stop(); this.active = true; this.score = 0; this.sec = 0; this.updateScore(0);
        this.moles = document.querySelectorAll('.mole');
        document.getElementById('tower').style.display = 'none'; document.getElementById('whack-wrapper').style.display = 'flex'; document.getElementById('win-modal').style.display = 'none'; document.getElementById('snake-game-container').style.display = 'none';
        this.refillMoleWords();
        if(this.moleRemainingWords.length === 0) return alert("Kh√¥ng c√≥ d·ªØ li·ªáu t·ª´ v·ª±ng!");
        this.startTimer(); this.nextMoleRound();
    },
    refillMoleWords: function() { const targetPhoneme = this.currentConfig.phoneme; this.moleRemainingWords = this.currentDataPool.filter(w => w.parts && w.parts.some(p => p.i.includes(targetPhoneme))).sort(() => 0.5 - Math.random()); },
    nextMoleRound: function() {
        if (!this.active) return;
        if (this.score >= this.WINNING_SCORE) { this.win(); return; }
        if (this.moleRemainingWords.length === 0) { this.refillMoleWords(); }
        this.moleTarget = this.moleRemainingWords.pop();
        let html = ''; this.moleTarget.parts.forEach(p => { const ipaHtml = p.i ? p.i : "&nbsp;"; html += `<div class="target-char"><div class="target-ipa">${ipaHtml}</div><div class="target-txt">${p.t}</div></div>`; });
        document.getElementById('target-word-container').innerHTML = html;
        AudioEngine.playTTS(this.moleTarget.speak); clearInterval(this.moleAudioLoop);
        this.moleAudioLoop = setInterval(() => { if(this.active) AudioEngine.playTTS(this.moleTarget.speak); }, 2000);
        this.peep();
    },
    peep: function() {
        if (!this.active) return;
        let speed = Math.max(600, 1500 - (this.score * 0.8)); const time = speed + Math.random() * 400; 
        const hole = this.moles[Math.floor(Math.random() * this.moles.length)];
        let isTarget = Math.random() < 0.4; let moleImgData = isTarget ? this.moleTarget : this.currentDataPool[Math.floor(Math.random() * this.currentDataPool.length)];
        const imgEl = hole.querySelector('img'); imgEl.src = moleImgData.img; hole.dataset.speak = moleImgData.speak;
        hole.classList.add('up');
        this.moleLoop = setTimeout(() => { hole.classList.remove('up'); if (this.active) this.peep(); }, time);
    },
    bonk: function(moleEl, event) {
        if(!moleEl.classList.contains('up') || !this.active) return;
        let touchX = event.clientX || event.pageX; let touchY = event.clientY || event.pageY; this.spawnHammer(touchX, touchY);
        const clickedWord = moleEl.dataset.speak;
        if (clickedWord === this.moleTarget.speak) { AudioEngine.playEffect('correct'); moleEl.classList.add('bonked'); this.updateScore(100); this.showFloatingText(touchX, touchY, "+100", "yellow"); setTimeout(() => { moleEl.classList.remove('up', 'bonked'); clearTimeout(this.moleLoop); this.nextMoleRound(); }, 300); }
        else { AudioEngine.playEffect('wrong'); moleEl.classList.remove('up'); this.updateScore(-50); this.showFloatingText(touchX, touchY, "-50", "red"); }
    },
    spawnHammer: function(x, y) { const hammer = document.getElementById('cursor-hammer'); hammer.style.left = (x - 60) + 'px'; hammer.style.top = (y - 70) + 'px'; hammer.classList.remove('active'); void hammer.offsetWidth; hammer.classList.add('active'); clearTimeout(this.hammerTimeout); this.hammerTimeout = setTimeout(() => { hammer.classList.remove('active'); }, 150); },
    // FLIP Logic
    startFlipGame: function() {
        this.stop(); this.active = true; this.sec = 0; this.matches = 0;
        document.getElementById('tower').style.display = 'flex'; document.getElementById('whack-wrapper').style.display = 'none'; document.getElementById('win-modal').style.display = 'none'; document.getElementById('snake-game-container').style.display = 'none';
        const tower = document.getElementById('tower'); tower.innerHTML = '';
        let cards = [];
        this.currentConfig.pairs.forEach(key => {
            let original = this.currentDataPool.find(d => { if(d.type === 'game' || d.type === 'sent') return false; let fullWord = d.parts.map(p => p.t).join(""); return fullWord === key; });
            if(original) { cards.push({ id: key, type: 'img', content: `<img src="${original.img}">`, speak: original.speak }); let htmlText = `<div class="game-card-text">`; original.parts.forEach(p => { htmlText += `<div class="gc-block"><div class="gc-ipa">${p.i}</div><div class="gc-word">${p.t}</div></div>`; }); htmlText += `</div>`; cards.push({ id: key, type: 'text', content: htmlText, speak: original.speak }); }
        });
        cards.sort(() => 0.5 - Math.random());
        let cCount = 0; let num = 1; const rows = [3, 2, 3, 2];
        rows.forEach(cnt => {
            const rowDiv = document.createElement('div'); rowDiv.className = 'tower-row';
            for(let k=0; k<cnt; k++) {
                const c = cards[cCount]; const el = document.createElement('div'); el.className = 'card-flip'; el.dataset.speak = c.speak; el.dataset.id = c.id;
                el.innerHTML = `<div class="card-inner"><div class="face front">${num}</div><div class="face back">${c.content}</div></div>`;
                el.onclick = function() { GameEngine.cardClick(this); }; rowDiv.appendChild(el); cCount++; num++;
            }
            tower.appendChild(rowDiv);
        });
        this.startTimer();
    },
    cardClick: function(el) {
        if(el.classList.contains('flipped') || el.classList.contains('matched')) return;
        el.classList.add('flipped'); AudioEngine.playTTS(el.dataset.speak);
        if(!this.c1) { this.c1 = el; } else { this.c2 = el;
            if(this.c1.dataset.id === this.c2.dataset.id) { setTimeout(() => { this.c1.classList.add('matched'); this.c2.classList.add('matched'); this.c1 = null; this.c2 = null; this.matches++; AudioEngine.playEffect('correct'); if(this.matches === 5) this.win(); }, 600); }
            else { setTimeout(() => { this.c1.classList.remove('flipped'); this.c2.classList.remove('flipped'); this.c1 = null; this.c2 = null; AudioEngine.playEffect('wrong'); }, 1000); }
        }
    },
    startTimer: function() { clearInterval(this.timerInt); document.getElementById('timer').innerText = "00:00"; this.timerInt = setInterval(() => { this.sec++; let m=Math.floor(this.sec/60).toString().padStart(2,'0'); let s=(this.sec%60).toString().padStart(2,'0'); document.getElementById('timer').innerText = `${m}:${s}`; }, 1000); },
    updateScore: function(val) { this.score += val; if(this.score < 0) this.score = 0; document.getElementById('score-display').innerText = this.score; },
    showFloatingText: function(x, y, text, color) { const el = document.createElement('div'); el.className = 'floating-text'; el.innerText = text; el.style.left = x + 'px'; el.style.top = y + 'px'; el.style.color = color; document.body.appendChild(el); setTimeout(() => el.remove(), 800); },
    win: function() { this.stop(); AudioEngine.playEffect('win'); AudioEngine.playTTS("Excellent job!"); document.getElementById('win-msg').innerText = "Th·ªùi gian: " + document.getElementById('timer').innerText; document.getElementById('final-score').innerText = this.score; document.getElementById('win-modal').style.display = 'flex'; }
};

const SnakeEngine = {
    active: false, paused: false, gameLoopId: null, audioLoopId: null, boardSize: 15, snake: [], direction: {x: 0, y: 0}, nextDirection: {x: 0, y: 0}, 
    foods: [], score: 0, speed: 300, targetPhoneme: "", currentTargetWord: null, poolCorrect: [], poolWrong: [],
    lives: 3,

    start: function(config, dataPool) {
        this.stop(); this.active = true; this.paused = false; this.score = 0; this.speed = 550; this.lives = 3; this.targetPhoneme = config.phoneme;
        this.poolCorrect = dataPool.filter(w => w.parts && w.parts.some(p => p.i && p.i.includes(this.targetPhoneme)));
        this.poolWrong = dataPool.filter(w => !w.parts || !w.parts.some(p => p.i && p.i.includes(this.targetPhoneme)));
        if (this.poolCorrect.length === 0) return alert("Thi·∫øu d·ªØ li·ªáu √¢m /" + this.targetPhoneme + "/");

        document.getElementById('tower').style.display = 'none'; document.getElementById('whack-wrapper').style.display = 'none'; document.getElementById('snake-game-container').style.display = 'flex'; document.getElementById('win-modal').style.display = 'none'; document.getElementById('pause-modal').style.display = 'none'; document.getElementById('snake-score').innerText = this.score;
        this.updateLivesUI();
        
        const center = Math.floor(this.boardSize / 2);
        this.snake = [{x: center, y: center}, {x: center, y: center + 1}, {x: center, y: center + 2}];
        this.direction = {x: 0, y: -1}; this.nextDirection = {x: 0, y: -1};
        this.createBoard(); this.spawnFoods(); this.gameLoop(); this.startAudioLoop();
    },
    stop: function() { this.active = false; clearTimeout(this.gameLoopId); clearInterval(this.audioLoopId); },
    togglePause: function() { if (!this.active) return; this.paused = !this.paused; const modal = document.getElementById('pause-modal'); if (this.paused) { modal.style.display = 'flex'; clearInterval(this.audioLoopId); } else { modal.style.display = 'none'; this.gameLoop(); this.startAudioLoop(); } },
    startAudioLoop: function() { clearInterval(this.audioLoopId); if(this.currentTargetWord) AudioEngine.playTTS(this.currentTargetWord.speak); this.audioLoopId = setInterval(() => { if (this.active && !this.paused && this.currentTargetWord) { AudioEngine.playTTS(this.currentTargetWord.speak); } }, 4000); },
    createBoard: function() { const board = document.getElementById('snake-board'); board.innerHTML = ''; board.style.gridTemplateColumns = `repeat(${this.boardSize}, 1fr)`; board.style.gridTemplateRows = `repeat(${this.boardSize}, 1fr)`; for(let i=0; i < this.boardSize * this.boardSize; i++) { const cell = document.createElement('div'); cell.className = 'grid-cell'; board.appendChild(cell); } },
    updateLivesUI: function() {
        let hearts = "";
        for(let i=0; i<this.lives; i++) hearts += "‚ù§Ô∏è";
        for(let i=this.lives; i<3; i++) hearts += "üñ§";
        document.getElementById('snake-lives').innerText = hearts;
    },
    handleDeath: function(msg) {
        this.lives--;
        this.updateLivesUI();
        AudioEngine.playEffect('wrong');
        
        if (this.lives <= 0) {
            this.showGameOver(msg + " H·∫øt m·∫°ng r·ªìi!");
        } else {
            const center = Math.floor(this.boardSize / 2);
            this.snake = [{x: center, y: center}, {x: center, y: center + 1}, {x: center, y: center + 2}];
            this.direction = {x: 0, y: -1}; this.nextDirection = {x: 0, y: -1};
        }
    },
    gameLoop: function() {
        if (!this.active || this.paused) return;
        this.direction = this.nextDirection;
        const head = { ...this.snake[0] }; head.x += this.direction.x; head.y += this.direction.y;
        if (this.isCollision(head)) { 
            this.handleDeath("R·∫Øn ƒë·ª•ng t∆∞·ªùng!"); 
            if(this.lives > 0) { this.draw(); this.gameLoopId = setTimeout(() => { if(this.active) this.gameLoop(); }, this.speed); return; }
            else return;
        }
        this.snake.unshift(head);
        let ate = false;
        const foodIndex = this.foods.findIndex(f => f.x === head.x && f.y === head.y);
        if (foodIndex !== -1) {
            const food = this.foods[foodIndex];
            if (food.isCorrect) {
                ate = true; this.score += 10; document.getElementById('snake-score').innerText = this.score;
                AudioEngine.playEffect('correct'); 
                if (this.speed > 150) this.speed -= 20; 
                
                this.foods.splice(foodIndex, 1); this.spawnFoods(); this.startAudioLoop();
                if (this.score >= 100) { this.win(); return; }
            } else { 
                this.handleDeath(`Sai r·ªìi! "${food.word}" kh√¥ng ph·∫£i t·ª´ c·∫ßn t√¨m!`);
                if(this.lives > 0) {
                     this.foods.splice(foodIndex, 1);
                     this.snake.pop(); 
                     this.draw();
                     this.gameLoopId = setTimeout(() => { if(this.active) this.gameLoop(); }, this.speed); 
                     return;
                } else return;
            }
        }
        if (!ate) this.snake.pop();
        this.draw();
        this.gameLoopId = setTimeout(() => { if(this.active) this.gameLoop(); }, this.speed);
    },
    isCollision: function(pos) { if (pos.x < 0 || pos.x >= this.boardSize || pos.y < 0 || pos.y >= this.boardSize) return true; for (let i = 1; i < this.snake.length; i++) if (pos.x === this.snake[i].x && pos.y === this.snake[i].y) return true; return false; },
    spawnFoods: function() {
        this.foods = [];
        const correctWord = this.poolCorrect[Math.floor(Math.random() * this.poolCorrect.length)];
        this.currentTargetWord = correctWord; 
        
        const validWrongPool = this.poolWrong.filter(w => !w.img.includes("card.jpg"));
        const wrongWords = validWrongPool.sort(() => 0.5 - Math.random()).slice(0, 2); 
        
        const itemsToSpawn = [{ ...correctWord, isCorrect: true, icon: 'üçé' }, { ...wrongWords[0], isCorrect: false, icon: 'üçÑ' }];
        if (wrongWords[1]) itemsToSpawn.push({ ...wrongWords[1], isCorrect: false, icon: 'üí£' });
        itemsToSpawn.forEach(item => {
            let pos; do { 
                pos = { x: Math.floor(Math.random() * (this.boardSize - 2)) + 1, y: Math.floor(Math.random() * (this.boardSize - 2)) + 1 }; 
                
                // --- LOGIC TR√ÅNH V√ôNG N√öT B·∫§M (SAFE ZONE) ---
                let isSafeZone = (pos.y >= 11 && pos.x >= 4 && pos.x <= 10);
                if (isSafeZone) continue; 
                
                let isTooClose = this.foods.some(f => Math.abs(f.x - pos.x) <= 1 && Math.abs(f.y - pos.y) <= 1);
                if (isTooClose) continue; 
                
            } while (this.isOccupied(pos) || this.foods.some(f => Math.abs(f.x - pos.x) <= 1 && Math.abs(f.y - pos.y) <= 1));
            
            this.foods.push({ x: pos.x, y: pos.y, img: item.img, word: item.speak, isCorrect: item.isCorrect, icon: item.icon });
        });
        
        // --- S·ª¨A ƒê·ªîI VERSION 1.1: ·∫®n phi√™n √¢m n·∫øu l√† C√ÇU ---
        let ipaHtml = "";
        // N·∫øu kh√¥ng ph·∫£i lo·∫°i 'sent' (c√¢u) V√Ä ƒë·ªô d√†i t·ª´ < 2 (t·ª©c l√† t·ª´ ƒë∆°n) th√¨ m·ªõi hi·ªán IPA
        if (correctWord.type !== 'sent' && correctWord.speak.split(' ').length < 2) {
             let ipaStr = "";
             if (correctWord.parts) { ipaStr = correctWord.parts.map(p => p.i).join("").replace(/&nbsp;/g, ""); }
             ipaHtml = `<div style="color:red; font-size:14px;">/${ipaStr}/</div>`;
        }
        
        let fontSize = (correctWord.type === 'sent') ? '18px' : '24px';
        
        document.getElementById('snake-target-content').innerHTML = 
            `${ipaHtml}<div style="color:#d35400; font-size:${fontSize}; font-weight:900;">${correctWord.speak}</div>`;
    },
    isOccupied: function(pos) { if (this.snake.some(s => s.x === pos.x && s.y === pos.y)) return true; if (this.foods.some(f => f.x === pos.x && f.y === pos.y)) return true; const head = this.snake[0]; if (Math.abs(pos.x - head.x) < 3 && Math.abs(pos.y - head.y) < 3) return true; return false; },
    draw: function() {
        const cells = document.querySelectorAll('.grid-cell'); cells.forEach(c => { c.className = 'grid-cell'; c.innerHTML = ''; });
        this.foods.forEach(f => {
            const idx = f.y * this.boardSize + f.x;
            if (cells[idx]) { 
                const zIndex = 10; 
                cells[idx].innerHTML = `<div class="food-item" style="z-index:${zIndex}"><img class="food-img" src="${f.img}" onerror="this.style.display='none'"><div class="food-core">${f.icon}</div></div>`; 
            }
        });
        this.snake.forEach((part, index) => {
            const idx = part.y * this.boardSize + part.x;
            if (cells[idx]) {
                const div = document.createElement('div'); div.classList.add('snake-part');
                if (index === 0) {
                    div.classList.add('snake-head');
                    if (this.direction.y === -1) div.classList.add('head-down'); else if (this.direction.y === 1) div.classList.add('head-up'); else if (this.direction.x === -1) div.classList.add('head-left'); else if (this.direction.x === 1) div.classList.add('head-right');
                }
                cells[idx].appendChild(div);
            }
        });
    },
    changeDirection: function(newDirName) {
        if (this.paused) return; 
        let newDir = {x:0, y:0};
        if (newDirName === 'up') newDir = {x: 0, y: -1}; if (newDirName === 'down') newDir = {x: 0, y: 1};
        if (newDirName === 'left') newDir = {x: -1, y: 0}; if (newDirName === 'right') newDir = {x: 1, y: 0};
        if (this.direction.x + newDir.x === 0 && this.direction.y + newDir.y === 0) return;
        this.nextDirection = newDir;
    },
    showGameOver: function(msg) { this.stop(); AudioEngine.playTTS("Game Over!"); document.getElementById('win-msg').innerText = msg; document.getElementById('final-score').innerText = this.score; document.getElementById('win-modal').style.display = 'flex'; },
    win: function() { this.stop(); AudioEngine.playEffect('win'); AudioEngine.playTTS("You Win!"); document.getElementById('win-msg').innerText = "Tuy·ªát v·ªùi!"; document.getElementById('final-score').innerText = this.score; document.getElementById('win-modal').style.display = 'flex'; }
};

const LearningEngine = {
    currentData: [], idx: 0,
    initLesson: function(lessonNum) { this.currentData = DataEngine.getLesson(lessonNum); this.idx = 0; this.preload(); },
    preload: function() { this.currentData.forEach(item => { if(item.img) new Image().src = item.img; }); },
    render: function() {
        const item = this.currentData[this.idx]; if(!item) return; AudioEngine.stopCurrentSound();
        document.getElementById('game-screen').style.display = 'none'; document.getElementById('learning-screen').style.display = 'flex'; document.getElementById('win-modal').style.display = 'none'; document.getElementById('stars').innerText = "‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ"; document.getElementById('stars').classList.remove('active'); document.getElementById('feedback').innerText = "...";
        const imgEl = document.getElementById('learn-img'); const btnContainer = document.getElementById('action-container'); const infoDisplay = document.getElementById('info-display');
        if(item.type === 'game') {
            imgEl.src = item.img || 'https://img.icons8.com/color/500/controller.png';
            let titleColor = item.title.includes("GAME 1") ? "#e67e22" : (item.title.includes("GAME 2") ? "#9b59b6" : "#333");
            infoDisplay.innerHTML = `<h2 class="word-display" style="font-size:28px; color:${titleColor}; font-weight:900;">${item.title}</h2>`;
            btnContainer.innerHTML = `<button class="btn-action btn-game-entry" onclick="App.enterGame()">  üöÄ   Ch∆°i Ngay</button>`;
        } else {
            imgEl.src = item.img; btnContainer.innerHTML = ` <button class="btn-action btn-mic" id="mic-btn" onclick="LearningEngine.startListening()">  üé§   ƒê·ªçc Ngay</button> <button class="btn-action btn-listen" id="btn-replay" onclick="LearningEngine.onUserClickSpeak()">  üîä   Nghe L·∫°i</button> `;
            let html = ''; item.parts.forEach((p) => { if (p.t === " ") html += `<div class="spacer"></div>`; else { const ipaHtml = p.i ? p.i : "&nbsp;"; const textClass = (item.type === 'sent') ? 'sent-text' : 'cb-text'; const ipaClass = (item.type === 'sent') ? 'sent-ipa' : 'cb-ipa'; html += `<div class="char-block"><div class="${ipaClass}">${ipaHtml}</div><div class="${textClass}">${p.t}</div></div>`; } }); infoDisplay.innerHTML = html;
        }
    },
    nav: function(d) { if(this.idx + d >= 0 && this.idx + d < this.currentData.length) { this.idx += d; this.render(); } }, nextItem: function() { this.nav(1); },
    onUserClickSpeak: function() { const item = this.currentData[this.idx]; if(item && item.type !== 'game') { let text = item.speak || item.parts.map(p => p.t).join(""); if(item.pre) text = item.pre + ". " + text; AudioEngine.playTTS(text); } },
    startListening: function() { const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition; if (!SpeechRecognition) return alert("Thi·∫øt b·ªã kh√¥ng h·ªó tr·ª£ thu √¢m"); const btn = document.getElementById('mic-btn'); btn.disabled = true; btn.innerText = "  üëÇ   ƒêang nghe..."; btn.style.backgroundColor = "#e74c3c"; const recognition = new SpeechRecognition(); recognition.lang = 'en-US'; recognition.start(); recognition.onresult = (e) => { let heard = []; for(let i=0; i<e.results[0].length; i++) heard.push(e.results[0][i].transcript.toLowerCase()); this.checkResult(heard); }; recognition.onerror = () => { this.resetMic(); }; recognition.onend = () => { if(btn.disabled) this.resetMic(); }; },
    resetMic: function() { const btn = document.getElementById('mic-btn'); if(btn) { btn.disabled = false; btn.innerText = "  üé§   ƒê·ªçc Ngay"; btn.style.backgroundColor = "#27ae60"; } },
    checkResult: function(heardArray) { const item = this.currentData[this.idx]; const targetRaw = item.speak.toLowerCase().replace(/[.,!?]/g, "").trim(); let validAnswers = [targetRaw]; if (item.pre) validAnswers.push((item.pre + " " + targetRaw).toLowerCase()); let maxScore = 0; for (let text of heardArray) { let userText = text.trim(); for (let target of validAnswers) { if (userText.includes(target) || target.includes(userText)) maxScore = 100; } } let finalStars = 2; let msg = "Try again!"; if (maxScore >= 90) { finalStars = 5; msg = "Excellent!  üéâ "; AudioEngine.playEffect('win'); } else { AudioEngine.playEffect('wrong'); } let s = ""; for(let i=0; i<5; i++) s += (i < finalStars) ? "  ‚≠ê  " : "‚òÜ"; document.getElementById('stars').innerText = s; document.getElementById('stars').className = (finalStars === 5) ? "stars active" : "stars"; document.getElementById('feedback').innerText = msg; this.resetMic(); }
};

const App = {
    // T·ª± ƒë·ªông t·∫°o menu d·ª±a tr√™n d·ªØ li·ªáu hi·ªán c√≥
    initMenu: function() {
        const menuContainer = document.getElementById('menu-screen');
        // Gi·ªØ l·∫°i ti√™u ƒë·ªÅ
        menuContainer.innerHTML = '<div class="menu-title"> üìö  CH·ªåN B√ÄI H·ªåC</div>';
        
        // Danh s√°ch t√™n b√†i h·ªçc (T·∫°m th·ªùi hardcode ƒë·ªÉ hi·ªÉn th·ªã ƒë·∫πp, sau n√†y c√≥ th·ªÉ l·∫•y ƒë·ªông)
        const lessonTitles = {
            1: "B√†i 1: /t/ & /d/",
            2: "B√†i 2: /p/ & /b/",
            3: "B√†i 3: /√¶/ & /…™/",
            4: "B√†i 4: / å/ & /…ë:/",
            5: "B√†i 5: /e/",
            6: "B√†i 6: /k/ & /g/",
            7: "B√†i 7: /f/ & /v/",
            8: "B√†i 8: /s/ & /z/",
            9: "B√†i 9: / É/ & / í/",
            10: "B√†i 10: /t É/ & /d í/",
            11: "B√†i 11: √în t·∫≠p",
            12: "B√†i 12: /i:/ & /…™/",
            13: "B√†i 13: / ä/ & /u:/",
            14: "B√†i 14: /…ë:r/ & /…î:r/",
            15: "B√†i 15: /…ô/ & /3:r/",
            16: "B√†i 16: /…™r/ & /…õr/",
            17: "B√†i 17: /a ä/ & /o ä/",
            18: "B√†i 18: /e…™/ & /a…™/",
            19: "B√†i 19: /…î…™/ & /tÃ¨/",
            20: "B√†i 20: /m/ & /n/",
            21: "B√†i 21: /≈ã/ & /h/",
            22: "B√†i 22: /r/ & /l/",
            23: "B√†i 23: /j/ & /w/",
            24: "B√†i 24: /Œ∏/ & /√∞/"
        };

        for (let i = 1; i <= 24; i++) {
            if (DataEngine["lesson" + i]) {
                const btn = document.createElement('button');
                btn.className = 'btn-menu';
                btn.innerText = lessonTitles[i] || `B√†i ${i}`;
                btn.onclick = function() { App.startLesson(i); };
                menuContainer.appendChild(btn);
            }
        }
    },

    startLesson: function(num) { AudioEngine.unlock(); document.getElementById('menu-screen').style.display = 'none'; document.getElementById('main-container').style.display = 'block'; LearningEngine.initLesson(num); LearningEngine.render(); },
    enterGame: function() { document.getElementById('learning-screen').style.display = 'none'; document.getElementById('game-screen').style.display = 'flex'; const item = LearningEngine.currentData[LearningEngine.idx]; 
    let vocabList = [];
    // Qu√©t t√¨m b√†i h·ªçc ch·ª©a item hi·ªán t·∫°i
    for(let i=1; i<=24; i++) { 
        if(!DataEngine["lesson"+i]) continue;
        const lesson = DataEngine.getLesson(i); 
        if (lesson.includes(item)) { 
            vocabList = lesson.filter(l => l.img && l.type !== 'game'); 
            break; 
        } 
    }
    GameEngine.start(item, vocabList); },
    exitGame: function() { GameEngine.stop(); LearningEngine.render(); },
    goHome: function() { AudioEngine.stopAllAndBlock(); GameEngine.stop(); document.getElementById('main-container').style.display = 'none'; document.getElementById('menu-screen').style.display = 'flex'; }
};

window.onload = function() { 
    AudioEngine.stopAllAndBlock(); 
    App.initMenu(); // Kh·ªüi t·∫°o menu t·ª± ƒë·ªông
};
window.addEventListener('keydown', (e) => { if (!SnakeEngine.active) return; if (e.key === 'ArrowUp') SnakeEngine.changeDirection('up'); else if (e.key === 'ArrowDown') SnakeEngine.changeDirection('down'); else if (e.key === 'ArrowLeft') SnakeEngine.changeDirection('left'); else if (e.key === 'ArrowRight') SnakeEngine.changeDirection('right'); });
</script>
</body>
</html>
</script>
</body>
</html>
