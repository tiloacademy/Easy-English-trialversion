<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>B√© H·ªçc Ti·∫øng Anh (v1.4)</title>
<style>
/* --- CSS C∆† B·∫¢N --- */
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #87CEEB; margin: 0; padding: 0; height: 100vh; width: 100vw;
overflow: hidden; display: flex; flex-direction: column; user-select: none; }

/* --- MENU --- */
#menu-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 9999; display: flex; flex-direction: column;
align-items: center; justify-content: flex-start; gap: 10px; overflow-y: auto; padding: 20px 0; }
.menu-title { font-size: 32px; color: #ff6f00; font-weight: bold; margin-bottom: 20px; flex-shrink: 0;}
.btn-menu { background: white; border: 3px solid #00A4EF; color: #00A4EF; padding: 15px 30px; border-radius: 50px; font-size: 18px; font-weight: bold;
box-shadow: 0 5px #ccebfd; cursor: pointer; width: 90%; max-width: 400px; transition: transform 0.1s; margin-bottom: 5px; flex-shrink: 0; }
.btn-menu:active { transform: scale(0.95); background: #f0f8ff; }

/* --- MAIN CONTAINER --- */
#main-container { width: 100%; height: 100%; position: relative; }
#learning-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column;
padding: 5px 10px 90px 10px; background: #fff; z-index: 10; }

/* UI H·ªçc T·∫≠p */
.top-bar { height: 50px; display: flex; align-items: center; justify-content: space-between; padding: 0 5px; flex-shrink: 0; }
.btn-home { background: #eee; border: none; width: 40px; height: 40px; border-radius: 50%; font-size: 20px; cursor: pointer; }
.header-title { color: #ff6f00; font-size: 20px; font-weight: bold; }
.learn-img-wrapper { flex: 1; width: 100%; min-height: 0; display: flex; align-items: center; justify-content: center; margin: 5px 0; }
#learn-img { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 15px; }

/* S·ª¨A L·ªñI XU·ªêNG H√ÄNG: D√πng flex-wrap v√† inline-block */
.info-area { 
    min-height: 110px; flex-shrink: 0; 
    display: flex; flex-direction: row; flex-wrap: wrap; /* Cho ph√©p xu·ªëng d√≤ng c·∫£ kh·ªëi */
    align-items: center; justify-content: center; 
    gap: 2px; align-content: center;
}
.char-block { 
    display: inline-flex; flex-direction: column; align-items: center; justify-content: flex-end; 
    margin: 0 1px; 
    white-space: nowrap; /* QUAN TR·ªåNG: Kh√¥ng cho b·∫ª g√£y t·ª´ b√™n trong kh·ªëi */
}
.cb-ipa { font-size: 24px; color: red; font-weight: bold; font-family: sans-serif; height: 30px; line-height: 30px; }
.cb-text { font-size: 40px; color: #333; font-weight: bold; height: 50px; line-height: 50px; }
.sent-ipa { font-size: 16px; color: red; font-weight: bold; height: 20px; }
.sent-text { font-size: 24px; color: #333; font-weight: bold; height: 30px; }
.spacer { width: 15px; } /* Kho·∫£ng c√°ch gi·ªØa c√°c t·ª´ */

.stars { height: 30px; text-align: center; font-size: 32px; color: #e0e0e0; flex-shrink: 0; }
.stars.active { color: #FFD700; text-shadow: 0 0 5px orange; }
.feedback-text { height: 20px; text-align: center; font-size: 16px; color: #555; font-style: italic; margin-bottom: 5px; }
.action-row { height: 60px; flex-shrink: 0; display: flex; justify-content: center; gap: 15px; align-items: center; margin-bottom: 10px; }
.btn-action { flex: 1; height: 55px; border-radius: 30px; border: none; font-size: 20px; font-weight: bold; cursor: pointer; color: white; display: flex;
align-items: center; justify-content: center; gap: 8px; box-shadow: 0 4px rgba(0,0,0,0.2); max-width: 45%; }
.btn-mic { background: #27ae60; }
.btn-listen { background: #2980b9; }
.btn-game-entry { background: #9b59b6; width: 80%; max-width: none; animation: pulse 1.5s infinite; }
@keyframes pulse { 0% {transform: scale(1);} 50% {transform: scale(1.05);} 100% {transform: scale(1);} }
.nav-row { height: 60px; flex-shrink: 0; display: flex; justify-content: space-between; align-items: center; padding: 0 15px; margin-bottom: 15px; }
.btn-nav { width: 60px; height: 60px; border-radius: 50%; background: #f39c12; color: white; border: none; font-size: 30px; font-weight: bold; cursor: pointer;
box-shadow: 0 4px #d35400; }
.btn-nav:active { transform: translateY(2px); box-shadow: none; }

/* UI Game Chung */
#game-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #fff3e0; z-index: 20; flex-direction: column; }
.game-header { height: 60px; display: flex; justify-content: center; align-items: center; position: relative; background: rgba(255,255,255,0.9); border-bottom: 1px solid #ddd; flex-shrink: 0; z-index: 200; }
.timer-badge { background: white; border: 3px solid #d35400; color: #d35400; padding: 5px 25px; border-radius: 25px; font-size: 24px; font-weight: bold; }
.btn-close { position: absolute; right: 10px; background: #c0392b; color: white; width: 45px; height: 45px; border-radius: 50%; border: none; font-weight: bold; font-size: 20px; }
.game-footer { height: 100px; display: flex; justify-content: center; align-items: center; background: white; border-top: 1px solid #ccc; padding-bottom: 30px; flex-shrink: 0; z-index: 200;}
#win-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.98); z-index: 300; flex-direction: column; align-items: center; justify-content: center; }

/* CSS Game C≈© (Mole/Flip) */
.tower-container { flex: 1; width: 100%; display: flex; flex-direction: column; justify-content: center; padding: 10px 0; }
.tower-row { flex: 1; width: 100%; display: flex; justify-content: center; align-items: center; gap: 10px; margin-bottom: 5px; }
.card-flip { height: 95%; aspect-ratio: 0.75; position: relative; perspective: 1000px; }
.card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.4s; transform-style: preserve-3d; border-radius: 12px; box-shadow: 0 3px 6px rgba(0,0,0,0.3); }
.card-flip.flipped .card-inner { transform: rotateY(180deg); }
.card-flip.matched .card-inner { opacity: 0; pointer-events: none; }
.face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 12px; display: flex; align-items: center; justify-content: center; border: 2px solid #5d4037; }
.front { background: #8d6e63; color: #3e2723; font-size: 6vh; font-weight: 900; }
.back { background: white; transform: rotateY(180deg); padding: 2px; }
.back img { width: 95%; height: 95%; object-fit: contain; }

/* S·ª¨A L·ªñI HI·ªÇN TH·ªä TH·∫∫ L·∫¨T */
.game-card-text { 
    display: flex; flex-direction: row; flex-wrap: wrap; 
    align-items: center; justify-content: center; 
    height: 100%; width: 100%; 
}
.gc-block { 
    display: flex; flex-direction: column; 
    align-items: center; justify-content: center; /* CƒÉn gi·ªØa d·ªçc */
    margin: 0 1px; 
}
.gc-ipa { color: red; font-weight: bold; font-size: 2.2vh; height: 3vh; margin-bottom: 2px; }
.gc-word { color: #333; font-weight: bold; font-size: 3vh; }

#whack-wrapper { flex: 1; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; overflow: hidden; background: linear-gradient(to bottom, #87CEEB 0%, #87CEEB 40%, #8bc34a 40%, #8bc34a 100%); position: relative; padding-bottom: 20px; }
#whack-wrapper::before { content: ' ‚òÅ Ô∏è'; font-size: 60px; position: absolute; top: 30px; left: 20px; opacity: 0.8; }
#whack-wrapper::after { content: ' ‚òÅ Ô∏è'; font-size: 50px; position: absolute; top: 60px; right: 40px; opacity: 0.8; }
.wood-sign { background: #8d6e63; background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(0,0,0,0.05) 10px, rgba(0,0,0,0.05) 20px); border: 4px solid #5d4037; color: white; padding: 5px 15px; border-radius: 10px; font-weight: bold; box-shadow: 0 5px 10px rgba(0,0,0,0.4); text-align: center; min-width: 130px; text-shadow: 1px 1px 0px rgba(0,0,0,0.5); z-index: 10; }
.hud-row { display: flex; gap: 10px; margin-bottom: 10px; margin-top: 5px; z-index: 5; justify-content: center; width: 100%; }
#target-word-container { display: flex; flex-direction: row; justify-content: center; align-items: flex-end; background: white; padding: 5px 15px; border-radius: 8px; border: 2px solid #5d4037; margin-top: 5px; min-height: 45px; }
.target-char { display: flex; flex-direction: column; align-items: center; margin: 0 1px; }
.target-ipa { color: red; font-weight: bold; font-size: 14px; height: 16px; }
.target-txt { color: #333; font-weight: bold; font-size: 24px; }
.score-text { font-size: 24px; color: #fff; font-weight: 900; }
.game-field-3d { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; width: 90%; max-width: 400px; transform: perspective(800px) rotateX(25deg); padding: 20px; background-color: #6d4c41; background-image: radial-gradient(circle, #795548 10%, transparent 10%); background-size: 20px 20px; border-radius: 20px; border: 8px solid #388e3c; box-shadow: 0 20px 0 #2e7d32, 0 25px 25px rgba(0,0,0,0.6); }
.hole { position: relative; aspect-ratio: 1; background: #2b1b13; border-radius: 50%; box-shadow: inset 0 10px 20px black; overflow: hidden; border: 2px solid #5d4037; }
.mole { position: absolute; top: 100%; left: 10%; width: 80%; height: 95%; background: #D2691E; border-radius: 45% 45% 10% 10%; transition: top 0.2s cubic-bezier(0.68, -0.55, 0.265, 1.55); display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding-top: 5px; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.4); }
.mole::before { content: ' üëÄ '; font-size: 20px; position: absolute; top: 5px; }
.mole::after { content: ' üêΩ '; font-size: 16px; position: absolute; top: 22px; }
.mole.up { top: 0%; }
.mole-card { width: 120%; height: 60%; background: white; border: 3px solid #eee; border-radius: 8px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(0,0,0,0.4); z-index: 2; position: absolute; top: 45%; left: -10%; transform: rotate(-3deg); }
.mole-card img { width: 95%; height: 95%; object-fit: contain; pointer-events: none; }
.hammer { position: fixed; width: 100px; height: 100px; pointer-events: none; z-index: 100000; background-image: url('hammer.png'); background-size: contain; background-repeat: no-repeat; transform-origin: bottom right; display: none; filter: drop-shadow(5px 5px 5px rgba(0,0,0,0.3)); }
.hammer.active { display: block; animation: hammer-hit 0.15s ease-in; }
@keyframes hammer-hit { 0% { transform: rotate(30deg); } 50% { transform: rotate(-45deg) scale(0.9); } 100% { transform: rotate(0deg); } }
.floating-text { position: fixed; font-weight: 900; font-size: 28px; pointer-events: none; z-index: 1000; animation: floatUp 0.8s ease-out forwards; text-shadow: 2px 2px 0px black, -2px -2px 0px white; }
@keyframes floatUp { 0% { opacity: 1; transform: translateY(0) scale(1); } 100% { opacity: 0; transform: translateY(-60px) scale(1.5); } }
.mole.bonked { filter: brightness(1.3) sepia(0.5) hue-rotate(-30deg) saturate(2); transition: none; transform: scale(0.95); }

/* --- CSS GAME R·∫ÆN SƒÇN M·ªíI --- */
#snake-game-container {
    flex: 1; width: 100%; display: none; flex-direction: column; align-items: center; justify-content: flex-start;
    background-color: #dcedc8; background-image: radial-gradient(#8bc34a 2px, transparent 2.5px); background-size: 30px 30px; 
    position: relative; overflow: hidden;
}
#snake-target-bar {
    width: 95%; background: rgba(255,255,255,0.95); padding: 5px 15px; border-radius: 12px;
    margin-top: 10px; display: flex; justify-content: space-between; align-items: center;
    box-shadow: 0 4px 6px rgba(0,0,0,0.3); z-index: 200; height: 60px; flex-shrink: 0;
}
.target-label { font-weight: bold; color: #555; font-size: 16px; margin-right: 5px; }
#snake-target-content { display: flex; flex-direction: column; align-items: center; justify-content: center; }
#snake-score { font-size: 22px; font-weight: bold; color: #27ae60; }
#snake-lives { font-size: 22px; font-weight: bold; color: #e74c3c; margin-right: 10px;}
.btn-pause { background: #f39c12; color: white; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 20px; font-weight: bold; cursor: pointer; box-shadow: 0 3px #d35400; }
.btn-pause:active { transform: translateY(2px); box-shadow: none; }

#snake-board {
    margin: 5px auto; width: 95vw; flex: 1; max-width: 450px;
    background-color: transparent; border: none;
    display: grid; position: relative; z-index: 10;
}
.grid-cell { width: 100%; height: 100%; position: relative; border: none; }

/* R·∫ÆN: Z-INDEX 1000 */
.snake-part {
    width: 100%; height: 100%;
    position: absolute; top: 0; left: 0;
    background-image: url('snake-body.png'); background-size: contain; background-repeat: no-repeat; background-position: center;
    z-index: 1000 !important; 
}
.snake-head {
    position: absolute; top: 0; left: 0;
    background-image: url('snake-head.png');
    z-index: 1001 !important;
    transform-origin: center center; transition: transform 0.1s linear; 
    background-size: contain; background-repeat: no-repeat; background-position: center;
}
.head-up { transform: rotate(180deg); }
.head-down { transform: rotate(0deg); }
.head-left { transform: rotate(90deg); }
.head-right { transform: rotate(-90deg); }

/* M·ªíI: Z-INDEX 10 */
.food-item {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    z-index: 10; pointer-events: none;
}
.food-img { 
    width: 350%; height: 350%; object-fit: contain; 
    filter: drop-shadow(0 5px 5px rgba(0,0,0,0.5)); 
    z-index: 10; opacity: 1;
}
.food-core { 
    position: absolute; top: 0px; right: 0px; font-size: 10px; 
    background: white; border-radius: 50%; padding: 1px; z-index: 11; opacity: 0.9; border: 1px solid #ccc;
}

#d-pad {
    position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
    width: 180px; height: 140px;
    display: grid; grid-template-columns: 1fr 1fr 1fr; grid-template-rows: 1fr 1fr;
    gap: 10px; z-index: 200; touch-action: none; opacity: 0.6;
}
.d-btn { background: rgba(255, 255, 255, 0.4); border: 2px solid white; border-radius: 15px; color: #333; font-size: 30px; display: flex; align-items: center; justify-content: center; cursor: pointer; }
.d-btn:active { background: rgba(255, 255, 255, 0.8); transform: scale(0.95); }
.d-up { grid-column: 2; grid-row: 1; }
.d-left { grid-column: 1; grid-row: 2; }
.d-right { grid-column: 3; grid-row: 2; }
.d-down { grid-column: 2; grid-row: 2; }

#pause-modal { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 300; flex-direction: column; align-items: center; justify-content: center; }
.pause-text { color: white; font-size: 40px; font-weight: bold; margin-bottom: 20px; text-shadow: 0 2px 4px black; }
</style>
</head>
<body>
<div id="cursor-hammer" class="hammer"></div>

<div id="menu-screen">
    </div>

<div id="main-container" style="display: none;">
    <div id="learning-screen">
        <div class="top-bar">
            <button class="btn-home" onclick="App.goHome()"> üè† </button>
            <div class="header-title"> üêª B√© H·ªçc Ti·∫øng Anh üê∞ </div>
            <div style="width: 40px;"></div>
        </div>
        <div class="learn-img-wrapper"><img id="learn-img" src="" alt="H√¨nh ·∫£nh"></div>
        <div class="info-area" id="info-display"></div>
        <div class="stars" id="stars">‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</div>
        <div class="feedback-text" id="feedback">...</div>
        <div class="action-row" id="action-container">
            <button class="btn-action btn-mic" id="mic-btn" onclick="LearningEngine.startListening()"> üé§ ƒê·ªçc Ngay</button>
            <button class="btn-action btn-listen" id="btn-replay" onclick="LearningEngine.onUserClickSpeak()"> üîä Nghe L·∫°i</button>
        </div>
        <div class="nav-row">
            <button class="btn-nav" onclick="LearningEngine.nav(-1)"> ‚óÄ </button>
            <button class="btn-nav" onclick="LearningEngine.nav(1)"> ‚ñ∂ </button>
        </div>
    </div>

    <div id="game-screen" style="display: none;">
        <div class="game-header">
            <div style="width:40px;"></div>
            <div class="timer-badge"> ‚è± Ô∏è <span id="timer">00:00</span></div>
            <button class="btn-close" onclick="App.exitGame()"> ‚úï </button>
        </div>

        <div id="tower" class="tower-container" style="display:none;"></div>
        <div id="whack-wrapper" style="display:none;">
            <div class="hud-row">
                <div class="wood-sign"><small>M·ª§C TI√äU:</small><br><div id="target-word-container"></div></div>
                <div class="wood-sign"><small>ƒêI·ªÇM S·ªê:</small><br><span id="score-display" class="score-text">0</span></div>
            </div>
            <div class="game-field-3d">
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
            </div>
        </div>

        <div id="snake-game-container">
            <div id="snake-target-bar">
                <button class="btn-pause" onclick="SnakeEngine.togglePause()">‚è∏</button>
                <div class="target-label">SƒÉn t·ª´:</div>
                <div id="snake-target-content"></div>
                <div><span id="snake-lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span>üèÜ <span id="snake-score">0</span></div>
            </div>
            <div id="snake-board"></div>
            <div id="d-pad">
                <div></div><div class="d-btn d-up" onclick="SnakeEngine.changeDirection('up')">‚¨ÜÔ∏è</div><div></div>
                <div class="d-btn d-left" onclick="SnakeEngine.changeDirection('left')">‚¨ÖÔ∏è</div>
                <div class="d-btn d-down" onclick="SnakeEngine.changeDirection('down')">‚¨áÔ∏è</div>
                <div class="d-btn d-right" onclick="SnakeEngine.changeDirection('right')">‚û°Ô∏è</div>
            </div>
            <div id="pause-modal">
                <div class="pause-text">T·∫†M D·ª™NG</div>
                <button class="btn-menu" style="width:auto;" onclick="SnakeEngine.togglePause()">‚ñ∂ Ti·∫øp t·ª•c ch∆°i</button>
            </div>
        </div>

        <div class="game-footer">
            <button class="btn-action btn-nav" style="width: 60%; border-radius: 30px; font-size: 20px; box-shadow: 0 4px #e67e22; background-color: #e67e22;" onclick="GameEngine.restart()"> ‚Üª Ch∆°i l·∫°i</button>
        </div>
        <div id="win-modal">
            <h1 style="color:green; font-size:36px; margin-bottom: 10px;">HO√ÄN TH√ÄNH! üéâ </h1>
            <h2 style="color:#d35400; font-size:40px; margin: 5px 0;">T·ªïng ƒëi·ªÉm: <span id="final-score">0</span></h2>
            <p id="win-msg" style="font-size:20px; color:#555; margin-bottom: 30px;">Th·ªùi gian: 00:00</p>
            <button class="btn-action btn-nav" style="width:auto; padding: 0 40px;" onclick="GameEngine.restart()">Ch∆°i l·∫°i</button>
            <br><br>
            <button class="btn-action btn-listen" style="width:auto; padding: 0 40px;" onclick="LearningEngine.nextItem()">B√†i Ti·∫øp ‚û° </button>
        </div>
    </div>
</div>

<script>
/* ==========================================================================
   PH·∫¶N 1: C·∫§U H√åNH MENU & D·ªÆ LI·ªÜU B√ÄI H·ªåC (LEVEL MAP)
   ========================================================================== */
const LevelMap = [
    { id: 1, type: 'learn', label: 'B√†i 1: /t/ & /d/', color: '#58cc02' },
    { id: 2, type: 'learn', label: 'B√†i 2: /p/ & /b/', color: '#58cc02' },
    { id: 3, type: 'learn', label: 'B√†i 3: /√¶/ & /…™/', color: '#58cc02' },
    { id: 4, type: 'learn', label: 'B√†i 4: / å/ & /…ë/', color: '#58cc02' }, /* ƒê√£ s·ª≠a t√™n b√†i 4 th√†nh /…ë/ */
    { id: 5, type: 'learn', label: 'B√†i 5: /e/', color: '#58cc02' },
    { id: 6, type: 'learn', label: 'B√†i 6: /k/ & /g/', color: '#58cc02' },
    { id: 7, type: 'learn', label: 'B√†i 7: /f/ & /v/', color: '#58cc02' },
    { id: 8, type: 'learn', label: 'B√†i 8: /s/ & /z/', color: '#58cc02' },
    { id: 9, type: 'learn', label: 'B√†i 9: / É/ & / í/', color: '#58cc02' },
    { id: 10, type: 'learn', label: 'B√†i 10: /t É/ & /d í/', color: '#58cc02' },
    { id: 11, type: 'learn', label: 'B√†i 11: √în t·∫≠p', color: '#ff9600' },
    { id: 12, type: 'learn', label: 'B√†i 12: /i:/ & /…™/', color: '#58cc02' },
    { id: 13, type: 'learn', label: 'B√†i 13: / ä/ & /u:/', color: '#58cc02' },
    { id: 14, type: 'learn', label: 'B√†i 14: /…ë:r/ & /…î:r/', color: '#58cc02' },
    { id: 15, type: 'learn', label: 'B√†i 15: /…ô/ & /…úÀêr/', color: '#58cc02' },
    { id: 16, type: 'learn', label: 'B√†i 16: /…™r/ & /er/', color: '#58cc02' },
    { id: 17, type: 'learn', label: 'B√†i 17: /a ä/ & /o ä/', color: '#58cc02' },
    { id: 18, type: 'learn', label: 'B√†i 18: /e…™/ & /a…™/', color: '#58cc02' },
    { id: 19, type: 'learn', label: 'B√†i 19: /…î…™/ & /tÃ¨/', color: '#58cc02' },
    { id: 20, type: 'learn', label: 'B√†i 20: /m/ & /n/', color: '#58cc02' },
    { id: 21, type: 'learn', label: 'B√†i 21: /≈ã/ & /h/', color: '#58cc02' },
    { id: 22, type: 'learn', label: 'B√†i 22: /r/ & /l/', color: '#58cc02' },
    { id: 23, type: 'learn', label: 'B√†i 23: /j/ & /w/', color: '#58cc02' },
    { id: 24, type: 'learn', label: 'B√†i 24: /Œ∏/ & /√∞/', color: '#58cc02' }
];

/* === [D√ÅN PH·∫¶N 2 V√ÄO ƒê√ÇY] === */

/* === [D√ÅN PH·∫¶N 3 V√ÄO ƒê√ÇY] === */

</script>
</body>
</html>
const DataEngine = {
    lesson1: [
        { img: "tap.jpg", speak: "tap", parts: [{t:"t"}, {i:"√¶", t:"a"}, {t:"p"}] },
        { img: "top.jpg", speak: "top", parts: [{t:"t"}, {i:"…ë", t:"o"}, {t:"p"}] },
        { img: "pot.jpg", speak: "pot", parts: [{t:"p"}, {i:"…ë", t:"o"}, {t:"t"}] },
        { img: "to.jpg", speak: "to", parts: [{t:"t"}, {i:"u:", t:"o"}] },
        { img: "tin.jpg", speak: "tin", parts: [{t:"t"}, {i:"…™", t:"i"}, {t:"n"}] },
        { img: "dog.jpg", speak: "dog", parts: [{t:"d"}, {i:"…ë", t:"o"}, {t:"g"}] },
        { img: "dad.jpg", speak: "dad", parts: [{t:"d"}, {i:"√¶", t:"a"}, {t:"d"}] },
        { img: "dig.jpg", speak: "dig", parts: [{t:"d"}, {i:"…™", t:"i"}, {t:"g"}] },
        { img: "duck.jpg", speak: "duck", parts: [{t:"d"}, {i:" å", t:"u"}, {i:"k", t:"ck"}] },
        { img: "do.jpg", speak: "do", parts: [{t:"d"}, {i:"u:", t:"o"}] },
        { type: "game", title: "Game /t/", pairs: ["tap", "top", "pot", "to", "tin"], img: "t_card.jpg" },
        { type: "game", title: "Game /d/", pairs: ["dog", "dad", "dig", "duck", "do"], img: "d_card.jpg" }
    ],
    lesson2: [
        { img: "pen.jpg", speak: "pen", parts: [{t:"p"}, {i:"e", t:"e"}, {t:"n"}] },
        { img: "pig.jpg", speak: "pig", parts: [{t:"p"}, {i:"…™", t:"i"}, {t:"g"}] },
        { img: "pot.jpg", speak: "pot", parts: [{t:"p"}, {i:"…ë", t:"o"}, {t:"t"}] },
        { img: "pull.jpg", speak: "pull", parts: [{t:"p"}, {i:" ä", t:"u"}, {t:"ll"}] },
        { img: "pin.jpg", speak: "pin", parts: [{t:"p"}, {i:"…™", t:"i"}, {t:"n"}] },
        { img: "bag.jpg", speak: "bag", parts: [{t:"b"}, {i:"√¶", t:"a"}, {t:"g"}] },
        { img: "book.jpg", speak: "book", parts: [{t:"b"}, {i:" ä", t:"oo"}, {t:"k"}] },
        { img: "bat.jpg", speak: "bat", parts: [{t:"b"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "box.jpg", speak: "box", parts: [{t:"b"}, {i:"…ë", t:"o"}, {i:"k s", t:"x"}] },
        { img: "bin.jpg", speak: "bin", parts: [{t:"b"}, {i:"…™", t:"i"}, {t:"n"}] },
        { type: "game", title: "Game /p/", pairs: ["pen", "pig", "pot", "pull", "pin"], img: "p_card.jpg" },
        { type: "game", title: "Game /b/", pairs: ["bag", "book", "bat", "box", "bin"], img: "b_card.jpg" }
    ],
    lesson3: [
        { img: "bat.jpg", speak: "bat", parts: [{t:"b"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "dad.jpg", speak: "dad", parts: [{t:"d"}, {i:"√¶", t:"a"}, {t:"d"}] },
        { img: "pat.jpg", speak: "pat", parts: [{t:"p"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "tap.jpg", speak: "tap", parts: [{t:"t"}, {i:"√¶", t:"a"}, {t:"p"}] },
        { img: "bad.jpg", speak: "bad", parts: [{t:"b"}, {i:"√¶", t:"a"}, {t:"d"}] },
        { img: "dip.jpg", speak: "dip", parts: [{t:"d"}, {i:"…™", t:"i"}, {t:"p"}] },
        { img: "bit.jpg", speak: "bit", parts: [{t:"b"}, {i:"…™", t:"i"}, {t:"t"}] },
        { img: "pit.jpg", speak: "pit", parts: [{t:"p"}, {i:"…™", t:"i"}, {t:"t"}] },
        { img: "tip.jpg", speak: "tip", parts: [{t:"t"}, {i:"…™", t:"i"}, {t:"p"}] },
        { img: "bib.jpg", speak: "bib", parts: [{t:"b"}, {i:"…™", t:"i"}, {t:"b"}] },
        { type: "game", title: "Game /√¶/", pairs: ["bat", "dad", "pat", "tap", "bad"], img: "√¶_card.jpg" },
        { type: "game", title: "Game /…™/", pairs: ["dip", "bit", "pit", "tip", "bib"], img: "…™_card.jpg" }
    ],
    lesson4: [
        { img: "duck.jpg", speak: "duck", parts: [{t:"d"}, {i:" å", t:"u"}, {i:"k", t:"ck"}] },
        { img: "but.jpg", speak: "but", parts: [{t:"b"}, {i:" å", t:"u"}, {t:"t"}] },
        { img: "tub.jpg", speak: "tub", parts: [{t:"t"}, {i:" å", t:"u"}, {t:"b"}] },
        { img: "cup.jpg", speak: "cup", parts: [{i:"k", t:"c"}, {i:" å", t:"u"}, {t:"p"}] },
        { img: "bud.jpg", speak: "bud", parts: [{t:"b"}, {i:" å", t:"u"}, {t:"d"}] },
        { img: "dot.jpg", speak: "dot", parts: [{t:"d"}, {i:"…ë", t:"o"}, {t:"t"}] },
        { img: "top.jpg", speak: "top", parts: [{t:"t"}, {i:"…ë", t:"o"}, {t:"p"}] },
        { img: "pot.jpg", speak: "pot", parts: [{t:"p"}, {i:"…ë", t:"o"}, {t:"t"}] },
        { img: "dog.jpg", speak: "dog", parts: [{t:"d"}, {i:"…ë", t:"o"}, {t:"g"}] },
        { img: "Bob.jpg", speak: "Bob", parts: [{t:"B"}, {i:"…ë", t:"o"}, {t:"b"}] },
        { type: "game", title: "Game / å/", pairs: ["duck", "but", "tub", "cup", "bud"], img: " å_card.jpg" },
        { type: "game", title: "Game /…ë/", pairs: ["dot", "top", "pot", "dog", "Bob"], img: "…ë_card.jpg" }
    ],
    lesson5: [
        { img: "Ted.jpg", speak: "Ted", parts: [{t:"T"}, {i:"e", t:"e"}, {t:"d"}] },
        { img: "pen.jpg", speak: "pen", parts: [{t:"p"}, {i:"e", t:"e"}, {t:"n"}] },
        { img: "ten.jpg", speak: "ten", parts: [{t:"t"}, {i:"e", t:"e"}, {t:"n"}] },
        { img: "bed.jpg", speak: "bed", parts: [{t:"b"}, {i:"e", t:"e"}, {t:"d"}] },
        { img: "pet.jpg", speak: "pet", parts: [{t:"p"}, {i:"e", t:"e"}, {t:"t"}] },
        { type: "game", title: "Game /e/", pairs: ["Ted", "pen", "ten", "bed", "pet"], img: "e_card.jpg" }
    ],
    lesson6: [
        { img: "cat.jpg", speak: "cat", parts: [{i:"k", t:"c"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "kid.jpg", speak: "kid", parts: [{t:"k"}, {i:"…™", t:"i"}, {t:"d"}] },
        { img: "cap.jpg", speak: "cap", parts: [{i:"k", t:"c"}, {i:"√¶", t:"a"}, {t:"p"}] },
        { img: "cot.jpg", speak: "cot", parts: [{i:"k", t:"c"}, {i:"…ë", t:"o"}, {t:"t"}] },
        { img: "cup.jpg", speak: "cup", parts: [{i:"k", t:"c"}, {i:" å", t:"u"}, {t:"p"}] },
        { img: "gap.jpg", speak: "gap", parts: [{t:"g"}, {i:"√¶", t:"a"}, {t:"p"}] },
        { img: "got.jpg", speak: "got", parts: [{t:"g"}, {i:"…ë", t:"o"}, {t:"t"}] },
        { img: "dig.jpg", speak: "dig", parts: [{t:"d"}, {i:"…™", t:"i"}, {t:"g"}] },
        { img: "dog.jpg", speak: "dog", parts: [{t:"d"}, {i:"…ë", t:"o"}, {t:"g"}] },
        { img: "get.jpg", speak: "get", parts: [{t:"g"}, {i:"e", t:"e"}, {t:"t"}] },
        { type: "game", title: "Game /k/", pairs: ["cat", "kid", "cap", "cot", "cup"], img: "k_card.jpg" },
        { type: "game", title: "Game /g/", pairs: ["gap", "got", "dig", "dog", "get"], img: "g_card.jpg" }
    ],
    lesson7: [
        { img: "fog.jpg", speak: "fog", parts: [{t:"f"}, {i:"…ë", t:"o"}, {t:"g"}] },
        { img: "fit.jpg", speak: "fit", parts: [{t:"f"}, {i:"…™", t:"i"}, {t:"t"}] },
        { img: "fig.jpg", speak: "fig", parts: [{t:"f"}, {i:"…™", t:"i"}, {t:"g"}] },
        { img: "fat.jpg", speak: "fat", parts: [{t:"f"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "fed.jpg", speak: "fed", parts: [{t:"f"}, {i:"e", t:"e"}, {t:"d"}] },
        { img: "vat.jpg", speak: "vat", parts: [{t:"v"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "vet.jpg", speak: "vet", parts: [{t:"v"}, {i:"e", t:"e"}, {t:"t"}] },
        { img: "van.jpg", speak: "van", parts: [{t:"v"}, {i:"√¶", t:"a"}, {t:"n"}] },
        { type: "sent", img: "sentence_fed.jpg", speak: "Bob fed a fat dog", parts: [{t:"B"}, {i:"…ë", t:"o"}, {t:"b"}, {t:" "}, {t:"f"}, {i:"e", t:"e"}, {t:"d"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"f"}, {i:"√¶", t:"a"}, {t:"t"}, {t:" "}, {t:"d"}, {i:"…ë", t:"o"}, {t:"g."}] },
        { type: "sent", img: "sentence_cat.jpg", speak: "A cat got a big cap", parts: [{i:"…ô", t:"A"}, {t:" "}, {i:"k", t:"c"}, {i:"√¶", t:"a"}, {t:"t"}, {t:" "}, {t:"g"}, {i:"…ë", t:"o"}, {t:"t"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"b"}, {i:"…™", t:"i"}, {t:"g"}, {t:" "}, {i:"k", t:"c"}, {i:"√¶", t:"a"}, {t:"p."}] },
        { type: "game", title: "Game /f/", pairs: ["fog", "fit", "fig", "fat", "fed"], img: "f_card.jpg" },
        { type: "game", title: "Game /v/", pairs: ["vat", "vet", "van"], img: "v_card.jpg" }
    ],
    lesson8: [
        { img: "bus.jpg", speak: "bus", parts: [{t:"b"}, {i:" å", t:"u"}, {t:"s"}] },
        { img: "kiss.jpg", speak: "kiss", parts: [{t:"k"}, {i:"…™", t:"i"}, {t:"ss"}] },
        { img: "sick.jpg", speak: "sick", parts: [{t:"s"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}] },
        { img: "sock.jpg", speak: "sock", parts: [{t:"s"}, {i:"…ë", t:"o"}, {i:"k", t:"ck"}] },
        { img: "sit.jpg", speak: "sit", parts: [{t:"s"}, {i:"…™", t:"i"}, {t:"t"}] },
        { img: "zip.jpg", speak: "zip", parts: [{t:"z"}, {i:"…™", t:"i"}, {t:"p"}] },
        { img: "zigzag.jpg", speak: "zigzag", parts: [{t:"z"}, {i:"…™", t:"i"}, {t:"g"}, {t:"z"}, {i:"√¶", t:"a"}, {t:"g"}] },
        { img: "bugs.jpg", speak: "bugs", parts: [{t:"b"}, {i:" å", t:"u"}, {t:"g"}, {i:"z", t:"s"}] },
        { img: "dogs.jpg", speak: "dogs", parts: [{t:"d"}, {i:"…ë", t:"o"}, {t:"g"}, {i:"z", t:"s"}] },
        { img: "is.jpg", speak: "is", parts: [{i:"…™", t:"i"}, {i:"z", t:"s"}] },
        { type: "sent", img: "sentence_pig.jpg", speak: "A pig gets a cup", parts: [{i:"…ô", t:"A"}, {t:" "}, {t:"p"}, {i:"…™", t:"i"}, {t:"g"}, {t:" "}, {t:"g"}, {i:"e", t:"e"}, {t:"t"}, {t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"k", t:"c"}, {i:" å", t:"u"}, {t:"p."}] },
        { type: "sent", img: "sentence_duck.jpg", speak: "A duck sits on the bed", parts: [{i:"…ô", t:"A"}, {t:" "}, {t:"d"}, {i:" å", t:"u"}, {i:"k", t:"ck"}, {t:" "}, {t:"s"}, {i:"…™", t:"i"}, {t:"t"}, {t:"s"}, {t:" "}, {i:"…ë", t:"o"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"b"}, {i:"e", t:"e"}, {t:"d."}] },
        { type: "sent", img: "sentence_dad.jpg", speak: "Dad digs a pit", parts: [{t:"D"}, {i:"√¶", t:"a"}, {t:"d"}, {t:" "}, {t:"d"}, {i:"…™", t:"i"}, {t:"g"}, {i:"z", t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"p"}, {i:"…™", t:"i"}, {t:"t."}] },
        { type: "game", title: "Game /s/", pairs: ["bus", "kiss", "sick", "sock", "sit"], img: "s_card.jpg" },
        { type: "game", title: "Game /z/", pairs: ["zip", "zigzag", "bugs", "dogs", "is"], img: "z_card.jpg" }
    ],
    lesson9: [
        { img: "shop.jpg", speak: "shop", parts: [{i:" É", t:"sh"}, {i:"…ë", t:"o"}, {t:"p"}] },
        { img: "ship.jpg", speak: "ship", parts: [{i:" É", t:"sh"}, {i:"…™", t:"i"}, {t:"p"}] },
        { img: "fish.jpg", speak: "fish", parts: [{t:"f"}, {i:"…™", t:"i"}, {i:" É", t:"sh"}] },
        { img: "dish.jpg", speak: "dish", parts: [{t:"d"}, {i:"…™", t:"i"}, {i:" É", t:"sh"}] },
        { img: "measure.jpg", speak: "measure", parts: [{t:"m"}, {i:"e", t:"ea"}, {i:" í", t:"s"}, {i:"…ôr", t:"ure"}] },
        { img: "treasure.jpg", speak: "treasure", parts: [{t:"t"}, {t:"r"}, {i:"e", t:"ea"}, {i:" í", t:"s"}, {i:"…ôr", t:"ure"}] },
        { img: "vision.jpg", speak: "vision", parts: [{t:"v"}, {i:"…™", t:"i"}, {i:" í", t:"s"}, {i:"…ôn", t:"ion"}] },
        { type: "sent", img: "sentence_shells.jpg", speak: "She sells seashells on the seashore", parts: [{i:" É", t:"Sh"}, {i:"i:", t:"e"}, {t:" "}, {t:"s"}, {i:"e", t:"e"}, {t:"ll"}, {i:"z", t:"s"}, {t:" "}, {t:"s"}, {i:"i:", t:"ea"}, {i:" É", t:"sh"}, {i:"e", t:"e"}, {t:"ll"}, {i:"z", t:"s"}, {t:" "}, {i:"…ë", t:"o"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"s"}, {i:"i:", t:"ea"}, {i:" É", t:"sh"}, {i:"…î:r", t:"ore."}] },
        { type: "sent", img: "sentence_fish.jpg", speak: "A fat fish sits on a treasure bag", parts: [{i:"…ô", t:"A"}, {t:" "}, {t:"f"}, {i:"√¶", t:"a"}, {t:"t"}, {t:" "}, {t:"f"}, {i:"…™", t:"i"}, {i:" É", t:"sh"}, {t:" "}, {t:"s"}, {i:"…™", t:"i"}, {t:"t"}, {t:"s"}, {t:" "}, {i:"…ë", t:"o"}, {t:"n"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"t"}, {t:"r"}, {i:"e", t:"ea"}, {i:" í", t:"s"}, {i:"…ôr", t:"ure"}, {t:" "}, {t:"b"}, {i:"√¶", t:"a"}, {t:"g."}] },
        { type: "game", title: "Game / É/", pairs: ["shop", "ship", "fish", "dish"], img: " É_card.jpg" },
        { type: "game", title: "Game / í/", pairs: ["measure", "treasure", "vision"], img: " í_card.jpg" }
    ],
    lesson10: [
        { img: "chick.jpg", speak: "chick", parts: [{i:"t É", t:"ch"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}] },
        { img: "chop.jpg", speak: "chop", parts: [{i:"t É", t:"ch"}, {i:"…ë", t:"o"}, {t:"p"}] },
        { img: "chin.jpg", speak: "chin", parts: [{i:"t É", t:"ch"}, {i:"…™", t:"i"}, {t:"n"}] },
        { img: "chip.jpg", speak: "chip", parts: [{i:"t É", t:"ch"}, {i:"…™", t:"i"}, {t:"p"}] },
        { img: "chat.jpg", speak: "chat", parts: [{i:"t É", t:"ch"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "jam.jpg", speak: "jam", parts: [{i:"d í", t:"j"}, {i:"√¶", t:"a"}, {t:"m"}] },
        { img: "jet.jpg", speak: "jet", parts: [{i:"d í", t:"j"}, {i:"e", t:"e"}, {t:"t"}] },
        { img: "jug.jpg", speak: "jug", parts: [{i:"d í", t:"j"}, {i:" å", t:"u"}, {t:"g"}] },
        { img: "Jack.jpg", speak: "Jack", parts: [{i:"d í", t:"J"}, {i:"√¶", t:"a"}, {i:"k", t:"ck"}] },
        { img: "job.jpg", speak: "job", parts: [{i:"d í", t:"j"}, {i:"…ë", t:"o"}, {t:"b"}] },
        { type: "sent", img: "sentence_cheerful.jpg", speak: "Cheerful children chase chatty chicks", parts: [{i:"t É", t:"Ch"}, {i:"…™r", t:"eer"}, {t:"f"}, {i:"…ô", t:"u"}, {t:"l"}, {t:" "}, {i:"t É", t:"ch"}, {i:"…™", t:"i"}, {t:"l"}, {t:"d"}, {t:"r"}, {i:"…ô", t:"e"}, {t:"n"}, {t:" "}, {i:"t É", t:"ch"}, {i:"e…™", t:"a"}, {t:"s"}, {i:"_", t:"e"}, {t:" "}, {i:"t É", t:"ch"}, {i:"√¶", t:"a"}, {t:"tt"}, {i:"i", t:"y"}, {t:" "}, {i:"t É", t:"ch"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}, {t:"s."}] },
        { type: "sent", img: "sentence_jack_jill.jpg", speak: "Jack and Jill juggle juicy ginger jars", parts: [{i:"d í", t:"J"}, {i:"√¶", t:"a"}, {i:"k", t:"ck"}, {t:" "}, {i:"√¶", t:"a"}, {t:"n"}, {t:"d"}, {t:" "}, {i:"d í", t:"J"}, {i:"…™", t:"i"}, {t:"ll"}, {t:" "}, {i:"d í", t:"j"}, {i:" å", t:"u"}, {t:"gg"}, {t:"l"}, {i:"_", t:"e"}, {t:" "}, {i:"d í", t:"j"}, {i:"u:", t:"ui"}, {i:"s", t:"c"}, {i:"i", t:"y"}, {t:" "}, {i:"d í", t:"g"}, {i:"…™", t:"in"}, {t:"n"}, {i:"d í", t:"g"}, {i:"…ôr", t:"er"}, {t:" "}, {i:"d í", t:"j"}, {i:"…ë:r", t:"ar"}, {t:"s."}] },
        { type: "sent", img: "sentence_chick.jpg", speak: "The chick checks the jam", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {i:"t É", t:"ch"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}, {t:" "}, {i:"t É", t:"ch"}, {i:"e", t:"e"}, {i:"k", t:"ck"}, {t:"s"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {i:"d í", t:"j"}, {i:"√¶", t:"a"}, {t:"m."}] },
        { type: "game", title: "Game /t É/", pairs: ["chick", "chop", "chin", "chip", "chat"], img: "t É_card.jpg" },
        { type: "game", title: "Game /d í/", pairs: ["jam", "jet", "jug", "Jack", "job"], img: "d í_card.jpg" }
    ],
    lesson11: [
        { type: "sent", img: "sentence_Jack.jpg", speak: "Jack got a fish on the dish", parts: [{i:"d í", t:"J"}, {i:"√¶", t:"a"}, {i:"k", t:"ck"}, {t:" "}, {t:"g"}, {i:"…ë", t:"o"}, {t:"t"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"f"}, {i:"…™", t:"i"}, {i:" É", t:"sh"}, {t:" "}, {i:"…ë", t:"o"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"d"}, {i:"…™", t:"i"}, {i:" É", t:"sh."}] },
        { type: "sent", img: "sentence_vet.jpg", speak: "The vet fed the chick on a big ship", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"v"}, {i:"e", t:"e"}, {t:"t"}, {t:" "}, {t:"f"}, {i:"e", t:"e"}, {t:"d"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {i:"t É", t:"ch"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}, {t:" "}, {i:"…ë", t:"o"}, {t:"n"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"b"}, {i:"…™", t:"i"}, {t:"g"}, {t:" "}, {i:" É", t:"sh"}, {i:"…™", t:"i"}, {t:"p."}] },
        { type: "sent", img: "sentence_bugs.jpg", speak: "Cats and dogs catch bugs on a big bus", parts: [{i:"k", t:"C"}, {i:"√¶", t:"a"}, {t:"t"}, {t:"s"}, {t:" "}, {i:"√¶", t:"a"}, {t:"n"}, {t:"d"}, {t:" "}, {t:"d"}, {i:"…ë", t:"o"}, {t:"g"}, {t:"s"}, {t:" "}, {i:"k", t:"c"}, {i:"√¶", t:"a"}, {i:"t É", t:"tch"}, {t:" "}, {t:"b"}, {i:" å", t:"u"}, {t:"g"}, {t:"s"}, {t:" "}, {i:"…ë", t:"o"}, {t:"n"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"b"}, {i:"…™", t:"i"}, {t:"g"}, {t:" "}, {t:"b"}, {i:" å", t:"u"}, {t:"s."}] }
    ],
    lesson12: [
        { img: "sea.jpg", speak: "sea", parts: [{t:"s"}, {i:"i:", t:"ea"}] },
        { img: "sheep.jpg", speak: "sheep", parts: [{i:" É", t:"sh"}, {i:"i:", t:"eep"}] },
        { img: "feet.jpg", speak: "feet", parts: [{t:"f"}, {i:"i:", t:"ee"}, {t:"t"}] },
        { img: "bee.jpg", speak: "bee", parts: [{t:"b"}, {i:"i:", t:"ee"}] },
        { img: "eat.jpg", speak: "eat", parts: [{i:"i:", t:"ea"}, {t:"t"}] },
        { type: "sent", img: "sentence_sheep.jpg", speak: "The sheep sees a bee", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {i:" É", t:"sh"}, {i:"i:", t:"eep"}, {t:" "}, {t:"s"}, {i:"i:", t:"ee"}, {t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"b"}, {i:"i:", t:"ee."}] },
        { type: "sent", img: "sentence_she.jpg", speak: "She keeps a big seed", parts: [{i:" É", t:"Sh"}, {i:"i:", t:"e"}, {t:" "}, {t:"k"}, {i:"i:", t:"ee"}, {t:"p"}, {t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"b"}, {i:"…™", t:"i"}, {t:"g"}, {t:" "}, {t:"s"}, {i:"i:", t:"ee"}, {t:"d."}] },
        { type: "game", title: "Game /i:/", pairs: ["sea", "sheep", "feet", "bee", "eat"], img: "iÀê_card.jpg" },
        { type: "game", title: "Game /…™/", pairs: ["dip", "bit", "pit", "tip", "bib"], img: "…™_card.jpg" } /* D√πng l·∫°i t·ª´ c·ªßa b√†i 3 n·∫øu c·∫ßn, ho·∫∑c n·∫øu b√†i 12 c√≥ list ri√™ng th√¨ update sau */
    ],
    lesson13: [
        { img: "put.jpg", speak: "put", parts: [{t:"p"}, {i:" ä", t:"u"}, {t:"t"}] },
        { img: "bush.jpg", speak: "bush", parts: [{t:"b"}, {i:" ä", t:"u"}, {i:" É", t:"sh"}] },
        { img: "book.jpg", speak: "book", parts: [{t:"b"}, {i:" ä", t:"oo"}, {t:"k"}] },
        { img: "foot.jpg", speak: "foot", parts: [{t:"f"}, {i:" ä", t:"oo"}, {t:"t"}] },
        { img: "cook.jpg", speak: "cook", parts: [{i:"k", t:"c"}, {i:" ä", t:"oo"}, {t:"k"}] },
        { img: "boot.jpg", speak: "boot", parts: [{t:"b"}, {i:"u:", t:"oo"}, {t:"t"}] },
        { img: "food.jpg", speak: "food", parts: [{t:"f"}, {i:"u:", t:"oo"}, {t:"d"}] },
        { img: "goose.jpg", speak: "goose", parts: [{t:"g"}, {i:"u:", t:"oo"}, {t:"s"}, {i:"_", t:"e"}] },
        { img: "zoo.jpg", speak: "zoo", parts: [{t:"z"}, {i:"u:", t:"oo"}] },
        { img: "shoot.jpg", speak: "shoot", parts: [{i:" É", t:"sh"}, {i:"u:", t:"oo"}, {t:"t"}] },
        { type: "sent", img: "sentence_book.jpg", speak: "Bob put the book in the bush", parts: [{t:"B"}, {i:"…ë", t:"o"}, {t:"b"}, {t:" "}, {t:"p"}, {i:" ä", t:"u"}, {t:"t"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"b"}, {i:" ä", t:"oo"}, {t:"k"}, {t:" "}, {i:"…™", t:"i"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"b"}, {i:" ä", t:"u"}, {i:" É", t:"sh."}] },
        { type: "sent", img: "sentence_goose.jpg", speak: "The goose eats food at the zoo", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"g"}, {i:"u:", t:"oo"}, {t:"s"}, {i:"_", t:"e"}, {t:" "}, {i:"i:", t:"ea"}, {t:"t"}, {t:"s"}, {t:" "}, {t:"f"}, {i:"u:", t:"oo"}, {t:"d"}, {t:" "}, {i:"√¶", t:"a"}, {t:"t"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"z"}, {i:"u:", t:"oo."}] },
        { type: "game", title: "Game / ä/", pairs: ["put", "bush", "book", "foot", "cook"], img: " ä_card.jpg" },
        { type: "game", title: "Game /u:/", pairs: ["boot", "food", "goose", "zoo", "shoot"], img: "uÀê_card.jpg" }
    ],
    lesson14: [
        { img: "shark.jpg", speak: "shark", parts: [{i:" É", t:"sh"}, {i:"…ë:r", t:"ar"}, {t:"k"}] },
        { img: "star.jpg", speak: "star", parts: [{t:"s"}, {t:"t"}, {i:"…ë:r", t:"ar"}] },
        { img: "cart.jpg", speak: "cart", parts: [{i:"k", t:"c"}, {i:"…ë:r", t:"ar"}, {t:"t"}] },
        { img: "car.jpg", speak: "car", parts: [{i:"k", t:"c"}, {i:"…ë:r", t:"ar"}] },
        { img: "park.jpg", speak: "park", parts: [{t:"p"}, {i:"…ë:r", t:"ar"}, {t:"k"}] },
        { img: "torch.jpg", speak: "torch", parts: [{t:"t"}, {i:"…î:r", t:"or"}, {i:"t É", t:"ch"}] },
        { img: "shorts.jpg", speak: "shorts", parts: [{i:" É", t:"sh"}, {i:"…î:r", t:"or"}, {t:"t"}, {t:"s"}] },
        { img: "board.jpg", speak: "board", parts: [{t:"b"}, {i:"…î:r", t:"oar"}, {t:"d"}] },
        { img: "door.jpg", speak: "door", parts: [{t:"d"}, {i:"…î:r", t:"oor"}] },
        { img: "fork.jpg", speak: "fork", parts: [{t:"f"}, {i:"…î:r", t:"or"}, {t:"k"}] },
        { type: "sent", img: "sentence_shark.jpg", speak: "A shark put a star in the jar", parts: [{i:"…ô", t:"A"}, {t:" "}, {i:" É", t:"sh"}, {i:"…ë:r", t:"ar"}, {t:"k"}, {t:" "}, {t:"p"}, {i:" ä", t:"u"}, {t:"t"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"s"}, {t:"t"}, {i:"…ë:r", t:"ar"}, {t:" "}, {i:"…™", t:"i"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {i:"d í", t:"j"}, {i:"…ë:r", t:"ar."}] },
        { type: "sent", img: "sentence_fork.jpg", speak: "A short fork drops on the floor", parts: [{i:"…ô", t:"A"}, {t:" "}, {i:" É", t:"sh"}, {i:"…î:r", t:"or"}, {t:"t"}, {t:" "}, {t:"f"}, {i:"…î:r", t:"or"}, {t:"k"}, {t:" "}, {t:"d"}, {t:"r"}, {i:"…ë", t:"o"}, {t:"p"}, {t:"s"}, {t:" "}, {i:"…ë", t:"o"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"f"}, {t:"l"}, {i:"…î:r", t:"oor."}] },
        { type: "game", title: "Game /…ë:r/", pairs: ["shark", "star", "cart", "car", "park"], img: "…ëÀêr_card.jpg" },
        { type: "game", title: "Game /…î:r/", pairs: ["torch", "shorts", "board", "door", "fork"], img: "…îÀêr_card.jpg" }
    ],
    lesson15: [
        { img: "salad.jpg", speak: "salad", parts: [{t:"s"}, {i:"√¶", t:"a"}, {t:"l"}, {i:"…ô", t:"a"}, {t:"d"}] },
        { img: "lemon.jpg", speak: "lemon", parts: [{t:"l"}, {i:"e", t:"e"}, {t:"m"}, {i:"…ô", t:"o"}, {t:"n"}] },
        { img: "chicken.jpg", speak: "chicken", parts: [{i:"t É", t:"ch"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}, {i:"…ô", t:"e"}, {t:"n"}] },
        { img: "kitchen.jpg", speak: "kitchen", parts: [{t:"k"}, {i:"…™", t:"i"}, {i:"t É", t:"tch"}, {i:"…ô", t:"e"}, {t:"n"}] },
        { img: "panda.jpg", speak: "panda", parts: [{t:"p"}, {i:"√¶", t:"a"}, {t:"n"}, {t:"d"}, {i:"…ô", t:"a"}] },
        { img: "banana.jpg", speak: "banana", parts: [{t:"b"}, {i:"…ô", t:"a"}, {t:"n"}, {i:"√¶", t:"a"}, {t:"n"}, {i:"…ô", t:"a"}] },
        { img: "badminton.jpg", speak: "badminton", parts: [{t:"b"}, {i:"√¶", t:"a"}, {t:"d"}, {t:"m"}, {i:"…™", t:"i"}, {t:"n"}, {t:"t"}, {i:"…ô", t:"o"}, {t:"n"}] },
        { img: "elephant.jpg", speak: "elephant", parts: [{i:"e", t:"e"}, {t:"l"}, {i:"…ô", t:"e"}, {i:"f", t:"ph"}, {i:"…ô", t:"a"}, {t:"n"}, {t:"t"}] },
        { img: "teacher.jpg", speak: "teacher", parts: [{t:"t"}, {i:"i:", t:"ea"}, {i:"t É", t:"ch"}, {i:"…ôr", t:"er"}] },
        { img: "doctor.jpg", speak: "doctor", parts: [{t:"d"}, {i:"…ë", t:"o"}, {i:"k", t:"c"}, {t:"t"}, {i:"…ôr", t:"or"}] },
        { img: "burger.jpg", speak: "burger", parts: [{t:"b"}, {i:"…úÀêr", t:"ur"}, {t:"g"}, {i:"…ôr", t:"er"}] },
        { img: "sister.jpg", speak: "sister", parts: [{t:"s"}, {i:"…™", t:"i"}, {t:"s"}, {t:"t"}, {i:"…ôr", t:"er"}] },
        { img: "rubber.jpg", speak: "rubber", parts: [{t:"r"}, {i:" å", t:"u"}, {t:"bb"}, {i:"…ôr", t:"er"}] },
        { img: "lizard.jpg", speak: "lizard", parts: [{t:"l"}, {i:"…™", t:"i"}, {t:"z"}, {i:"…ôr", t:"ar"}, {t:"d"}] },
        { img: "under.jpg", speak: "under", parts: [{i:" å", t:"u"}, {t:"n"}, {t:"d"}, {i:"…ôr", t:"er"}] },
        { img: "superman.jpg", speak: "superman", parts: [{t:"s"}, {i:"u:", t:"u"}, {t:"p"}, {i:"…ôr", t:"er"}, {t:"m"}, {i:"√¶", t:"a"}, {t:"n"}] },
        { type: "game", title: "Game /…ô/", pairs: ["salad", "lemon", "chicken", "kitchen", "panda"], img: "…ô_card.jpg" },
        { type: "game", title: "Game /…úÀêr/", pairs: ["teacher", "doctor", "burger", "sister", "rubber"], img: "…úÀêr_card.jpg" }
    ],
    lesson16: [
        { img: "gear.jpg", speak: "gear", parts: [{t:"g"}, {i:"…™r", t:"ear"}] },
        { img: "deer.jpg", speak: "deer", parts: [{t:"d"}, {i:"…™r", t:"eer"}] },
        { img: "cheer.jpg", speak: "cheer", parts: [{i:"t É", t:"ch"}, {i:"…™r", t:"eer"}] },
        { img: "tear.jpg", speak: "tear", parts: [{t:"t"}, {i:"…™r", t:"ear"}] },
        { img: "ear.jpg", speak: "ear", parts: [{i:"…™r", t:"ear"}] },
        { img: "bear.jpg", speak: "bear", parts: [{t:"b"}, {i:"er", t:"ear"}] },
        { img: "pear.jpg", speak: "pear", parts: [{t:"p"}, {i:"er", t:"ear"}] },
        { img: "share.jpg", speak: "share", parts: [{i:" É", t:"sh"}, {i:"er", t:"are"}] },
        { img: "stair.jpg", speak: "stair", parts: [{t:"s"}, {t:"t"}, {i:"er", t:"air"}] },
        { img: "chair.jpg", speak: "chair", parts: [{i:"t É", t:"ch"}, {i:"er", t:"air"}] },
        { type: "sent", img: "sentence_deer.jpg", speak: "The deer is near the chair", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"d"}, {i:"…™r", t:"eer"}, {t:" "}, {i:"…™", t:"i"}, {t:"s"}, {t:" "}, {t:"n"}, {i:"…™r", t:"ear"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {i:"t É", t:"ch"}, {i:"er", t:"air."}] },
        { type: "sent", img: "sentence_bear.jpg", speak: "The bear shares the pear", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"b"}, {i:"er", t:"ear"}, {t:" "}, {i:" É", t:"sh"}, {i:"er", t:"are"}, {t:"s"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"p"}, {i:"er", t:"ear."}] },
        { type: "game", title: "Game /…™r/", pairs: ["gear", "deer", "cheer", "tear", "ear"], img: "…™r_card.jpg" },
        { type: "game", title: "Game /er/", pairs: ["bear", "pear", "share", "stair", "chair"], img: "er_card.jpg" }
    ],
    lesson17: [
        { img: "shower.jpg", speak: "shower", parts: [{i:" É", t:"sh"}, {i:"a ä", t:"ow"}, {i:"…ôr", t:"er"}] },
        { img: "shout.jpg", speak: "shout", parts: [{i:" É", t:"sh"}, {i:"a ä", t:"ou"}, {t:"t"}] },
        { img: "cow.jpg", speak: "cow", parts: [{i:"k", t:"c"}, {i:"a ä", t:"ow"}] },
        { img: "brown.jpg", speak: "brown", parts: [{t:"b"}, {t:"r"}, {i:"a ä", t:"ow"}, {t:"n"}] },
        { img: "tower.jpg", speak: "tower", parts: [{t:"t"}, {i:"a ä", t:"ow"}, {i:"…ôr", t:"er"}] },
        { img: "toe.jpg", speak: "toe", parts: [{t:"t"}, {i:"o ä", t:"oe"}] },
        { img: "boat.jpg", speak: "boat", parts: [{t:"b"}, {i:"o ä", t:"oa"}, {t:"t"}] },
        { img: "coat.jpg", speak: "coat", parts: [{i:"k", t:"c"}, {i:"o ä", t:"oa"}, {t:"t"}] },
        { img: "phone.jpg", speak: "phone", parts: [{i:"f", t:"ph"}, {i:"o ä", t:"o"}, {t:"n"}, {i:"_", t:"e"}] },
        { img: "goat.jpg", speak: "goat", parts: [{t:"g"}, {i:"o ä", t:"oa"}, {t:"t"}] },
        { type: "sent", img: "sentence_cow.jpg", speak: "The brown cow shouts at the mouse", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"b"}, {t:"r"}, {i:"a ä", t:"ow"}, {t:"n"}, {t:" "}, {i:"k", t:"c"}, {i:"a ä", t:"ow"}, {t:" "}, {i:" É", t:"sh"}, {i:"a ä", t:"ou"}, {t:"t"}, {t:"s"}, {t:" "}, {i:"√¶", t:"a"}, {t:"t"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"m"}, {i:"a ä", t:"ou"}, {t:"s"}, {i:"_", t:"e."}] },
        { type: "sent", img: "sentence_joe.jpg", speak: "Joe shows the slow goat the soap", parts: [{i:"d í", t:"J"}, {i:"o ä", t:"oe"}, {t:" "}, {i:" É", t:"sh"}, {i:"o ä", t:"ow"}, {t:"s"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"s"}, {t:"l"}, {i:"o ä", t:"ow"}, {t:" "}, {t:"g"}, {i:"o ä", t:"oa"}, {t:"t"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"s"}, {i:"o ä", t:"oa"}, {t:"p."}] },
        { type: "game", title: "Game /a ä/", pairs: ["cow", "brown", "shout", "tower", "shower"], img: "a ä_card.jpg" },
        { type: "game", title: "Game /o ä/", pairs: ["toe", "boat", "coat", "phone", "goat"], img: "o ä_card.jpg" }
    ],
    lesson18: [
        { img: "face.jpg", speak: "face", parts: [{t:"f"}, {i:"e…™", t:"a"}, {i:"s", t:"c"}, {i:"_", t:"e"}] },
        { img: "cake.jpg", speak: "cake", parts: [{i:"k", t:"c"}, {i:"e…™", t:"a"}, {t:"k"}, {i:"_", t:"e"}] },
        { img: "cave.jpg", speak: "cave", parts: [{i:"k", t:"c"}, {i:"e…™", t:"a"}, {t:"v"}, {i:"_", t:"e"}] },
        { img: "baby.jpg", speak: "baby", parts: [{t:"b"}, {i:"e…™", t:"a"}, {t:"b"}, {i:"i", t:"y"}] },
        { img: "baker.jpg", speak: "baker", parts: [{t:"b"}, {i:"e…™", t:"a"}, {t:"k"}, {i:"…ôr", t:"er"}] },
        { img: "kite.jpg", speak: "kite", parts: [{t:"k"}, {i:"a…™", t:"i"}, {t:"t"}, {i:"_", t:"e"}] },
        { img: "bike.jpg", speak: "bike", parts: [{t:"b"}, {i:"a…™", t:"i"}, {t:"k"}, {i:"_", t:"e"}] },
        { img: "tie.jpg", speak: "tie", parts: [{t:"t"}, {i:"a…™", t:"ie"}] },
        { img: "pine.jpg", speak: "pine", parts: [{t:"p"}, {i:"a…™", t:"i"}, {t:"n"}, {i:"_", t:"e"}] },
        { img: "cry.jpg", speak: "cry", parts: [{i:"k", t:"c"}, {t:"r"}, {i:"a…™", t:"y"}] },
        { type: "sent", img: "sentence_vase.jpg", speak: "Kate paints a vase", parts: [{t:"K"}, {i:"e…™", t:"a"}, {t:"t"}, {i:"_", t:"e"}, {t:" "}, {t:"p"}, {i:"e…™", t:"ai"}, {t:"n"}, {t:"t"}, {t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"v"}, {i:"e…™", t:"a"}, {t:"s"}, {i:"_", t:"e."}] },
        { type: "sent", img: "sentence_tiger.jpg", speak: "A tiger bites a kite", parts: [{i:"…ô", t:"A"}, {t:" "}, {t:"t"}, {i:"a…™", t:"i"}, {t:"g"}, {i:"…ôr", t:"er"}, {t:" "}, {t:"b"}, {i:"a…™", t:"i"}, {t:"t"}, {i:"_", t:"e"}, {t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"k"}, {i:"a…™", t:"i"}, {t:"t"}, {i:"_", t:"e."}] },
        { type: "game", title: "Game /e…™/", gameType: "mole", phoneme: "e…™", img: "e…™_card.jpg" },
        { type: "game", title: "Game /a…™/", gameType: "mole", phoneme: "a…™", img: "a…™_card.jpg" }
    ],
    lesson19: [
        { img: "coin.jpg", speak: "coin", parts: [{i:"k", t:"c"}, {i:"…î…™", t:"oin"}] },
        { img: "point.jpg", speak: "point", parts: [{t:"p"}, {i:"…î…™", t:"oi"}, {t:"n"}, {t:"t"}] },
        { img: "joy.jpg", speak: "joy", parts: [{i:"d í", t:"j"}, {i:"…î…™", t:"oy"}] },
        { img: "boy.jpg", speak: "boy", parts: [{t:"b"}, {i:"…î…™", t:"oy"}] },
        { img: "toy.jpg", speak: "toy", parts: [{t:"t"}, {i:"…î…™", t:"oy"}] },
        { img: "otter.jpg", speak: "otter", parts: [{i:"…ë", t:"o"}, {i:"tÃ¨", t:"tt"}, {i:"…ôr", t:"er"}] },
        { img: "butter.jpg", speak: "butter", parts: [{t:"b"}, {i:" å", t:"u"}, {i:"tÃ¨", t:"tt"}, {i:"…ôr", t:"er"}] },
        { img: "kitty.jpg", speak: "kitty", parts: [{t:"k"}, {i:"…™", t:"i"}, {i:"tÃ¨", t:"tt"}, {i:"i", t:"y"}] },
        { img: "party.jpg", speak: "party", parts: [{t:"p"}, {i:"…ë:r", t:"ar"}, {i:"tÃ¨", t:"t"}, {i:"i", t:"y"}] },
        { img: "city.jpg", speak: "city", parts: [{i:"s", t:"c"}, {i:"…™", t:"i"}, {i:"tÃ¨", t:"t"}, {i:"i", t:"y"}] },
        { type: "sent", img: "sentence_boy.jpg", speak: "A boy drops a coin and a toy", parts: [{i:"…ô", t:"A"}, {t:" "}, {t:"b"}, {i:"…î…™", t:"oy"}, {t:" "}, {t:"d"}, {t:"r"}, {i:"…ë", t:"o"}, {t:"p"}, {t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"k", t:"c"}, {i:"…î…™", t:"oi"}, {t:"n"}, {t:" "}, {i:"√¶", t:"a"}, {t:"n"}, {t:"d"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"t"}, {i:"…î…™", t:"oy."}] },
        { type: "sent", img: "sentence_peter.jpg", speak: "Peter got butter in the party", parts: [{t:"P"}, {i:"i:", t:"e"}, {i:"tÃ¨", t:"t"}, {i:"…ôr", t:"er"}, {t:" "}, {t:"g"}, {i:"…ë", t:"o"}, {t:"t"}, {t:" "}, {t:"b"}, {i:" å", t:"u"}, {i:"tÃ¨", t:"tt"}, {i:"…ôr", t:"er"}, {t:" "}, {i:"…™", t:"i"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"p"}, {i:"…ë:r", t:"ar"}, {i:"tÃ¨", t:"t"}, {i:"i", t:"y."}] },
        { type: "game", title: "Game /…î…™/", gameType: "snake", phoneme: "…î…™", img: "…î…™_card.jpg" },
        { type: "game", title: "Game /tÃ¨/", gameType: "snake", phoneme: "tÃ¨", img: "tÃ¨_card.jpg" }
    ],
    lesson20: [
        { img: "mat.jpg", speak: "mat", parts: [{t:"m"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "game.jpg", speak: "game", parts: [{t:"g"}, {i:"e…™", t:"a"}, {t:"m"}, {i:"_", t:"e"}] },
        { img: "mad.jpg", speak: "mad", parts: [{t:"m"}, {i:"√¶", t:"a"}, {t:"d"}] },
        { img: "time.jpg", speak: "time", parts: [{t:"t"}, {i:"a…™", t:"i"}, {t:"m"}, {i:"_", t:"e"}] },
        { img: "mouse.jpg", speak: "mouse", parts: [{t:"m"}, {i:"a ä", t:"ou"}, {t:"s"}, {i:"_", t:"e"}] },
        { img: "net.jpg", speak: "net", parts: [{t:"n"}, {i:"e", t:"e"}, {t:"t"}] },
        { img: "sun.jpg", speak: "sun", parts: [{t:"s"}, {i:" å", t:"u"}, {t:"n"}] },
        { img: "note.jpg", speak: "note", parts: [{t:"n"}, {i:"o ä", t:"o"}, {t:"t"}, {i:"_", t:"e"}] },
        { img: "nine.jpg", speak: "nine", parts: [{t:"n"}, {i:"a…™", t:"i"}, {t:"n"}, {i:"_", t:"e"}] },
        { img: "fun.jpg", speak: "fun", parts: [{t:"f"}, {i:" å", t:"u"}, {t:"n"}] },
        { type: "sent", img: "sentence_mom.jpg", speak: "Mom is sick. Mika makes milk for mom", parts: [{t:"M"}, {i:"…ë", t:"o"}, {t:"m"}, {t:" "}, {i:"…™", t:"i"}, {t:"s"}, {t:" "}, {t:"s"}, {i:"…™", t:"i"}, {i:"k", t:"ck."}, {t:" "}, {t:"M"}, {i:"i:", t:"i"}, {t:"k"}, {i:"…ô", t:"a"}, {t:" "}, {t:"m"}, {i:"e…™", t:"a"}, {t:"k"}, {i:"_", t:"e"}, {t:"s"}, {t:" "}, {t:"m"}, {i:"…™", t:"i"}, {t:"l"}, {t:"k"}, {t:" "}, {t:"f"}, {i:"…î:r", t:"or"}, {t:" "}, {t:"m"}, {i:"…ë", t:"o"}, {t:"m."}] },
        { type: "sent", img: "sentence_nina.jpg", speak: "Nina can run fast and she never gives up", parts: [{t:"N"}, {i:"i:", t:"i"}, {t:"n"}, {i:"…ô", t:"a"}, {t:" "}, {i:"k", t:"c"}, {i:"√¶", t:"a"}, {t:"n"}, {t:" "}, {t:"r"}, {i:" å", t:"u"}, {t:"n"}, {t:" "}, {t:"f"}, {i:"√¶", t:"a"}, {t:"s"}, {t:"t"}, {t:" "}, {i:"√¶", t:"a"}, {t:"n"}, {t:"d"}, {t:" "}, {i:" É", t:"sh"}, {i:"i:", t:"e"}, {t:" "}, {t:"n"}, {i:"e", t:"e"}, {t:"v"}, {i:"…ôr", t:"er"}, {t:" "}, {t:"g"}, {i:"…™", t:"i"}, {t:"v"}, {t:"s"}, {t:" "}, {i:" å", t:"u"}, {t:"p."}] },
        { type: "game", title: "Game /m/", pairs: ["mat", "game", "mad", "time", "mouse"], img: "m_card.jpg" },
        { type: "game", title: "Game /n/", pairs: ["net", "sun", "note", "nine", "fun"], img: "n_card.jpg" }
    ],
    lesson21: [
        { img: "sing.jpg", speak: "sing", parts: [{t:"s"}, {i:"…™ ≈ã", t:"ing"}] },
        { img: "finger.jpg", speak: "finger", parts: [{t:"f"}, {i:"…™ ≈ã", t:"ing"}, {t:"g"}, {i:"…ôr", t:"er"}] },
        { img: "king.jpg", speak: "king", parts: [{t:"k"}, {i:"…™ ≈ã", t:"ing"}] },
        { img: "kingfisher.jpg", speak: "kingfisher", parts: [{t:"k"}, {i:"…™ ≈ã", t:"ing"}, {t:"f"}, {i:"…™", t:"i"}, {i:" É", t:"sh"}, {i:"…ôr", t:"er"}] },
        { img: "monkey.jpg", speak: "monkey", parts: [{t:"m"}, {i:" å ≈ã", t:"on"}, {t:"k"}, {i:"i", t:"ey"}] },
        { img: "hat.jpg", speak: "hat", parts: [{t:"h"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "hen.jpg", speak: "hen", parts: [{t:"h"}, {i:"e", t:"e"}, {t:"n"}] },
        { img: "hippo.jpg", speak: "hippo", parts: [{t:"h"}, {i:"…™", t:"i"}, {t:"pp"}, {i:"o ä", t:"o"}] },
        { img: "heart.jpg", speak: "heart", parts: [{t:"h"}, {i:"…ë:r", t:"ear"}, {t:"t"}] },
        { img: "horse.jpg", speak: "horse", parts: [{t:"h"}, {i:"…î:r", t:"or"}, {t:"s"}, {i:"_", t:"e"}] },
        { type: "sent", img: "sentence_monkey.jpg", speak: "The monkey is making an amazing gift for the flamingo", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"m"}, {i:" å ≈ã", t:"on"}, {t:"k"}, {i:"i", t:"ey"}, {t:" "}, {i:"…™", t:"i"}, {t:"s"}, {t:" "}, {t:"m"}, {i:"e…™", t:"a"}, {t:"k"}, {i:"…™ ≈ã", t:"ing"}, {t:" "}, {i:"…ô", t:"a"}, {t:"n"}, {t:" "}, {i:"…ô", t:"a"}, {t:"m"}, {i:"e…™", t:"a"}, {t:"z"}, {i:"…™ ≈ã", t:"ing"}, {t:" "}, {t:"g"}, {i:"…™", t:"i"}, {t:"f"}, {t:"t"}, {t:" "}, {t:"f"}, {i:"…î:r", t:"or"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"f"}, {t:"l"}, {i:"…ô", t:"a"}, {t:"m"}, {i:"…™ ≈ã", t:"ing"}, {t:"g"}, {i:"o ä", t:"o."}] },
        { type: "sent", img: "sentence_he.jpg", speak: "He hopes his sister is happy", parts: [{t:"H"}, {i:"i:", t:"e"}, {t:" "}, {t:"h"}, {i:"o ä", t:"o"}, {t:"p"}, {t:"s"}, {t:" "}, {t:"h"}, {i:"…™", t:"i"}, {t:"s"}, {t:" "}, {t:"s"}, {i:"…™", t:"i"}, {t:"s"}, {t:"t"}, {i:"…ôr", t:"er"}, {t:" "}, {i:"…™", t:"i"}, {t:"s"}, {t:" "}, {t:"h"}, {i:"√¶", t:"a"}, {t:"pp"}, {i:"i", t:"y."}] },
        { type: "game", title: "Game /≈ã/", pairs: ["sing", "finger", "king", "kingfisher", "monkey"], img: "≈ã_card.jpg" },
        { type: "game", title: "Game /h/", pairs: ["hat", "hen", "hippo", "heart", "horse"], img: "h_card.jpg" }
    ],
    lesson22: [
        { img: "red.jpg", speak: "red", parts: [{t:"r"}, {i:"e", t:"e"}, {t:"d"}] },
        { img: "run.jpg", speak: "run", parts: [{t:"r"}, {i:" å", t:"u"}, {t:"n"}] },
        { img: "carrot.jpg", speak: "carrot", parts: [{i:"k", t:"c"}, {i:"√¶", t:"a"}, {t:"rr"}, {i:"…ô", t:"o"}, {t:"t"}] },
        { img: "ring.jpg", speak: "ring", parts: [{t:"r"}, {i:"…™ ≈ã", t:"ing"}] },
        { img: "rabbit.jpg", speak: "rabbit", parts: [{t:"r"}, {i:"√¶", t:"a"}, {t:"bb"}, {i:"…™", t:"i"}, {t:"t"}] },
        { img: "lion.jpg", speak: "lion", parts: [{t:"l"}, {i:"a…™", t:"i"}, {i:"…ô", t:"o"}, {t:"n"}] },
        { img: "ladder.jpg", speak: "ladder", parts: [{t:"l"}, {i:"√¶", t:"a"}, {t:"dd"}, {i:"…ôr", t:"er"}] },
        { img: "ball.jpg", speak: "ball", parts: [{t:"b"}, {i:"…ëÀê", t:"a"}, {t:"ll"}] },
        { img: "lips.jpg", speak: "lips", parts: [{t:"l"}, {i:"…™", t:"i"}, {t:"p"}, {t:"s"}] },
        { img: "lamp.jpg", speak: "lamp", parts: [{t:"l"}, {i:"√¶", t:"a"}, {t:"m"}, {t:"p"}] },
        { type: "sent", img: "sentence_rick.jpg", speak: "Rick is ready to read a good story for Sarah", parts: [{t:"R"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}, {t:" "}, {i:"…™", t:"i"}, {t:"s"}, {t:" "}, {t:"r"}, {i:"e", t:"ea"}, {t:"d"}, {i:"i", t:"y"}, {t:" "}, {t:"t"}, {i:"u:", t:"o"}, {t:" "}, {t:"r"}, {i:"i:", t:"ea"}, {t:"d"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"g"}, {i:" ä", t:"oo"}, {t:"d"}, {t:" "}, {t:"s"}, {t:"t"}, {i:"…î:r", t:"or"}, {i:"i", t:"y"}, {t:" "}, {t:"f"}, {i:"…î:r", t:"or"}, {t:" "}, {t:"S"}, {i:"√¶", t:"a"}, {t:"r"}, {i:"…ô", t:"a"}, {i:"_", t:"h."}] },
        { type: "sent", img: "sentence_lily.jpg", speak: "Lily likes to look at her Mom smiling", parts: [{t:"L"}, {i:"…™", t:"i"}, {t:"l"}, {i:"i", t:"y"}, {t:" "}, {t:"l"}, {i:"a…™", t:"i"}, {t:"k"}, {i:"_", t:"e"}, {t:"s"}, {t:" "}, {t:"t"}, {i:"u:", t:"o"}, {t:" "}, {t:"l"}, {i:" ä", t:"oo"}, {t:"k"}, {t:" "}, {i:"√¶", t:"a"}, {t:"t"}, {t:" "}, {t:"h"}, {i:"…ôr", t:"er"}, {t:" "}, {t:"M"}, {i:"…ë", t:"o"}, {t:"m"}, {t:" "}, {t:"s"}, {t:"m"}, {i:"a…™", t:"i"}, {t:"l"}, {i:"…™ ≈ã", t:"ing."}] },
        { type: "game", title: "Game /r/", pairs: ["red", "run", "carrot", "ring", "rabbit"], img: "r_card.jpg" },
        { type: "game", title: "Game /l/", pairs: ["lion", "ladder", "ball", "lips", "lamp"], img: "l_card.jpg" }
    ],
    lesson23: [
        { img: "yellow.jpg", speak: "yellow", parts: [{i:"j", t:"y"}, {i:"e", t:"e"}, {t:"ll"}, {i:"o ä", t:"ow"}] },
        { img: "yoyo.jpg", speak: "yoyo", parts: [{i:"j", t:"y"}, {i:"o ä", t:"o"}, {i:"j", t:"y"}, {i:"o ä", t:"o"}] },
        { img: "yogurt.jpg", speak: "yogurt", parts: [{i:"j", t:"y"}, {i:"o ä", t:"o"}, {t:"g"}, {i:"…ôr", t:"ur"}, {t:"t"}] },
        { img: "yam.jpg", speak: "yam", parts: [{i:"j", t:"y"}, {i:"√¶", t:"a"}, {t:"m"}] },
        { img: "yak.jpg", speak: "yak", parts: [{i:"j", t:"y"}, {i:"√¶", t:"a"}, {t:"k"}] },
        { img: "web.jpg", speak: "web", parts: [{t:"w"}, {i:"e", t:"e"}, {t:"b"}] },
        { img: "wolf.jpg", speak: "wolf", parts: [{t:"w"}, {i:" ä", t:"o"}, {t:"l"}, {t:"f"}] },
        { img: "walk.jpg", speak: "walk", parts: [{t:"w"}, {i:"…ëÀê", t:"a"}, {i:"_", t:"l"}, {t:"k"}] },
        { img: "winter.jpg", speak: "winter", parts: [{t:"w"}, {i:"…™", t:"i"}, {t:"n"}, {t:"t"}, {i:"…ôr", t:"er"}] },
        { img: "water.jpg", speak: "water", parts: [{t:"w"}, {i:"…ëÀê", t:"a"}, {i:"tÃ¨", t:"t"}, {i:"…ôr", t:"er"}] },
        { type: "sent", img: "sentence_your.jpg", speak: "Your kindness makes you a young hero", parts: [{i:"J", t:"Y"}, {i:"…î:r", t:"our"}, {t:" "}, {t:"k"}, {i:"a…™", t:"i"}, {t:"n"}, {t:"d"}, {t:"n"}, {i:"…ô", t:"e"}, {t:"ss"}, {t:" "}, {t:"m"}, {i:"e…™", t:"a"}, {t:"k"}, {i:"_", t:"e"}, {t:"s"}, {t:" "}, {i:"j", t:"y"}, {i:"u:", t:"ou"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"j", t:"y"}, {i:" å ≈ã", t:"oung"}, {t:" "}, {t:"h"}, {i:"…™", t:"e"}, {t:"r"}, {i:"o ä", t:"o."}] },
        { type: "sent", img: "sentence_we.jpg", speak: "We work well to win the race", parts: [{t:"W"}, {i:"i:", t:"e"}, {t:" "}, {t:"w"}, {i:"…úÀêr", t:"or"}, {t:"k"}, {t:" "}, {t:"w"}, {i:"e", t:"e"}, {t:"ll"}, {t:" "}, {t:"t"}, {i:"u:", t:"o"}, {t:" "}, {t:"w"}, {i:"…™", t:"i"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"r"}, {i:"e…™", t:"a"}, {i:"s", t:"c"}, {i:"_", t:"e."}] },
        { type: "game", title: "Game /j/", pairs: ["yellow", "yoyo", "yogurt", "yam", "yak"], img: "j_card.jpg" },
        { type: "game", title: "Game /w/", pairs: ["web", "wolf", "walk", "winter", "water"], img: "w_card.jpg" }
    ],
    lesson24: [
        { img: "thin.jpg", speak: "thin", parts: [{i:"Œ∏", t:"th"}, {i:"…™", t:"i"}, {t:"n"}] },
        { img: "teeth.jpg", speak: "teeth", parts: [{t:"t"}, {i:"i:", t:"ee"}, {i:"Œ∏", t:"th"}] },
        { img: "thumb.jpg", speak: "thumb", parts: [{i:"Œ∏", t:"th"}, {i:" å", t:"u"}, {t:"m"}, {i:"_", t:"b"}] },
        { img: "earth.jpg", speak: "earth", parts: [{i:"…úÀêr", t:"ear"}, {i:"Œ∏", t:"th"}] },
        { img: "birthday.jpg", speak: "birthday", parts: [{t:"b"}, {i:"…úÀêr", t:"ir"}, {i:"Œ∏", t:"th"}, {t:"d"}, {i:"e…™", t:"ay"}] },
        { img: "father.jpg", speak: "father", parts: [{t:"f"}, {i:"…ë:", t:"a"}, {i:"√∞", t:"th"}, {i:"…ôr", t:"er"}] },
        { img: "together.jpg", speak: "together", parts: [{t:"t"}, {i:"…ô", t:"o"}, {t:"g"}, {i:"e", t:"e"}, {i:"√∞", t:"th"}, {i:"…ôr", t:"er"}] },
        { img: "clothing.jpg", speak: "clothing", parts: [{i:"k", t:"c"}, {t:"l"}, {i:"o ä", t:"o"}, {i:"√∞", t:"th"}, {i:"…™ ≈ã", t:"ing"}] },
        { img: "feather.jpg", speak: "feather", parts: [{t:"f"}, {i:"e", t:"ea"}, {i:"√∞", t:"th"}, {i:"…ôr", t:"er"}] },
        { img: "weather.jpg", speak: "weather", parts: [{t:"w"}, {i:"e", t:"ea"}, {i:"√∞", t:"th"}, {i:"…ôr", t:"er"}] },
        { type: "sent", img: "sentence_think.jpg", speak: "Think good things and say thank you to have a happy heart", parts: [{i:"Œ∏", t:"Th"}, {i:"…™ ≈ã", t:"ink"}, {t:"k"}, {t:" "}, {t:"g"}, {i:" ä", t:"oo"}, {t:"d"}, {t:" "}, {i:"Œ∏", t:"th"}, {i:"…™ ≈ã", t:"ing"}, {t:"s"}, {t:" "}, {i:"√¶", t:"a"}, {t:"n"}, {t:"d"}, {t:" "}, {t:"s"}, {i:"e…™", t:"ay"}, {t:" "}, {i:"Œ∏", t:"th"}, {i:"√¶", t:"a"}, {i:"≈ã", t:"n"}, {t:"k"}, {t:" "}, {i:"j", t:"y"}, {i:"u:", t:"ou"}, {t:" "}, {t:"t"}, {i:"u:", t:"o"}, {t:" "}, {t:"h"}, {i:"√¶", t:"a"}, {t:"v"}, {i:"_", t:"e"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"h"}, {i:"√¶", t:"a"}, {t:"pp"}, {i:"i", t:"y"}, {t:" "}, {t:"h"}, {i:"…ë:r", t:"ear"}, {t:"t."}] },
        { type: "sent", img: "sentence_they.jpg", speak: "They help their mother with the dishes", parts: [{i:"√∞", t:"Th"}, {i:"e…™", t:"ey"}, {t:" "}, {t:"h"}, {i:"e", t:"e"}, {t:"l"}, {t:"p"}, {t:" "}, {i:"√∞", t:"th"}, {i:"e", t:"ei"}, {t:"r"}, {t:" "}, {t:"m"}, {i:" å", t:"o"}, {i:"√∞", t:"th"}, {i:"…ôr", t:"er"}, {t:" "}, {t:"w"}, {i:"…™", t:"i"}, {i:"√∞", t:"th"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"d"}, {i:"…™", t:"i"}, {i:" É", t:"sh"}, {i:"…™", t:"es."}] },
        { type: "game", title: "Game /Œ∏/", pairs: ["thin", "teeth", "thumb", "earth", "birthday"], img: "Œ∏_card.jpg" },
        { type: "game", title: "Game /√∞/", pairs: ["father", "together", "clothing", "feather", "weather"], img: "√∞_card.jpg" }
    ],

    getLesson: function(num) {
        if(this["lesson" + num]) return this["lesson" + num];
        return [];
    }
};
/* ==========================================================================
   PH·∫¶N 3: LOGIC ENGINES (GAME, SNAKE, AUDIO, LEARNING)
   ========================================================================== */

/* --- 3.2 AUDIO ENGINE --- */
const AudioEngine = {
    isAudioAllowed: false, audioWin: new Audio("win.mp3"), audioCorrect: new Audio("correct.mp3"), audioWrong: new Audio("wrong.mp3"), currentUtterance: null,
    unlock: function() { this.isAudioAllowed = true; if ('speechSynthesis' in window) { const u = new SpeechSynthesisUtterance(''); window.speechSynthesis.speak(u); window.speechSynthesis.cancel(); } },
    stopAllAndBlock: function() { this.isAudioAllowed = false; window.speechSynthesis.cancel(); this.audioWin.pause(); this.audioWin.currentTime = 0; this.audioCorrect.pause(); this.audioCorrect.currentTime = 0; this.audioWrong.pause(); this.audioWrong.currentTime = 0; },
    stopCurrentSound: function() { window.speechSynthesis.cancel(); },
    playTTS: function(text) { if (!this.isAudioAllowed) return; this.stopCurrentSound(); if ('speechSynthesis' in window) { window.currentUtterance = new SpeechSynthesisUtterance(text); window.currentUtterance.lang = 'en-US'; window.currentUtterance.rate = 0.9; window.speechSynthesis.speak(window.currentUtterance); } },
    playEffect: function(type) { if (!this.isAudioAllowed) return; if (type === 'correct') this.audioCorrect.play().catch(e=>{}); if (type === 'wrong') this.audioWrong.play().catch(e=>{}); if (type === 'win') this.audioWin.play().catch(e=>{}); }
};

/* --- 3.3 GAME ENGINE (WHACK-A-MOLE & FLIP) --- */
const GameEngine = {
    active: false, moleLoop: null, moleAudioLoop: null, hammerTimeout: null, timerInt: null, 
    score: 0, sec: 0, moles: [], moleRemainingWords: [], moleTarget: null,
    currentConfig: null, currentDataPool: [],
    
    WINNING_SCORE: 1000, 

    start: function(config, dataPool) {
        this.currentConfig = config; this.currentDataPool = dataPool;
        if (config.gameType === 'snake') { SnakeEngine.start(config, dataPool); return; }
        if (config.gameType === 'mole') { this.startMoleGame(); return; } 
        // M·∫∑c ƒë·ªãnh l√† FLIP
        this.startFlipGame();
    },
    restart: function() { if(this.currentConfig) this.start(this.currentConfig, this.currentDataPool); },
    stop: function() {
        this.active = false; clearInterval(this.moleAudioLoop); clearTimeout(this.moleLoop); clearInterval(this.timerInt); clearTimeout(this.hammerTimeout);
        const allMoles = document.querySelectorAll('.mole'); allMoles.forEach(m => m.classList.remove('up', 'bonked'));
        const hammer = document.getElementById('cursor-hammer'); if(hammer) hammer.classList.remove('active');
        SnakeEngine.stop();
    },
    // MOLE Logic
    startMoleGame: function() {
        this.stop(); this.active = true; this.score = 0; this.sec = 0; this.updateScore(0);
        this.moles = document.querySelectorAll('.mole');
        document.getElementById('tower').style.display = 'none'; document.getElementById('whack-wrapper').style.display = 'flex'; document.getElementById('win-modal').style.display = 'none'; document.getElementById('snake-game-container').style.display = 'none';
        this.refillMoleWords();
        if(this.moleRemainingWords.length === 0) return alert("Kh√¥ng c√≥ d·ªØ li·ªáu t·ª´ v·ª±ng!");
        this.startTimer(); this.nextMoleRound();
    },
    refillMoleWords: function() { const targetPhoneme = this.currentConfig.phoneme; this.moleRemainingWords = this.currentDataPool.filter(w => w.parts && w.parts.some(p => p.i && p.i.includes(targetPhoneme))).sort(() => 0.5 - Math.random()); },
    nextMoleRound: function() {
        if (!this.active) return;
        if (this.score >= this.WINNING_SCORE) { this.win(); return; }
        if (this.moleRemainingWords.length === 0) { this.refillMoleWords(); }
        this.moleTarget = this.moleRemainingWords.pop();
        let html = ''; this.moleTarget.parts.forEach(p => { const ipaHtml = p.i ? p.i : "&nbsp;"; html += `<div class="target-char"><div class="target-ipa">${ipaHtml}</div><div class="target-txt">${p.t}</div></div>`; });
        document.getElementById('target-word-container').innerHTML = html;
        AudioEngine.playTTS(this.moleTarget.speak); clearInterval(this.moleAudioLoop);
        this.moleAudioLoop = setInterval(() => { if(this.active) AudioEngine.playTTS(this.moleTarget.speak); }, 2000);
        this.peep();
    },
    peep: function() {
        if (!this.active) return;
        let speed = Math.max(600, 1500 - (this.score * 0.8)); const time = speed + Math.random() * 400; 
        const hole = this.moles[Math.floor(Math.random() * this.moles.length)];
        let isTarget = Math.random() < 0.4; let moleImgData = isTarget ? this.moleTarget : this.currentDataPool[Math.floor(Math.random() * this.currentDataPool.length)];
        const imgEl = hole.querySelector('img'); imgEl.src = moleImgData.img; hole.dataset.speak = moleImgData.speak;
        hole.classList.add('up');
        this.moleLoop = setTimeout(() => { hole.classList.remove('up'); if (this.active) this.peep(); }, time);
    },
    bonk: function(moleEl, event) {
        if(!moleEl.classList.contains('up') || !this.active) return;
        let touchX = event.clientX || event.pageX; let touchY = event.clientY || event.pageY; this.spawnHammer(touchX, touchY);
        const clickedWord = moleEl.dataset.speak;
        if (clickedWord === this.moleTarget.speak) { AudioEngine.playEffect('correct'); moleEl.classList.add('bonked'); this.updateScore(100); this.showFloatingText(touchX, touchY, "+100", "yellow"); setTimeout(() => { moleEl.classList.remove('up', 'bonked'); clearTimeout(this.moleLoop); this.nextMoleRound(); }, 300); }
        else { AudioEngine.playEffect('wrong'); moleEl.classList.remove('up'); this.updateScore(-50); this.showFloatingText(touchX, touchY, "-50", "red"); }
    },
    spawnHammer: function(x, y) { const hammer = document.getElementById('cursor-hammer'); hammer.style.left = (x - 60) + 'px'; hammer.style.top = (y - 70) + 'px'; hammer.classList.remove('active'); void hammer.offsetWidth; hammer.classList.add('active'); clearTimeout(this.hammerTimeout); this.hammerTimeout = setTimeout(() => { hammer.classList.remove('active'); }, 150); },
    
    // --- FLIP LOGIC (ƒê√£ s·ª≠a ƒë·ªÉ l·ªçc t·ª´ theo danh s√°ch pairs) ---
    startFlipGame: function() {
        this.stop(); this.active = true; this.sec = 0; this.matches = 0;
        document.getElementById('tower').style.display = 'flex'; document.getElementById('whack-wrapper').style.display = 'none'; document.getElementById('win-modal').style.display = 'none'; document.getElementById('snake-game-container').style.display = 'none';
        const tower = document.getElementById('tower'); tower.innerHTML = '';
        let cards = [];
        
        // L·ªåC T·ª™: Ch·ªâ l·∫•y c√°c t·ª´ c√≥ trong danh s√°ch pairs c·ªßa game hi·ªán t·∫°i
        const validWords = this.currentConfig.pairs;
        
        validWords.forEach(key => {
            // T√¨m t·ª´ trong dataPool (DataEngine) kh·ªõp v·ªõi key
            let original = this.currentDataPool.find(d => { 
                if(d.type === 'game' || d.type === 'sent') return false; 
                let fullWord = d.parts.map(p => p.t).join(""); 
                return fullWord === key; 
            });
            
            if(original) { 
                cards.push({ id: key, type: 'img', content: `<img src="${original.img}">`, speak: original.speak }); 
                let htmlText = `<div class="game-card-text">`; 
                original.parts.forEach(p => { htmlText += `<div class="gc-block"><div class="gc-ipa">${p.i || "&nbsp;"}</div><div class="gc-word">${p.t}</div></div>`; }); 
                htmlText += `</div>`; 
                cards.push({ id: key, type: 'text', content: htmlText, speak: original.speak }); 
            }
        });
        
        cards.sort(() => 0.5 - Math.random());
        let cCount = 0; let num = 1; const rows = [3, 2, 3, 2];
        rows.forEach(cnt => {
            const rowDiv = document.createElement('div'); rowDiv.className = 'tower-row';
            for(let k=0; k<cnt; k++) {
                if(cCount >= cards.length) break;
                const c = cards[cCount]; const el = document.createElement('div'); el.className = 'card-flip'; el.dataset.speak = c.speak; el.dataset.id = c.id;
                el.innerHTML = `<div class="card-inner"><div class="face front">${num}</div><div class="face back">${c.content}</div></div>`;
                el.onclick = function() { GameEngine.cardClick(this); }; rowDiv.appendChild(el); cCount++; num++;
            }
            tower.appendChild(rowDiv);
        });
        this.startTimer();
    },
    cardClick: function(el) {
        if(el.classList.contains('flipped') || el.classList.contains('matched')) return;
        el.classList.add('flipped'); AudioEngine.playTTS(el.dataset.speak);
        if(!this.c1) { this.c1 = el; } else { this.c2 = el;
            if(this.c1.dataset.id === this.c2.dataset.id) { setTimeout(() => { this.c1.classList.add('matched'); this.c2.classList.add('matched'); this.c1 = null; this.c2 = null; this.matches++; AudioEngine.playEffect('correct'); if(this.matches === 5) this.win(); }, 600); }
            else { setTimeout(() => { this.c1.classList.remove('flipped'); this.c2.classList.remove('flipped'); this.c1 = null; this.c2 = null; AudioEngine.playEffect('wrong'); }, 1000); }
        }
    },
    startTimer: function() { clearInterval(this.timerInt); document.getElementById('timer').innerText = "00:00"; this.timerInt = setInterval(() => { this.sec++; let m=Math.floor(this.sec/60).toString().padStart(2,'0'); let s=(this.sec%60).toString().padStart(2,'0'); document.getElementById('timer').innerText = `${m}:${s}`; }, 1000); },
    updateScore: function(val) { this.score += val; if(this.score < 0) this.score = 0; document.getElementById('score-display').innerText = this.score; },
    showFloatingText: function(x, y, text, color) { const el = document.createElement('div'); el.className = 'floating-text'; el.innerText = text; el.style.left = x + 'px'; el.style.top = y + 'px'; el.style.color = color; document.body.appendChild(el); setTimeout(() => el.remove(), 800); },
    win: function() { this.stop(); AudioEngine.playEffect('win'); AudioEngine.playTTS("Excellent job!"); document.getElementById('win-msg').innerText = "Th·ªùi gian: " + document.getElementById('timer').innerText; document.getElementById('final-score').innerText = this.score; document.getElementById('win-modal').style.display = 'flex'; }
};

const SnakeEngine = {
    active: false, paused: false, gameLoopId: null, audioLoopId: null, boardSize: 15, snake: [], direction: {x: 0, y: 0}, nextDirection: {x: 0, y: 0}, 
    foods: [], score: 0, speed: 300, targetPhoneme: "", currentTargetWord: null, poolCorrect: [], poolWrong: [],
    lives: 3,

    start: function(config, dataPool) {
        this.stop(); this.active = true; this.paused = false; this.score = 0; this.speed = 550; this.lives = 3; this.targetPhoneme = config.phoneme;
        this.poolCorrect = dataPool.filter(w => w.parts && w.parts.some(p => p.i && p.i.includes(this.targetPhoneme)));
        this.poolWrong = dataPool.filter(w => !w.parts || !w.parts.some(p => p.i && p.i.includes(this.targetPhoneme)));
        if (this.poolCorrect.length === 0) return alert("Thi·∫øu d·ªØ li·ªáu √¢m /" + this.targetPhoneme + "/");

        document.getElementById('tower').style.display = 'none'; document.getElementById('whack-wrapper').style.display = 'none'; document.getElementById('snake-game-container').style.display = 'flex'; document.getElementById('win-modal').style.display = 'none'; document.getElementById('pause-modal').style.display = 'none'; document.getElementById('snake-score').innerText = this.score;
        this.updateLivesUI();
        
        const center = Math.floor(this.boardSize / 2);
        this.snake = [{x: center, y: center}, {x: center, y: center + 1}, {x: center, y: center + 2}];
        this.direction = {x: 0, y: -1}; this.nextDirection = {x: 0, y: -1};
        this.createBoard(); this.spawnFoods(); this.gameLoop(); this.startAudioLoop();
    },
    stop: function() { this.active = false; clearTimeout(this.gameLoopId); clearInterval(this.audioLoopId); },
    togglePause: function() { if (!this.active) return; this.paused = !this.paused; const modal = document.getElementById('pause-modal'); if (this.paused) { modal.style.display = 'flex'; clearInterval(this.audioLoopId); } else { modal.style.display = 'none'; this.gameLoop(); this.startAudioLoop(); } },
    startAudioLoop: function() { clearInterval(this.audioLoopId); if(this.currentTargetWord) AudioEngine.playTTS(this.currentTargetWord.speak); this.audioLoopId = setInterval(() => { if (this.active && !this.paused && this.currentTargetWord) { AudioEngine.playTTS(this.currentTargetWord.speak); } }, 4000); },
    createBoard: function() { const board = document.getElementById('snake-board'); board.innerHTML = ''; board.style.gridTemplateColumns = `repeat(${this.boardSize}, 1fr)`; board.style.gridTemplateRows = `repeat(${this.boardSize}, 1fr)`; for(let i=0; i < this.boardSize * this.boardSize; i++) { const cell = document.createElement('div'); cell.className = 'grid-cell'; board.appendChild(cell); } },
    updateLivesUI: function() {
        let hearts = "";
        for(let i=0; i<this.lives; i++) hearts += "‚ù§Ô∏è";
        for(let i=this.lives; i<3; i++) hearts += "üñ§";
        document.getElementById('snake-lives').innerText = hearts;
    },
    handleDeath: function(msg) {
        this.lives--;
        this.updateLivesUI();
        AudioEngine.playEffect('wrong');
        
        if (this.lives <= 0) {
            this.showGameOver(msg + " H·∫øt m·∫°ng r·ªìi!");
        } else {
            const center = Math.floor(this.boardSize / 2);
            this.snake = [{x: center, y: center}, {x: center, y: center + 1}, {x: center, y: center + 2}];
            this.direction = {x: 0, y: -1}; this.nextDirection = {x: 0, y: -1};
        }
    },
    gameLoop: function() {
        if (!this.active || this.paused) return;
        this.direction = this.nextDirection;
        const head = { ...this.snake[0] }; head.x += this.direction.x; head.y += this.direction.y;
        if (this.isCollision(head)) { 
            this.handleDeath("R·∫Øn ƒë·ª•ng t∆∞·ªùng!"); 
            if(this.lives > 0) { this.draw(); this.gameLoopId = setTimeout(() => { if(this.active) this.gameLoop(); }, this.speed); return; }
            else return;
        }
        this.snake.unshift(head);
        let ate = false;
        const foodIndex = this.foods.findIndex(f => f.x === head.x && f.y === head.y);
        if (foodIndex !== -1) {
            const food = this.foods[foodIndex];
            if (food.isCorrect) {
                ate = true; this.score += 10; document.getElementById('snake-score').innerText = this.score;
                AudioEngine.playEffect('correct'); 
                if (this.speed > 150) this.speed -= 20; 
                
                this.foods.splice(foodIndex, 1); this.spawnFoods(); this.startAudioLoop();
                if (this.score >= 100) { this.win(); return; }
            } else { 
                this.handleDeath(`Sai r·ªìi! "${food.word}" kh√¥ng ph·∫£i t·ª´ c·∫ßn t√¨m!`);
                if(this.lives > 0) {
                     this.foods.splice(foodIndex, 1);
                     this.snake.pop(); 
                     this.draw();
                     this.gameLoopId = setTimeout(() => { if(this.active) this.gameLoop(); }, this.speed); 
                     return;
                } else return;
            }
        }
        if (!ate) this.snake.pop();
        this.draw();
        this.gameLoopId = setTimeout(() => { if(this.active) this.gameLoop(); }, this.speed);
    },
    isCollision: function(pos) { if (pos.x < 0 || pos.x >= this.boardSize || pos.y < 0 || pos.y >= this.boardSize) return true; for (let i = 1; i < this.snake.length; i++) if (pos.x === this.snake[i].x && pos.y === this.snake[i].y) return true; return false; },
    spawnFoods: function() {
        this.foods = [];
        const correctWord = this.poolCorrect[Math.floor(Math.random() * this.poolCorrect.length)];
        this.currentTargetWord = correctWord; 
        
        const validWrongPool = this.poolWrong.filter(w => !w.img.includes("card.jpg"));
        const wrongWords = validWrongPool.sort(() => 0.5 - Math.random()).slice(0, 2); 
        
        const itemsToSpawn = [{ ...correctWord, isCorrect: true, icon: 'üçé' }, { ...wrongWords[0], isCorrect: false, icon: 'üçÑ' }];
        if (wrongWords[1]) itemsToSpawn.push({ ...wrongWords[1], isCorrect: false, icon: 'üí£' });
        itemsToSpawn.forEach(item => {
            let pos; do { 
                pos = { x: Math.floor(Math.random() * (this.boardSize - 2)) + 1, y: Math.floor(Math.random() * (this.boardSize - 2)) + 1 }; 
                
                // --- LOGIC TR√ÅNH V√ôNG N√öT B·∫§M (SAFE ZONE) ---
                let isSafeZone = (pos.y >= 11 && pos.x >= 4 && pos.x <= 10);
                if (isSafeZone) continue; 
                
                let isTooClose = this.foods.some(f => Math.abs(f.x - pos.x) <= 1 && Math.abs(f.y - pos.y) <= 1);
                if (isTooClose) continue; 
                
            } while (this.isOccupied(pos) || this.foods.some(f => Math.abs(f.x - pos.x) <= 1 && Math.abs(f.y - pos.y) <= 1));
            
            this.foods.push({ x: pos.x, y: pos.y, img: item.img, word: item.speak, isCorrect: item.isCorrect, icon: item.icon });
        });
        
        // --- S·ª¨A ƒê·ªîI VERSION 1.1: ·∫®n phi√™n √¢m n·∫øu l√† C√ÇU ---
        let ipaHtml = "";
        // N·∫øu kh√¥ng ph·∫£i lo·∫°i 'sent' (c√¢u) V√Ä ƒë·ªô d√†i t·ª´ < 2 (t·ª©c l√† t·ª´ ƒë∆°n) th√¨ m·ªõi hi·ªán IPA
        if (correctWord.type !== 'sent' && correctWord.speak.split(' ').length < 2) {
             let ipaStr = "";
             if (correctWord.parts) { ipaStr = correctWord.parts.map(p => p.i).join("").replace(/&nbsp;/g, ""); }
             ipaHtml = `<div style="color:red; font-size:14px;">/${ipaStr}/</div>`;
        }
        
        let fontSize = (correctWord.type === 'sent') ? '18px' : '24px';
        
        document.getElementById('snake-target-content').innerHTML = 
            `${ipaHtml}<div style="color:#d35400; font-size:${fontSize}; font-weight:900;">${correctWord.speak}</div>`;
    },
    isOccupied: function(pos) { if (this.snake.some(s => s.x === pos.x && s.y === pos.y)) return true; if (this.foods.some(f => f.x === pos.x && f.y === pos.y)) return true; const head = this.snake[0]; if (Math.abs(pos.x - head.x) < 3 && Math.abs(pos.y - head.y) < 3) return true; return false; },
    draw: function() {
        const cells = document.querySelectorAll('.grid-cell'); cells.forEach(c => { c.className = 'grid-cell'; c.innerHTML = ''; });
        this.foods.forEach(f => {
            const idx = f.y * this.boardSize + f.x;
            if (cells[idx]) { 
                const zIndex = 10; 
                cells[idx].innerHTML = `<div class="food-item" style="z-index:${zIndex}"><img class="food-img" src="${f.img}" onerror="this.style.display='none'"><div class="food-core">${f.icon}</div></div>`; 
            }
        });
        this.snake.forEach((part, index) => {
            const idx = part.y * this.boardSize + part.x;
            if (cells[idx]) {
                const div = document.createElement('div'); div.classList.add('snake-part');
                if (index === 0) {
                    div.classList.add('snake-head');
                    if (this.direction.y === -1) div.classList.add('head-down'); else if (this.direction.y === 1) div.classList.add('head-up'); else if (this.direction.x === -1) div.classList.add('head-left'); else if (this.direction.x === 1) div.classList.add('head-right');
                }
                cells[idx].appendChild(div);
            }
        });
    },
    changeDirection: function(newDirName) {
        if (this.paused) return; 
        let newDir = {x:0, y:0};
        if (newDirName === 'up') newDir = {x: 0, y: -1}; if (newDirName === 'down') newDir = {x: 0, y: 1};
        if (newDirName === 'left') newDir = {x: -1, y: 0}; if (newDirName === 'right') newDir = {x: 1, y: 0};
        if (this.direction.x + newDir.x === 0 && this.direction.y + newDir.y === 0) return;
        this.nextDirection = newDir;
    },
    showGameOver: function(msg) { this.stop(); AudioEngine.playTTS("Game Over!"); document.getElementById('win-msg').innerText = msg; document.getElementById('final-score').innerText = this.score; document.getElementById('win-modal').style.display = 'flex'; },
    win: function() { this.stop(); AudioEngine.playEffect('win'); AudioEngine.playTTS("You Win!"); document.getElementById('win-msg').innerText = "Tuy·ªát v·ªùi!"; document.getElementById('final-score').innerText = this.score; document.getElementById('win-modal').style.display = 'flex'; }
};

const LearningEngine = {
    currentData: [], idx: 0,
    initLesson: function(lessonNum) { this.currentData = DataEngine.getLesson(lessonNum); this.idx = 0; this.preload(); },
    preload: function() { this.currentData.forEach(item => { if(item.img) new Image().src = item.img; }); },
    render: function() {
        const item = this.currentData[this.idx]; if(!item) return; AudioEngine.stopCurrentSound();
        document.getElementById('game-screen').style.display = 'none'; document.getElementById('learning-screen').style.display = 'flex'; document.getElementById('win-modal').style.display = 'none'; document.getElementById('stars').innerText = "‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ"; document.getElementById('stars').classList.remove('active'); document.getElementById('feedback').innerText = "...";
        const imgEl = document.getElementById('learn-img'); const btnContainer = document.getElementById('action-container'); const infoDisplay = document.getElementById('info-display');
        if(item.type === 'game') {
            imgEl.src = item.img || 'https://img.icons8.com/color/500/controller.png';
            let titleColor = item.title.includes("GAME 1") ? "#e67e22" : (item.title.includes("GAME 2") ? "#9b59b6" : "#333");
            infoDisplay.innerHTML = `<h2 class="word-display" style="font-size:28px; color:${titleColor}; font-weight:900;">${item.title}</h2>`;
            btnContainer.innerHTML = `<button class="btn-action btn-game-entry" onclick="App.enterGame()">  üöÄ   Ch∆°i Ngay</button>`;
        } else {
            imgEl.src = item.img; btnContainer.innerHTML = ` <button class="btn-action btn-mic" id="mic-btn" onclick="LearningEngine.startListening()">  üé§   ƒê·ªçc Ngay</button> <button class="btn-action btn-listen" id="btn-replay" onclick="LearningEngine.onUserClickSpeak()">  üîä   Nghe L·∫°i</button> `;
            let html = ''; item.parts.forEach((p) => { if (p.t === " ") html += `<div class="spacer"></div>`; else { const ipaHtml = p.i ? p.i : "&nbsp;"; const textClass = (item.type === 'sent') ? 'sent-text' : 'cb-text'; const ipaClass = (item.type === 'sent') ? 'sent-ipa' : 'cb-ipa'; html += `<div class="char-block"><div class="${ipaClass}">${ipaHtml}</div><div class="${textClass}">${p.t}</div></div>`; } }); infoDisplay.innerHTML = html;
        }
    },
    nav: function(d) { if(this.idx + d >= 0 && this.idx + d < this.currentData.length) { this.idx += d; this.render(); } }, nextItem: function() { this.nav(1); },
    onUserClickSpeak: function() { const item = this.currentData[this.idx]; if(item && item.type !== 'game') { let text = item.speak || item.parts.map(p => p.t).join(""); if(item.pre) text = item.pre + ". " + text; AudioEngine.playTTS(text); } },
    startListening: function() { const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition; if (!SpeechRecognition) return alert("Thi·∫øt b·ªã kh√¥ng h·ªó tr·ª£ thu √¢m"); const btn = document.getElementById('mic-btn'); btn.disabled = true; btn.innerText = "  üëÇ   ƒêang nghe..."; btn.style.backgroundColor = "#e74c3c"; const recognition = new SpeechRecognition(); recognition.lang = 'en-US'; recognition.start(); recognition.onresult = (e) => { let heard = []; for(let i=0; i<e.results[0].length; i++) heard.push(e.results[0][i].transcript.toLowerCase()); this.checkResult(heard); }; recognition.onerror = () => { this.resetMic(); }; recognition.onend = () => { if(btn.disabled) this.resetMic(); }; },
    resetMic: function() { const btn = document.getElementById('mic-btn'); if(btn) { btn.disabled = false; btn.innerText = "  üé§   ƒê·ªçc Ngay"; btn.style.backgroundColor = "#27ae60"; } },
    checkResult: function(heardArray) { const item = this.currentData[this.idx]; const targetRaw = item.speak.toLowerCase().replace(/[.,!?]/g, "").trim(); let validAnswers = [targetRaw]; if (item.pre) validAnswers.push((item.pre + " " + targetRaw).toLowerCase()); let maxScore = 0; for (let text of heardArray) { let userText = text.trim(); for (let target of validAnswers) { if (userText.includes(target) || target.includes(userText)) maxScore = 100; } } let finalStars = 2; let msg = "Try again!"; if (maxScore >= 90) { finalStars = 5; msg = "Excellent!  üéâ "; AudioEngine.playEffect('win'); } else { AudioEngine.playEffect('wrong'); } let s = ""; for(let i=0; i<5; i++) s += (i < finalStars) ? "  ‚≠ê  " : "‚òÜ"; document.getElementById('stars').innerText = s; document.getElementById('stars').className = (finalStars === 5) ? "stars active" : "stars"; document.getElementById('feedback').innerText = msg; this.resetMic(); }
};

const App = {
    // T·ª± ƒë·ªông t·∫°o menu d·ª±a tr√™n d·ªØ li·ªáu hi·ªán c√≥
    initMenu: function() {
        const menuContainer = document.getElementById('menu-screen');
        // Gi·ªØ l·∫°i ti√™u ƒë·ªÅ
        menuContainer.innerHTML = '<div class="menu-title"> üìö  CH·ªåN B√ÄI H·ªåC</div>';
        
        // T·∫°o n√∫t t·ª´ LevelMap
        LevelMap.forEach(level => {
            if (level.type === 'learn') { // Ch·ªâ t·∫°o n√∫t cho b√†i h·ªçc, kh√¥ng t·∫°o n√∫t game l·∫ª
                const btn = document.createElement('button');
                btn.className = 'btn-menu';
                btn.innerText = level.label;
                // T√¥ m√†u kh√°c cho b√†i √¥n t·∫≠p
                if (level.label.includes("√în t·∫≠p")) {
                    btn.style.borderColor = "#ff9600";
                    btn.style.color = "#d35400";
                }
                btn.onclick = function() { App.startLesson(level.id); };
                menuContainer.appendChild(btn);
            }
        });
    },

    startLesson: function(num) { AudioEngine.unlock(); document.getElementById('menu-screen').style.display = 'none'; document.getElementById('main-container').style.display = 'block'; LearningEngine.initLesson(num); LearningEngine.render(); },
    enterGame: function() { document.getElementById('learning-screen').style.display = 'none'; document.getElementById('game-screen').style.display = 'flex'; const item = LearningEngine.currentData[LearningEngine.idx]; 
    let vocabList = [];
    // Qu√©t t√¨m b√†i h·ªçc ch·ª©a item hi·ªán t·∫°i
    for(let i=1;
