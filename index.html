Version 1.15
<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>B√© H·ªçc Ti·∫øng Anh (v1.15)</title>
<style>
/* --- CSS C∆† B·∫¢N --- */
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #87CEEB; margin: 0; padding: 0; height: 100vh; width: 100vw;
overflow: hidden; display: flex; flex-direction: column; user-select: none; }

/* --- MENU --- */
#menu-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 9999; display: flex; flex-direction: column;
align-items: center; justify-content: flex-start; gap: 10px; overflow-y: auto; padding: 20px 0; }
.menu-title { font-size: 32px; color: #ff6f00; font-weight: bold; margin-bottom: 20px; flex-shrink: 0;}
.btn-menu { background: white; border: 3px solid #00A4EF; color: #00A4EF; padding: 15px 30px; border-radius: 50px; font-size: 18px; font-weight: bold;
box-shadow: 0 5px #ccebfd; cursor: pointer; width: 90%; max-width: 400px; transition: transform 0.1s; margin-bottom: 5px; flex-shrink: 0; }
.btn-menu:active { transform: scale(0.95); background: #f0f8ff; }

/* --- IPA SCREEN --- */
#ipa-screen { 
    position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
    background: #f0f8ff; z-index: 50; display: none; flex-direction: column;
    overflow-y: auto; padding: 10px; padding-bottom: 80px; 
}
.ipa-header { text-align: center; margin-bottom: 15px; }
.ipa-h1 { font-size: 28px; color: #333; font-weight: 900; margin: 0; }
.ipa-sec-title { padding: 8px; border-radius: 8px; color: white; font-weight: bold; font-size: 18px; text-align: center; margin-bottom: 10px; text-transform: uppercase; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
.bg-blue { background-color: #008CBA; } 
.bg-green { background-color: #4CAF50; }
.ipa-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
.ipa-item { background: white; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.15); overflow: hidden; cursor: pointer; border: 2px solid transparent; transition: transform 0.1s; aspect-ratio: 1/1; display: flex; align-items: center; justify-content: center; }
.ipa-item:active { transform: scale(0.95); border-color: #ff9600; }
.ipa-item img { width: 100%; height: 100%; object-fit: contain; }
.btn-back-ipa { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #ff6f00; color: white; border: none; padding: 10px 40px; border-radius: 30px; font-size: 20px; font-weight: bold; box-shadow: 0 4px #d35400; cursor: pointer; z-index: 100; }

/* --- MAIN CONTAINER --- */
#main-container { width: 100%; height: 100%; position: relative; }
#learning-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column;
padding: 5px 10px 90px 10px; background: #fff; z-index: 10; }

/* UI H·ªçc T·∫≠p */
.top-bar { height: 50px; display: flex; align-items: center; justify-content: space-between; padding: 0 5px; flex-shrink: 0; }
.btn-home { background: #eee; border: none; width: 40px; height: 40px; border-radius: 50%; font-size: 20px; cursor: pointer; }
.header-title { color: #ff6f00; font-size: 20px; font-weight: bold; }
.learn-img-wrapper { flex: 1; width: 100%; min-height: 0; display: flex; align-items: center; justify-content: center; margin: 5px 0; }
#learn-img { max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 15px; }

/* INFO AREA */
.info-area { min-height: 110px; flex-shrink: 0; display: flex; flex-direction: row; flex-wrap: wrap; align-items: center; justify-content: center; gap: 2px; align-content: center; padding: 0 5px; }
.word-group { display: inline-flex; flex-direction: row; align-items: flex-end; margin-right: 12px; white-space: nowrap; }
.char-block { display: inline-flex; flex-direction: column; align-items: center; justify-content: flex-end; margin: 0 1px; }
.cb-ipa { font-size: 20px; color: red; font-weight: bold; font-family: sans-serif; height: 26px; line-height: 26px; }
.cb-text { font-size: 36px; color: #333; font-weight: bold; height: 45px; line-height: 45px; }
.sent-ipa { font-size: 14px; color: red; font-weight: bold; height: 18px; margin-bottom: 2px;}
.sent-text { font-size: 22px; color: #333; font-weight: bold; height: 28px; }

.stars { height: 30px; text-align: center; font-size: 32px; color: #e0e0e0; flex-shrink: 0; }
.stars.active { color: #FFD700; text-shadow: 0 0 5px orange; }
.feedback-text { height: 20px; text-align: center; font-size: 16px; color: #555; font-style: italic; margin-bottom: 5px; }

/* ACTION BUTTONS */
.action-row { height: 60px; flex-shrink: 0; display: flex; justify-content: center; gap: 15px; align-items: center; margin-bottom: 10px; }
.btn-action { flex: 1; height: 55px; border-radius: 30px; border: none; font-size: 20px; font-weight: bold; cursor: pointer; color: white; display: flex; align-items: center; justify-content: center; gap: 8px; box-shadow: 0 4px rgba(0,0,0,0.2); max-width: 45%; }
.btn-mic { background: #27ae60; }
.btn-listen { background: #2980b9; }
.btn-check { background: #e67e22; } /* N√∫t Ki·ªÉm tra cho b√†i thi */
.btn-next { background: #8e44ad; } /* N√∫t Next cho b√†i thi */
.btn-game-entry { background: #9b59b6; width: 80%; max-width: none; animation: pulse 1.5s infinite; }
@keyframes pulse { 0% {transform: scale(1);} 50% {transform: scale(1.05);} 100% {transform: scale(1);} }
.nav-row { height: 60px; flex-shrink: 0; display: flex; justify-content: space-between; align-items: center; padding: 0 15px; margin-bottom: 15px; }
.btn-nav { width: 60px; height: 60px; border-radius: 50%; background: #f39c12; color: white; border: none; font-size: 30px; font-weight: bold; cursor: pointer; box-shadow: 0 4px #d35400; }
.btn-nav:active { transform: translateY(2px); box-shadow: none; }

/* UI Game Chung (Gi·ªØ nguy√™n) */
#game-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #fff3e0; z-index: 20; flex-direction: column; }
.game-header { height: 60px; display: flex; justify-content: center; align-items: center; position: relative; background: rgba(255,255,255,0.9); border-bottom: 1px solid #ddd; flex-shrink: 0; z-index: 200; }
.timer-badge { background: white; border: 3px solid #d35400; color: #d35400; padding: 5px 25px; border-radius: 25px; font-size: 24px; font-weight: bold; }
.btn-close { position: absolute; right: 10px; background: #c0392b; color: white; width: 45px; height: 45px; border-radius: 50%; border: none; font-weight: bold; font-size: 20px; }
.game-footer { height: 100px; display: flex; justify-content: center; align-items: center; background: white; border-top: 1px solid #ccc; padding-bottom: 30px; flex-shrink: 0; z-index: 200;}
#win-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.98); z-index: 300; flex-direction: column; align-items: center; justify-content: center; }

/* CSS Game Components (Flip, Mole, Snake...) gi·ªØ nguy√™n */
.tower-container { flex: 1; width: 100%; display: flex; flex-direction: column; justify-content: center; padding: 10px 0; }
.tower-row { flex: 1; width: 100%; display: flex; justify-content: center; align-items: center; gap: 10px; margin-bottom: 5px; }
.card-flip { height: 95%; aspect-ratio: 0.75; position: relative; perspective: 1000px; }
.card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.4s; transform-style: preserve-3d; border-radius: 12px; box-shadow: 0 3px 6px rgba(0,0,0,0.3); }
.card-flip.flipped .card-inner { transform: rotateY(180deg); }
.card-flip.matched .card-inner { opacity: 0; pointer-events: none; }
.face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 12px; display: flex; align-items: center; justify-content: center; border: 2px solid #5d4037; }
.front { background: #8d6e63; color: #3e2723; font-size: 6vh; font-weight: 900; }
.back { background: white; transform: rotateY(180deg); padding: 2px; }
.back img { width: 95%; height: 95%; object-fit: contain; }
.game-card-text { display: flex; flex-direction: row; flex-wrap: nowrap; align-items: center; justify-content: center; height: 100%; width: 100%; white-space: nowrap; }
.gc-block { display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 0 1px; }
.gc-ipa { color: red; font-weight: bold; font-size: 2.2vh; height: 3vh; margin-bottom: 2px; }
.gc-word { color: #333; font-weight: bold; font-size: 3vh; }
#whack-wrapper { flex: 1; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; overflow: hidden; background: linear-gradient(to bottom, #87CEEB 0%, #87CEEB 40%, #8bc34a 40%, #8bc34a 100%); position: relative; padding-bottom: 20px; }
#whack-wrapper::before { content: ' ‚òÅ Ô∏è'; font-size: 60px; position: absolute; top: 30px; left: 20px; opacity: 0.8; }
#whack-wrapper::after { content: ' ‚òÅ Ô∏è'; font-size: 50px; position: absolute; top: 60px; right: 40px; opacity: 0.8; }
.wood-sign { background: #8d6e63; background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(0,0,0,0.05) 10px, rgba(0,0,0,0.05) 20px); border: 4px solid #5d4037; color: white; padding: 5px 15px; border-radius: 10px; font-weight: bold; box-shadow: 0 5px 10px rgba(0,0,0,0.4); text-align: center; min-width: 130px; text-shadow: 1px 1px 0px rgba(0,0,0,0.5); z-index: 10; }
.hud-row { display: flex; gap: 10px; margin-bottom: 10px; margin-top: 5px; z-index: 5; justify-content: center; width: 100%; }
#target-word-container { display: flex; flex-direction: row; justify-content: center; align-items: flex-end; background: white; padding: 5px 15px; border-radius: 8px; border: 2px solid #5d4037; margin-top: 5px; min-height: 45px; }
.target-char { display: flex; flex-direction: column; align-items: center; margin: 0 1px; }
.target-ipa { color: red; font-weight: bold; font-size: 14px; height: 16px; }
.target-txt { color: #333; font-weight: bold; font-size: 24px; }
.score-text { font-size: 24px; color: #fff; font-weight: 900; }
.game-field-3d { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; width: 90%; max-width: 400px; transform: perspective(800px) rotateX(25deg); padding: 20px; background-color: #6d4c41; background-image: radial-gradient(circle, #795548 10%, transparent 10%); background-size: 20px 20px; border-radius: 20px; border: 8px solid #388e3c; box-shadow: 0 20px 0 #2e7d32, 0 25px 25px rgba(0,0,0,0.6); }
.hole { position: relative; aspect-ratio: 1; background: #2b1b13; border-radius: 50%; box-shadow: inset 0 10px 20px black; overflow: hidden; border: 2px solid #5d4037; }
.mole { position: absolute; top: 100%; left: 10%; width: 80%; height: 95%; background: #D2691E; border-radius: 45% 45% 10% 10%; transition: top 0.2s cubic-bezier(0.68, -0.55, 0.265, 1.55); display: flex; flex-direction: column; align-items: center; justify-content: flex-start; padding-top: 5px; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.4); }
.mole::before { content: ' üëÄ '; font-size: 20px; position: absolute; top: 5px; }
.mole::after { content: ' üêΩ '; font-size: 16px; position: absolute; top: 22px; }
.mole.up { top: 0%; }
.mole-card { width: 120%; height: 60%; background: white; border: 3px solid #eee; border-radius: 8px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(0,0,0,0.4); z-index: 2; position: absolute; top: 45%; left: -10%; transform: rotate(-3deg); }
.mole-card img { width: 95%; height: 95%; object-fit: contain; pointer-events: none; }
.hammer { position: fixed; width: 100px; height: 100px; pointer-events: none; z-index: 100000; background-image: url('hammer.png'); background-size: contain; background-repeat: no-repeat; transform-origin: bottom right; display: none; filter: drop-shadow(5px 5px 5px rgba(0,0,0,0.3)); }
.hammer.active { display: block; animation: hammer-hit 0.15s ease-in; }
@keyframes hammer-hit { 0% { transform: rotate(30deg); } 50% { transform: rotate(-45deg) scale(0.9); } 100% { transform: rotate(0deg); } }
.floating-text { position: fixed; font-weight: 900; font-size: 28px; pointer-events: none; z-index: 1000; animation: floatUp 0.8s ease-out forwards; text-shadow: 2px 2px 0px black, -2px -2px 0px white; }
@keyframes floatUp { 0% { opacity: 1; transform: translateY(0) scale(1); } 100% { opacity: 0; transform: translateY(-60px) scale(1.5); } }
.mole.bonked { filter: brightness(1.3) sepia(0.5) hue-rotate(-30deg) saturate(2); transition: none; transform: scale(0.95); }
#snake-game-container { flex: 1; width: 100%; display: none; flex-direction: column; align-items: center; justify-content: flex-start; background-color: #dcedc8; background-image: radial-gradient(#8bc34a 2px, transparent 2.5px); background-size: 30px 30px; position: relative; overflow: hidden; }
#snake-target-bar { width: 95%; background: rgba(255,255,255,0.95); padding: 5px 15px; border-radius: 12px; margin-top: 10px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 6px rgba(0,0,0,0.3); z-index: 200; height: 60px; flex-shrink: 0; }
.target-label { font-weight: bold; color: #555; font-size: 16px; margin-right: 5px; }
#snake-target-content { display: flex; flex-direction: column; align-items: center; justify-content: center; }
#snake-score { font-size: 22px; font-weight: bold; color: #27ae60; }
#snake-lives { font-size: 22px; font-weight: bold; color: #e74c3c; margin-right: 10px;}
.btn-pause { background: #f39c12; color: white; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 20px; font-weight: bold; cursor: pointer; box-shadow: 0 3px #d35400; }
.btn-pause:active { transform: translateY(2px); box-shadow: none; }
#snake-board { margin: 5px auto; width: 95vw; flex: 1; max-width: 450px; background-color: transparent; border: none; display: grid; position: relative; z-index: 10; }
.grid-cell { width: 100%; height: 100%; position: relative; border: none; }
.snake-part { width: 100%; height: 100%; position: absolute; top: 0; left: 0; background-image: url('snake-body.png'); background-size: contain; background-repeat: no-repeat; background-position: center; z-index: 1000 !important; }
.snake-head { position: absolute; top: 0; left: 0; background-image: url('snake-head.png'); z-index: 1001 !important; transform-origin: center center; transition: transform 0.1s linear; background-size: contain; background-repeat: no-repeat; background-position: center; }
.head-up { transform: rotate(180deg); } .head-down { transform: rotate(0deg); } .head-left { transform: rotate(90deg); } .head-right { transform: rotate(-90deg); }
.food-item { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10; pointer-events: none; }
.food-img { width: 350%; height: 350%; object-fit: contain; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.5)); z-index: 10; opacity: 1; }
.food-core { position: absolute; top: 0px; right: 0px; font-size: 10px; background: white; border-radius: 50%; padding: 1px; z-index: 11; opacity: 0.9; border: 1px solid #ccc; }
#d-pad { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); width: 180px; height: 140px; display: grid; grid-template-columns: 1fr 1fr 1fr; grid-template-rows: 1fr 1fr; gap: 10px; z-index: 200; touch-action: none; opacity: 0.6; }
.d-btn { background: rgba(255, 255, 255, 0.4); border: 2px solid white; border-radius: 15px; color: #333; font-size: 30px; display: flex; align-items: center; justify-content: center; cursor: pointer; }
.d-btn:active { background: rgba(255, 255, 255, 0.8); transform: scale(0.95); }
.d-up { grid-column: 2; grid-row: 1; } .d-left { grid-column: 1; grid-row: 2; } .d-right { grid-column: 3; grid-row: 2; } .d-down { grid-column: 2; grid-row: 2; }
#pause-modal { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 300; flex-direction: column; align-items: center; justify-content: center; }
.pause-text { color: white; font-size: 40px; font-weight: bold; margin-bottom: 20px; text-shadow: 0 2px 4px black; }
</style>
</head>
<body>
<div id="cursor-hammer" class="hammer"></div>
<div id="menu-screen"></div>
<div id="ipa-screen">
    <div class="ipa-header"><h1 class="ipa-h1">B·∫£ng Phi√™n √Çm (IPA)</h1></div>
    <div id="ipa-content"></div>
    <button class="btn-back-ipa" onclick="App.closeIPA()"> ‚óÄ  Quay l·∫°i</button>
</div>
<div id="main-container" style="display: none;">
    <div id="learning-screen">
        <div class="top-bar">
            <button class="btn-home" onclick="App.goHome()"> üè† </button>
            <div class="header-title"> üêª B√© H·ªçc Ti·∫øng Anh üê∞ </div>
            <div style="width: 40px;"></div>
        </div>
        <div class="learn-img-wrapper"><img id="learn-img" src="" alt="H√¨nh ·∫£nh"></div>
        <div class="info-area" id="info-display"></div>
        <div class="stars" id="stars">‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ</div>
        <div class="feedback-text" id="feedback">...</div>
        
        <div class="action-row" id="action-container">
            </div>
        
        <div class="nav-row">
            <button class="btn-nav" id="btn-prev" onclick="LearningEngine.nav(-1)"> ‚óÄ </button>
            <button class="btn-nav" id="btn-next" onclick="LearningEngine.nav(1)"> ‚ñ∂ </button>
        </div>
    </div>
    <div id="game-screen" style="display: none;">
        <div class="game-header">
            <div style="width:40px;"></div>
            <div class="timer-badge"> ‚è± Ô∏è <span id="timer">00:00</span></div>
            <button class="btn-close" onclick="App.exitGame()"> ‚úï </button>
        </div>
        <div id="tower" class="tower-container" style="display:none;"></div>
        <div id="whack-wrapper" style="display:none;">
            <div class="hud-row">
                <div class="wood-sign"><small>M·ª§C TI√äU:</small><br><div id="target-word-container"></div></div>
                <div class="wood-sign"><small>ƒêI·ªÇM S·ªê:</small><br><span id="score-display" class="score-text">0</span></div>
            </div>
            <div class="game-field-3d">
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
                <div class="hole"><div class="mole" onclick="GameEngine.bonk(this, event)"><div class="mole-card"><img src=""></div></div></div>
            </div>
        </div>
        <div id="snake-game-container">
            <div id="snake-target-bar">
                <button class="btn-pause" onclick="SnakeEngine.togglePause()">‚è∏</button>
                <div class="target-label">SƒÉn t·ª´:</div>
                <div id="snake-target-content"></div>
                <div><span id="snake-lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</span>üèÜ <span id="snake-score">0</span></div>
            </div>
            <div id="snake-board"></div>
            <div id="d-pad">
                <div></div><div class="d-btn d-up" onclick="SnakeEngine.changeDirection('up')">‚¨ÜÔ∏è</div><div></div>
                <div class="d-btn d-left" onclick="SnakeEngine.changeDirection('left')">‚¨ÖÔ∏è</div>
                <div class="d-btn d-down" onclick="SnakeEngine.changeDirection('down')">‚¨áÔ∏è</div>
                <div class="d-btn d-right" onclick="SnakeEngine.changeDirection('right')">‚û°Ô∏è</div>
            </div>
            <div id="pause-modal">
                <div class="pause-text">T·∫†M D·ª™NG</div>
                <button class="btn-menu" style="width:auto;" onclick="SnakeEngine.togglePause()">‚ñ∂ Ti·∫øp t·ª•c ch∆°i</button>
            </div>
        </div>
        <div class="game-footer">
            <button class="btn-action btn-nav" style="width: 60%; border-radius: 30px; font-size: 20px; box-shadow: 0 4px #e67e22; background-color: #e67e22;" onclick="GameEngine.restart()"> ‚Üª Ch∆°i l·∫°i</button>
        </div>
        <div id="win-modal">
            <h1 style="color:green; font-size:36px; margin-bottom: 10px;">HO√ÄN TH√ÄNH! üéâ </h1>
            <h2 style="color:#d35400; font-size:40px; margin: 5px 0;">T·ªïng ƒëi·ªÉm: <span id="final-score">0</span></h2>
            <p id="win-msg" style="font-size:20px; color:#555; margin-bottom: 30px;">Th·ªùi gian: 00:00</p>
            <button class="btn-action btn-nav" style="width:auto; padding: 0 40px;" onclick="GameEngine.restart()">Ch∆°i l·∫°i</button>
            <br><br>
            <button class="btn-action btn-listen" style="width:auto; padding: 0 40px;" onclick="LearningEngine.nextItem()">B√†i Ti·∫øp ‚û° </button>
        </div>
    </div>
</div>
<script>
const LevelMap = [
    // ... Copy t·ª´ 1-25 gi·ªØ nguy√™n ...
    { id: 1, type: 'learn', label: 'B√†i 1: /t/ & /d/', color: '#58cc02' },
    { id: 1, type: 'game',  label: 'Game /t/', color: '#ff9600', gameIndex: 0 },
    { id: 1, type: 'game',  label: 'Game /d/', color: '#a322ea', gameIndex: 1 },
    { id: 2, type: 'learn', label: 'B√†i 2: /p/ & /b/', color: '#58cc02' },
    { id: 2, type: 'game',  label: 'Game /p/', color: '#ff9600', gameIndex: 0 },
    { id: 2, type: 'game',  label: 'Game /b/', color: '#a322ea', gameIndex: 1 },
    { id: 3, type: 'learn', label: 'B√†i 3: /√¶/ & /…™/', color: '#58cc02' },
    { id: 3, type: 'game',  label: 'Game /√¶/', color: '#ff9600', gameIndex: 0 },
    { id: 3, type: 'game',  label: 'Game /…™/', color: '#a322ea', gameIndex: 1 },
    { id: 4, type: 'learn', label: 'B√†i 4: / å/ & /…ë/', color: '#58cc02' },
    { id: 4, type: 'game',  label: 'Game / å/', color: '#ff9600', gameIndex: 0 },
    { id: 4, type: 'game',  label: 'Game /…ë/', color: '#a322ea', gameIndex: 1 },
    { id: 5, type: 'learn', label: 'B√†i 5: /e/', color: '#58cc02' },
    { id: 5, type: 'game',  label: 'Game /e/', color: '#ff9600', gameIndex: 0 },
    { id: 6, type: 'learn', label: 'B√†i 6: /k/ & /g/', color: '#58cc02' },
    { id: 6, type: 'game',  label: 'Game /k/', color: '#ff9600', gameIndex: 0 },
    { id: 6, type: 'game',  label: 'Game /g/', color: '#a322ea', gameIndex: 1 },
    { id: 7, type: 'learn', label: 'B√†i 7: /f/ & /v/', color: '#58cc02' },
    { id: 7, type: 'game',  label: 'Game /f/', color: '#ff9600', gameIndex: 0 },
    { id: 7, type: 'game',  label: 'Game /v/', color: '#a322ea', gameIndex: 1 },
    { id: 8, type: 'learn', label: 'B√†i 8: /s/ & /z/', color: '#58cc02' },
    { id: 8, type: 'game',  label: 'Game /s/', color: '#ff9600', gameIndex: 0 },
    { id: 8, type: 'game',  label: 'Game /z/', color: '#a322ea', gameIndex: 1 },
    { id: 9, type: 'learn', label: 'B√†i 9: / É/ & / í/', color: '#58cc02' },
    { id: 9, type: 'game',  label: 'Game / É/', color: '#ff9600', gameIndex: 0 },
    { id: 9, type: 'game',  label: 'Game / í/', color: '#a322ea', gameIndex: 1 },
    { id: 10, type: 'learn', label: 'B√†i 10: /t É/ & /d í/', color: '#58cc02' },
    { id: 10, type: 'game',  label: 'Game /t É/', color: '#ff9600', gameIndex: 0 },
    { id: 10, type: 'game',  label: 'Game /d í/', color: '#a322ea', gameIndex: 1 },
    { id: 11, type: 'learn', label: 'B√†i 11: √în t·∫≠p', color: '#ff9600' },
    { id: 12, type: 'learn', label: 'B√†i 12: √Çm /iÀê/', color: '#58cc02' },
    { id: 12, type: 'game',  label: 'Game /iÀê/', color: '#ff9600', gameIndex: 0 },
    { id: 13, type: 'learn', label: 'B√†i 13: / ä/ & /uÀê/', color: '#58cc02' },
    { id: 13, type: 'game',  label: 'Game / ä/', color: '#ff9600', gameIndex: 0 },
    { id: 13, type: 'game',  label: 'Game /uÀê/', color: '#a322ea', gameIndex: 1 },
    { id: 14, type: 'learn', label: 'B√†i 14: /…ëÀêr/ & /…îÀêr/', color: '#58cc02' },
    { id: 14, type: 'game',  label: 'Game /…ëÀêr/', color: '#ff9600', gameIndex: 0 },
    { id: 14, type: 'game',  label: 'Game /…îÀêr/', color: '#a322ea', gameIndex: 1 },
    { id: 15, type: 'learn', label: 'B√†i 15: /…ô/ & /…úÀêr/', color: '#58cc02' },
    { id: 15, type: 'game',  label: 'Game /…ô/', color: '#ff9600', gameIndex: 0 },
    { id: 15, type: 'game',  label: 'Game /…úÀêr/', color: '#a322ea', gameIndex: 1 },
    { id: 16, type: 'learn', label: 'B√†i 16: /…™r/ & /er/', color: '#58cc02' },
    { id: 16, type: 'game',  label: 'Game /…™r/', color: '#ff9600', gameIndex: 0 },
    { id: 16, type: 'game',  label: 'Game /er/', color: '#a322ea', gameIndex: 1 },
    { id: 17, type: 'learn', label: 'B√†i 17: /a ä/ & /o ä/', color: '#58cc02' },
    { id: 17, type: 'game',  label: 'Game /a ä/', color: '#ff9600', gameIndex: 0 },
    { id: 17, type: 'game',  label: 'Game /o ä/', color: '#a322ea', gameIndex: 1 },
    { id: 18, type: 'learn', label: 'B√†i 18: /e…™/ & /a…™/', color: '#58cc02' },
    { id: 18, type: 'game',  label: 'Game /e…™/ (Mole)', gameType: 'mole', color: '#ff9600', gameIndex: 0 },
    { id: 18, type: 'game',  label: 'Game /a…™/ (Mole)', gameType: 'mole', color: '#a322ea', gameIndex: 1 },
    { id: 19, type: 'learn', label: 'B√†i 19: /…î…™/ & /tÃ¨/', color: '#58cc02' },
    { id: 19, type: 'game',  label: 'Game /…î…™/ (Snake)', gameType: 'snake', color: '#ff9600', gameIndex: 0 },
    { id: 19, type: 'game',  label: 'Game /tÃ¨/ (Snake)', gameType: 'snake', color: '#a322ea', gameIndex: 1 },
    { id: 20, type: 'learn', label: 'B√†i 20: /m/ & /n/', color: '#58cc02' },
    { id: 20, type: 'game',  label: 'Game /m/', color: '#ff9600', gameIndex: 0 },
    { id: 20, type: 'game',  label: 'Game /n/', color: '#a322ea', gameIndex: 1 },
    { id: 21, type: 'learn', label: 'B√†i 21: /≈ã/ & /h/', color: '#58cc02' },
    { id: 21, type: 'game',  label: 'Game /≈ã/', color: '#ff9600', gameIndex: 0 },
    { id: 21, type: 'game',  label: 'Game /h/', color: '#a322ea', gameIndex: 1 },
    { id: 22, type: 'learn', label: 'B√†i 22: /r/ & /l/', color: '#58cc02' },
    { id: 22, type: 'game',  label: 'Game /r/', color: '#ff9600', gameIndex: 0 },
    { id: 22, type: 'game',  label: 'Game /l/', color: '#a322ea', gameIndex: 1 },
    { id: 23, type: 'learn', label: 'B√†i 23: /j/ & /w/', color: '#58cc02' },
    { id: 23, type: 'game',  label: 'Game /j/', color: '#ff9600', gameIndex: 0 },
    { id: 23, type: 'game',  label: 'Game /w/', color: '#a322ea', gameIndex: 1 },
    { id: 24, type: 'learn', label: 'B√†i 24: /Œ∏/ & /√∞/', color: '#58cc02' },
    { id: 24, type: 'game',  label: 'Game /Œ∏/', color: '#ff9600', gameIndex: 0 },
    { id: 24, type: 'game',  label: 'Game /√∞/', color: '#a322ea', gameIndex: 1 },
    { id: 25, type: 'learn', label: 'B√†i 25: /ks/ & /kw/', color: '#58cc02' },
    { id: 25, type: 'game',  label: 'Game /ks/', color: '#ff9600', gameIndex: 1 },
    { id: 25, type: 'game',  label: 'Game /kw/', color: '#a322ea', gameIndex: 0 },

    { id: 26, type: 'learn', label: 'üéì THI TH·ª¨ CU·ªêI KH√ìA', color: '#e74c3c' }
];
/* ==========================================================================
   PH·∫¶N 2: D·ªÆ LI·ªÜU (DATA ENGINE & IPA DATA)
   ========================================================================== */
const DataEngine = {
    lesson1: [
        { img: "tap.jpg", speak: "tap", pre: "t", parts: [{t:"t"}, {i:"√¶", t:"a"}, {t:"p"}] },
        { img: "top.jpg", speak: "top", pre: "t", parts: [{t:"t"}, {i:"…ë", t:"o"}, {t:"p"}] },
        { img: "pot.jpg", speak: "pot", pre: "p", parts: [{t:"p"}, {i:"…ë", t:"o"}, {t:"t"}] },
        { img: "to.jpg", speak: "to", pre: "t", parts: [{t:"t"}, {i:"uÀê", t:"o"}] },
        { img: "tin.jpg", speak: "tin", pre: "t", parts: [{t:"t"}, {i:"…™", t:"i"}, {t:"n"}] },
        { img: "dog.jpg", speak: "dog", pre: "d", parts: [{t:"d"}, {i:"…ë", t:"o"}, {t:"g"}] },
        { img: "dad.jpg", speak: "dad", pre: "d", parts: [{t:"d"}, {i:"√¶", t:"a"}, {t:"d"}] },
        { img: "dig.jpg", speak: "dig", pre: "d", parts: [{t:"d"}, {i:"…™", t:"i"}, {t:"g"}] },
        { img: "duck.jpg", speak: "duck", pre: "d", parts: [{t:"d"}, {i:" å", t:"u"}, {i:"k", t:"ck"}] },
        { img: "do.jpg", speak: "do", pre: "d", parts: [{t:"d"}, {i:"uÀê", t:"o"}] },
        { type: "game", title: "Game /t/", pairs: ["tap", "top", "pot", "to", "tin"], img: "t_card.jpg" },
        { type: "game", title: "Game /d/", pairs: ["dog", "dad", "dig", "duck", "do"], img: "d_card.jpg" }
    ],
    lesson2: [
        { img: "pen.jpg", speak: "pen", pre: "p", parts: [{t:"p"}, {i:"e", t:"e"}, {t:"n"}] },
        { img: "pig.jpg", speak: "pig", pre: "p", parts: [{t:"p"}, {i:"…™", t:"i"}, {t:"g"}] },
        { img: "pot.jpg", speak: "pot", pre: "p", parts: [{t:"p"}, {i:"…ë", t:"o"}, {t:"t"}] },
        { img: "pull.jpg", speak: "pull", pre: "p", parts: [{t:"p"}, {i:" ä", t:"u"}, {t:"ll"}] },
        { img: "pin.jpg", speak: "pin", pre: "p", parts: [{t:"p"}, {i:"…™", t:"i"}, {t:"n"}] },
        { img: "bag.jpg", speak: "bag", pre: "b", parts: [{t:"b"}, {i:"√¶", t:"a"}, {t:"g"}] },
        { img: "book.jpg", speak: "book", pre: "b", parts: [{t:"b"}, {i:" ä", t:"oo"}, {t:"k"}] },
        { img: "bat.jpg", speak: "bat", pre: "b", parts: [{t:"b"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "box.jpg", speak: "box", pre: "b", parts: [{t:"b"}, {i:"…ë", t:"o"}, {i:"k s", t:"x"}] },
        { img: "bin.jpg", speak: "bin", pre: "b", parts: [{t:"b"}, {i:"…™", t:"i"}, {t:"n"}] },
        { type: "game", title: "Game /p/", pairs: ["pen", "pig", "pot", "pull", "pin"], img: "p_card.jpg" },
        { type: "game", title: "Game /b/", pairs: ["bag", "book", "bat", "box", "bin"], img: "b_card.jpg" }
    ],
    lesson3: [
        { img: "bat.jpg", speak: "bat", pre: "ae", parts: [{t:"b"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "dad.jpg", speak: "dad", pre: "ae", parts: [{t:"d"}, {i:"√¶", t:"a"}, {t:"d"}] },
        { img: "pat.jpg", speak: "pat", pre: "ae", parts: [{t:"p"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "tap.jpg", speak: "tap", pre: "ae", parts: [{t:"t"}, {i:"√¶", t:"a"}, {t:"p"}] },
        { img: "bad.jpg", speak: "bad", pre: "ae", parts: [{t:"b"}, {i:"√¶", t:"a"}, {t:"d"}] },
        { img: "dip.jpg", speak: "dip", pre: "i", parts: [{t:"d"}, {i:"…™", t:"i"}, {t:"p"}] },
        { img: "bit.jpg", speak: "bit", pre: "i", parts: [{t:"b"}, {i:"…™", t:"i"}, {t:"t"}] },
        { img: "pit.jpg", speak: "pit", pre: "i", parts: [{t:"p"}, {i:"…™", t:"i"}, {t:"t"}] },
        { img: "tip.jpg", speak: "tip", pre: "i", parts: [{t:"t"}, {i:"…™", t:"i"}, {t:"p"}] },
        { img: "bib.jpg", speak: "bib", pre: "i", parts: [{t:"b"}, {i:"…™", t:"i"}, {t:"b"}] },
        { type: "game", title: "Game /√¶/", pairs: ["bat", "dad", "pat", "tap", "bad"], img: "√¶_card.jpg" },
        { type: "game", title: "Game /…™/", pairs: ["dip", "bit", "pit", "tip", "bib"], img: "…™_card.jpg" }
    ],
    lesson4: [
        { img: "duck.jpg", speak: "duck", pre: "uh", parts: [{t:"d"}, {i:" å", t:"u"}, {i:"k", t:"ck"}] },
        { img: "but.jpg", speak: "but", pre: "uh", parts: [{t:"b"}, {i:" å", t:"u"}, {t:"t"}] },
        { img: "tub.jpg", speak: "tub", pre: "uh", parts: [{t:"t"}, {i:" å", t:"u"}, {t:"b"}] },
        { img: "cup.jpg", speak: "cup", pre: "uh", parts: [{i:"k", t:"c"}, {i:" å", t:"u"}, {t:"p"}] },
        { img: "bud.jpg", speak: "bud", pre: "uh", parts: [{t:"b"}, {i:" å", t:"u"}, {t:"d"}] },
        { img: "dot.jpg", speak: "dot", pre: "aa", parts: [{t:"d"}, {i:"…ë", t:"o"}, {t:"t"}] },
        { img: "top.jpg", speak: "top", pre: "aa", parts: [{t:"t"}, {i:"…ë", t:"o"}, {t:"p"}] },
        { img: "pot.jpg", speak: "pot", pre: "aa", parts: [{t:"p"}, {i:"…ë", t:"o"}, {t:"t"}] },
        { img: "dog.jpg", speak: "dog", pre: "aa", parts: [{t:"d"}, {i:"…ë", t:"o"}, {t:"g"}] },
        { img: "Bob.jpg", speak: "Bob", pre: "aa", parts: [{t:"B"}, {i:"…ë", t:"o"}, {t:"b"}] },
        { type: "game", title: "Game / å/", pairs: ["duck", "but", "tub", "cup", "bud"], img: " å_card.jpg" },
        { type: "game", title: "Game /…ë/", pairs: ["dot", "top", "pot", "dog", "Bob"], img: "…ë_card.jpg" }
    ],
    lesson5: [
        { img: "Ted.jpg", speak: "Ted", pre: "e", parts: [{t:"T"}, {i:"e", t:"e"}, {t:"d"}] },
        { img: "pen.jpg", speak: "pen", pre: "e", parts: [{t:"p"}, {i:"e", t:"e"}, {t:"n"}] },
        { img: "ten.jpg", speak: "ten", pre: "e", parts: [{t:"t"}, {i:"e", t:"e"}, {t:"n"}] },
        { img: "bed.jpg", speak: "bed", pre: "e", parts: [{t:"b"}, {i:"e", t:"e"}, {t:"d"}] },
        { img: "pet.jpg", speak: "pet", pre: "e", parts: [{t:"p"}, {i:"e", t:"e"}, {t:"t"}] },
        { type: "game", title: "Game /e/", pairs: ["Ted", "pen", "ten", "bed", "pet"], img: "e_card.jpg" }
    ],
    lesson6: [
        { img: "cat.jpg", speak: "cat", pre: "k", parts: [{i:"k", t:"c"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "kid.jpg", speak: "kid", pre: "k", parts: [{t:"k"}, {i:"…™", t:"i"}, {t:"d"}] },
        { img: "cap.jpg", speak: "cap", pre: "k", parts: [{i:"k", t:"c"}, {i:"√¶", t:"a"}, {t:"p"}] },
        { img: "cot.jpg", speak: "cot", pre: "k", parts: [{i:"k", t:"c"}, {i:"…ë", t:"o"}, {t:"t"}] },
        { img: "cup.jpg", speak: "cup", pre: "k", parts: [{i:"k", t:"c"}, {i:" å", t:"u"}, {t:"p"}] },
        { img: "gap.jpg", speak: "gap", pre: "g", parts: [{t:"g"}, {i:"√¶", t:"a"}, {t:"p"}] },
        { img: "got.jpg", speak: "got", pre: "g", parts: [{t:"g"}, {i:"…ë", t:"o"}, {t:"t"}] },
        { img: "dig.jpg", speak: "dig", pre: "d", parts: [{t:"d"}, {i:"…™", t:"i"}, {t:"g"}] },
        { img: "dog.jpg", speak: "dog", pre: "d", parts: [{t:"d"}, {i:"…ë", t:"o"}, {t:"g"}] },
        { img: "get.jpg", speak: "get", pre: "g", parts: [{t:"g"}, {i:"e", t:"e"}, {t:"t"}] },
        { type: "game", title: "Game /k/", pairs: ["cat", "gap", "kid", "got", "cup"], img: "k_card.jpg" },
        { type: "game", title: "Game /g/", pairs: ["gap", "got", "dig", "dog", "get"], img: "g_card.jpg" }
    ],
    lesson7: [
        { img: "fog.jpg", speak: "fog", pre: "f", parts: [{t:"f"}, {i:"…ë", t:"o"}, {t:"g"}] },
        { img: "fit.jpg", speak: "fit", pre: "f", parts: [{t:"f"}, {i:"…™", t:"i"}, {t:"t"}] },
        { img: "fig.jpg", speak: "fig", pre: "f", parts: [{t:"f"}, {i:"…™", t:"i"}, {t:"g"}] },
        { img: "fat.jpg", speak: "fat", pre: "f", parts: [{t:"f"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "fed.jpg", speak: "fed", pre: "f", parts: [{t:"f"}, {i:"e", t:"e"}, {t:"d"}] },
        { img: "vat.jpg", speak: "vat", pre: "v", parts: [{t:"v"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "vet.jpg", speak: "vet", pre: "v", parts: [{t:"v"}, {i:"e", t:"e"}, {t:"t"}] },
        { img: "van.jpg", speak: "van", pre: "v", parts: [{t:"v"}, {i:"√¶", t:"a"}, {t:"n"}] },
        { type: "sent", img: "sentence_fed.jpg", speak: "Bob fed a fat dog", parts: [{t:"B"}, {i:"…ë", t:"o"}, {t:"b"}, {t:" "}, {t:"f"}, {i:"e", t:"e"}, {t:"d"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"f"}, {i:"√¶", t:"a"}, {t:"t"}, {t:" "}, {t:"d"}, {i:"…ë", t:"o"}, {t:"g."}] },
        { type: "sent", img: "sentence_cat.jpg", speak: "A cat got a big cap", parts: [{i:"…ô", t:"A"}, {t:" "}, {i:"k", t:"c"}, {i:"√¶", t:"a"}, {t:"t"}, {t:" "}, {t:"g"}, {i:"…ë", t:"o"}, {t:"t"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"b"}, {i:"…™", t:"i"}, {t:"g"}, {t:" "}, {i:"k", t:"c"}, {i:"√¶", t:"a"}, {t:"p."}] },
        { type: "game", title: "Game /f/", pairs: ["fog", "vat", "fit", "vet", "fat"], img: "f_card.jpg" },
        { type: "game", title: "Game /v/", pairs: ["vat", "vet", "van"], img: "v_card.jpg" }
    ],
    lesson8: [
        { img: "bus.jpg", speak: "bus", pre: "s", parts: [{t:"b"}, {i:" å", t:"u"}, {t:"s"}] },
        { img: "kiss.jpg", speak: "kiss", pre: "s", parts: [{t:"k"}, {i:"…™", t:"i"}, {t:"ss"}] },
        { img: "sick.jpg", speak: "sick", pre: "s", parts: [{t:"s"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}] },
        { img: "sock.jpg", speak: "sock", pre: "s", parts: [{t:"s"}, {i:"…ë", t:"o"}, {i:"k", t:"ck"}] },
        { img: "sit.jpg", speak: "sit", pre: "s", parts: [{t:"s"}, {i:"…™", t:"i"}, {t:"t"}] },
        { img: "zip.jpg", speak: "zip", pre: "z", parts: [{t:"z"}, {i:"…™", t:"i"}, {t:"p"}] },
        { img: "zigzag.jpg", speak: "zigzag", pre: "z", parts: [{t:"z"}, {i:"…™", t:"i"}, {t:"g"}, {t:"z"}, {i:"√¶", t:"a"}, {t:"g"}] },
        { img: "bugs.jpg", speak: "bugs", pre: "z", parts: [{t:"b"}, {i:" å", t:"u"}, {t:"g"}, {i:"z", t:"s"}] },
        { img: "dogs.jpg", speak: "dogs", pre: "z", parts: [{t:"d"}, {i:"…ë", t:"o"}, {t:"g"}, {i:"z", t:"s"}] },
        { img: "is.jpg", speak: "is", pre: "z", parts: [{i:"…™", t:"i"}, {i:"z", t:"s"}] },
        { type: "sent", img: "sentence_pig.jpg", speak: "A pig gets a cup", parts: [{i:"…ô", t:"A"}, {t:" "}, {t:"p"}, {i:"…™", t:"i"}, {t:"g"}, {t:" "}, {t:"g"}, {i:"e", t:"e"}, {t:"t"}, {t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"k", t:"c"}, {i:" å", t:"u"}, {t:"p."}] },
        { type: "sent", img: "sentence_duck.jpg", speak: "A duck sits on the bed", parts: [{i:"…ô", t:"A"}, {t:" "}, {t:"d"}, {i:" å", t:"u"}, {i:"k", t:"ck"}, {t:" "}, {t:"s"}, {i:"…™", t:"i"}, {t:"t"}, {t:"s"}, {t:" "}, {i:"…ë", t:"o"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"b"}, {i:"e", t:"e"}, {t:"d."}] },
        { type: "sent", img: "sentence_dad.jpg", speak: "Dad digs a pit", parts: [{t:"D"}, {i:"√¶", t:"a"}, {t:"d"}, {t:" "}, {t:"d"}, {i:"…™", t:"i"}, {t:"g"}, {i:"z", t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"p"}, {i:"…™", t:"i"}, {t:"t."}] },
        { type: "game", title: "Game /s/", pairs: ["bus", "kiss", "sick", "sock", "sit"], img: "s_card.jpg" },
        { type: "game", title: "Game /z/", pairs: ["zip", "zigzag", "bugs", "dogs", "is"], img: "z_card.jpg" }
    ],
    lesson9: [
        { img: "shop.jpg", speak: "shop", pre: "sh", parts: [{i:" É", t:"sh"}, {i:"…ë", t:"o"}, {t:"p"}] },
        { img: "ship.jpg", speak: "ship", pre: "sh", parts: [{i:" É", t:"sh"}, {i:"…™", t:"i"}, {t:"p"}] },
        { img: "fish.jpg", speak: "fish", pre: "sh", parts: [{t:"f"}, {i:"…™", t:"i"}, {i:" É", t:"sh"}] },
        { img: "dish.jpg", speak: "dish", pre: "sh", parts: [{t:"d"}, {i:"…™", t:"i"}, {i:" É", t:"sh"}] },
        { img: "measure.jpg", speak: "measure", pre: "zh", parts: [{t:"m"}, {i:"e", t:"ea"}, {i:" í", t:"s"}, {i:"…ôr", t:"ure"}] },
        { img: "treasure.jpg", speak: "treasure", pre: "zh", parts: [{t:"t"}, {t:"r"}, {i:"e", t:"ea"}, {i:" í", t:"s"}, {i:"…ôr", t:"ure"}] },
        { img: "vision.jpg", speak: "vision", pre: "zh", parts: [{t:"v"}, {i:"…™", t:"i"}, {i:" í", t:"s"}, {i:"…ôn", t:"ion"}] },
        { type: "sent", img: "sentence_shells.jpg", speak: "She sells seashells on the seashore", parts: [{i:" É", t:"Sh"}, {i:"iÀê", t:"e"}, {t:" "}, {t:"s"}, {i:"e", t:"e"}, {t:"ll"}, {i:"z", t:"s"}, {t:" "}, {t:"s"}, {i:"iÀê", t:"ea"}, {i:" É", t:"sh"}, {i:"e", t:"e"}, {t:"ll"}, {i:"z", t:"s"}, {t:" "}, {i:"…ë", t:"o"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"s"}, {i:"iÀê", t:"ea"}, {i:" É", t:"sh"}, {i:"…îÀêr", t:"ore."}] },
        { type: "sent", img: "sentence_fish.jpg", speak: "A fat fish sits on a treasure bag", parts: [{i:"…ô", t:"A"}, {t:" "}, {t:"f"}, {i:"√¶", t:"a"}, {t:"t"}, {t:" "}, {t:"f"}, {i:"…™", t:"i"}, {i:" É", t:"sh"}, {t:" "}, {t:"s"}, {i:"…™", t:"i"}, {t:"t"}, {i:"z", t:"s"}, {t:" "}, {i:"…ë", t:"o"}, {t:"n"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"t"}, {t:"r"}, {i:"e", t:"ea"}, {i:" í", t:"s"}, {i:"…ôr", t:"ure"}, {t:" "}, {t:"b"}, {i:"√¶", t:"a"}, {t:"g."}] },
        { type: "game", title: "Game / É/", pairs: ["shop", "ship", "fish", "dish"], img: " É_card.jpg" },
        { type: "game", title: "Game / í/", pairs: ["measure", "treasure", "vision"], img: " í_card.jpg" }
    ],
    lesson10: [
        { img: "chick.jpg", speak: "chick", pre: "ch", parts: [{i:"t É", t:"ch"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}] },
        { img: "chop.jpg", speak: "chop", pre: "ch", parts: [{i:"t É", t:"ch"}, {i:"…ë", t:"o"}, {t:"p"}] },
        { img: "chin.jpg", speak: "chin", pre: "ch", parts: [{i:"t É", t:"ch"}, {i:"…™", t:"i"}, {t:"n"}] },
        { img: "chip.jpg", speak: "chip", pre: "ch", parts: [{i:"t É", t:"ch"}, {i:"…™", t:"i"}, {t:"p"}] },
        { img: "chat.jpg", speak: "chat", pre: "ch", parts: [{i:"t É", t:"ch"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "jam.jpg", speak: "jam", pre: "j", parts: [{i:"d í", t:"j"}, {i:"√¶", t:"a"}, {t:"m"}] },
        { img: "jet.jpg", speak: "jet", pre: "j", parts: [{i:"d í", t:"j"}, {i:"e", t:"e"}, {t:"t"}] },
        { img: "jug.jpg", speak: "jug", pre: "j", parts: [{i:"d í", t:"j"}, {i:" å", t:"u"}, {t:"g"}] },
        { img: "Jack.jpg", speak: "Jack", pre: "j", parts: [{i:"d í", t:"J"}, {i:"√¶", t:"a"}, {i:"k", t:"ck"}] },
        { img: "job.jpg", speak: "job", pre: "j", parts: [{i:"d í", t:"j"}, {i:"…ë", t:"o"}, {t:"b"}] },
        { type: "sent", img: "sentence_cheerful.jpg", speak: "Cheerful children chase chatty chicks", parts: [{i:"t É", t:"Ch"}, {i:"…™r", t:"eer"}, {t:"f"}, {i:"…ô", t:"u"}, {t:"l"}, {t:" "}, {i:"t É", t:"ch"}, {i:"…™", t:"i"}, {t:"l"}, {t:"d"}, {t:"r"}, {i:"…ô", t:"e"}, {t:"n"}, {t:" "}, {i:"t É", t:"ch"}, {i:"e…™", t:"a"}, {t:"s"}, {i:"_", t:"e"}, {t:" "}, {i:"t É", t:"ch"}, {i:"√¶", t:"a"}, {t:"tt"}, {i:"i", t:"y"}, {t:" "}, {i:"t É", t:"ch"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}, {t:"s."}] },
        { type: "sent", img: "sentence_jack_jill.jpg", speak: "Jack and Jill juggle juicy ginger jars", parts: [{i:"d í", t:"J"}, {i:"√¶", t:"a"}, {i:"k", t:"ck"}, {t:" "}, {i:"√¶", t:"a"}, {t:"n"}, {t:"d"}, {t:" "}, {i:"d í", t:"J"}, {i:"…™", t:"i"}, {t:"ll"}, {t:" "}, {i:"d í", t:"j"}, {i:" å", t:"u"}, {t:"gg"}, {t:"l"}, {i:"_", t:"e"}, {t:" "}, {i:"d í", t:"j"}, {i:"uÀê", t:"ui"}, {i:"s", t:"c"}, {i:"i", t:"y"}, {t:" "}, {i:"d í", t:"g"}, {i:"…™", t:"in"}, {t:"n"}, {i:"d í", t:"g"}, {i:"…ôr", t:"er"}, {t:" "}, {i:"d í", t:"j"}, {i:"…ëÀêr", t:"ar"}, {i:"z", t:"s."}] },
        { type: "sent", img: "sentence_chick.jpg", speak: "The chick checks the jam", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {i:"t É", t:"ch"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}, {t:" "}, {i:"t É", t:"ch"}, {i:"e", t:"e"}, {i:"k", t:"ck"}, {t:"s"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {i:"d í", t:"j"}, {i:"√¶", t:"a"}, {t:"m."}] },
        { type: "game", title: "Game /t É/", pairs: ["chick", "chop", "chin", "chip", "chat"], img: "t É_card.jpg" },
        { type: "game", title: "Game /d í/", pairs: ["jam", "jet", "jug", "Jack", "job"], img: "d í_card.jpg" }
    ],
    lesson11: [
        { type: "sent", img: "sentence_Jack.jpg", speak: "Jack got a fish on the dish", parts: [{i:"d í", t:"J"}, {i:"√¶", t:"a"}, {i:"k", t:"ck"}, {t:" "}, {t:"g"}, {i:"…ë", t:"o"}, {t:"t"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"f"}, {i:"…™", t:"i"}, {i:" É", t:"sh"}, {t:" "}, {i:"…ë", t:"o"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"d"}, {i:"…™", t:"i"}, {i:" É", t:"sh."}] },
        { type: "sent", img: "sentence_vet.jpg", speak: "The vet fed the chick on a big ship", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"v"}, {i:"e", t:"e"}, {t:"t"}, {t:" "}, {t:"f"}, {i:"e", t:"e"}, {t:"d"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {i:"t É", t:"ch"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}, {t:" "}, {i:"…ë", t:"o"}, {t:"n"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"b"}, {i:"…™", t:"i"}, {t:"g"}, {t:" "}, {i:" É", t:"sh"}, {i:"…™", t:"i"}, {t:"p."}] },
        { type: "sent", img: "sentence_bugs.jpg", speak: "Cats and dogs catch bugs on a big bus", parts: [{i:"k", t:"C"}, {i:"√¶", t:"a"}, {t:"t"}, {t:"s"}, {t:" "}, {i:"√¶", t:"a"}, {t:"n"}, {t:"d"}, {t:" "}, {t:"d"}, {i:"…ë", t:"o"}, {t:"g"}, {i:"z", t:"s"}, {t:" "}, {i:"k", t:"c"}, {i:"√¶", t:"a"}, {i:"t É", t:"tch"}, {t:" "}, {t:"b"}, {i:" å", t:"u"}, {t:"g"}, {i:"z", t:"s"}, {t:" "}, {i:"…ë", t:"o"}, {t:"n"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"b"}, {i:"…™", t:"i"}, {t:"g"}, {t:" "}, {t:"b"}, {i:" å", t:"u"}, {t:"s."}] }
    ],
    lesson12: [
        { img: "sea.jpg", speak: "sea", pre: "ii", parts: [{t:"s"}, {i:"iÀê", t:"ea"}] },
        { img: "sheep.jpg", speak: "sheep", pre: "ii", parts: [{i:" É", t:"sh"}, {i:"iÀê", t:"eep"}] },
        { img: "feet.jpg", speak: "feet", pre: "ii", parts: [{t:"f"}, {i:"iÀê", t:"ee"}, {t:"t"}] },
        { img: "bee.jpg", speak: "bee", pre: "ii", parts: [{t:"b"}, {i:"iÀê", t:"ee"}] },
        { img: "eat.jpg", speak: "eat", pre: "ii", parts: [{i:"iÀê", t:"ea"}, {t:"t"}] },
        { type: "sent", img: "sentence_sheep.jpg", speak: "The sheep sees a bee", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {i:" É", t:"sh"}, {i:"iÀê", t:"eep"}, {t:" "}, {t:"s"}, {i:"iÀê", t:"ee"}, {i:"z", t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"b"}, {i:"iÀê", t:"ee."}] },
        { type: "sent", img: "sentence_she.jpg", speak: "She keeps a big seed", parts: [{i:" É", t:"Sh"}, {i:"iÀê", t:"e"}, {t:" "}, {t:"k"}, {i:"iÀê", t:"ee"}, {t:"p"}, {t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"b"}, {i:"…™", t:"i"}, {t:"g"}, {t:" "}, {t:"s"}, {i:"iÀê", t:"ee"}, {t:"d."}] },
        { type: "game", title: "Game /iÀê/", pairs: ["sea", "sheep", "feet", "bee", "eat"], img: "iÀê_card.jpg" }
    ],
    lesson13: [
        { img: "put.jpg", speak: "put", pre: "u", parts: [{t:"p"}, {i:" ä", t:"u"}, {t:"t"}] },
        { img: "bush.jpg", speak: "bush", pre: "u", parts: [{t:"b"}, {i:" ä", t:"u"}, {i:" É", t:"sh"}] },
        { img: "book.jpg", speak: "book", pre: "u", parts: [{t:"b"}, {i:" ä", t:"oo"}, {t:"k"}] },
        { img: "foot.jpg", speak: "foot", pre: "u", parts: [{t:"f"}, {i:" ä", t:"oo"}, {t:"t"}] },
        { img: "cook.jpg", speak: "cook", pre: "u", parts: [{i:"k", t:"c"}, {i:" ä", t:"oo"}, {t:"k"}] },
        { img: "boot.jpg", speak: "boot", pre: "uu", parts: [{t:"b"}, {i:"uÀê", t:"oo"}, {t:"t"}] },
        { img: "food.jpg", speak: "food", pre: "uu", parts: [{t:"f"}, {i:"uÀê", t:"oo"}, {t:"d"}] },
        { img: "goose.jpg", speak: "goose", pre: "uu", parts: [{t:"g"}, {i:"uÀê", t:"oo"}, {t:"s"}, {i:"_", t:"e"}] },
        { img: "zoo.jpg", speak: "zoo", pre: "uu", parts: [{t:"z"}, {i:"uÀê", t:"oo"}] },
        { img: "shoot.jpg", speak: "shoot", pre: "uu", parts: [{i:" É", t:"sh"}, {i:"uÀê", t:"oo"}, {t:"t"}] },
        { type: "sent", img: "sentence_book.jpg", speak: "Bob put the book in the bush", parts: [{t:"B"}, {i:"…ë", t:"o"}, {t:"b"}, {t:" "}, {t:"p"}, {i:" ä", t:"u"}, {t:"t"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"b"}, {i:" ä", t:"oo"}, {t:"k"}, {t:" "}, {i:"…™", t:"i"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"b"}, {i:" ä", t:"u"}, {i:" É", t:"sh."}] },
        { type: "sent", img: "sentence_goose.jpg", speak: "The goose eats food at the zoo", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"g"}, {i:"uÀê", t:"oo"}, {t:"s"}, {i:"_", t:"e"}, {t:" "}, {i:"iÀê", t:"ea"}, {t:"t"}, {t:"s"}, {t:" "}, {t:"f"}, {i:"uÀê", t:"oo"}, {t:"d"}, {t:" "}, {i:"√¶", t:"a"}, {t:"t"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"z"}, {i:"uÀê", t:"oo."}] },
        { type: "game", title: "Game / ä/", pairs: ["put", "bush", "book", "foot", "cook"], img: " ä_card.jpg" },
        { type: "game", title: "Game /uÀê/", pairs: ["boot", "food", "goose", "zoo", "shoot"], img: "uÀê_card.jpg" }
    ],
    lesson14: [
        { img: "shark.jpg", speak: "shark", pre: "ar", parts: [{i:" É", t:"sh"}, {i:"…ëÀêr", t:"ar"}, {t:"k"}] },
        { img: "star.jpg", speak: "star", pre: "ar", parts: [{t:"s"}, {t:"t"}, {i:"…ëÀêr", t:"ar"}] },
        { img: "cart.jpg", speak: "cart", pre: "ar", parts: [{i:"k", t:"c"}, {i:"…ëÀêr", t:"ar"}, {t:"t"}] },
        { img: "car.jpg", speak: "car", pre: "ar", parts: [{i:"k", t:"c"}, {i:"…ëÀêr", t:"ar"}] },
        { img: "park.jpg", speak: "park", pre: "ar", parts: [{t:"p"}, {i:"…ëÀêr", t:"ar"}, {t:"k"}] },
        { img: "torch.jpg", speak: "torch", pre: "or", parts: [{t:"t"}, {i:"…îÀêr", t:"or"}, {i:"t É", t:"ch"}] },
        { img: "shorts.jpg", speak: "shorts", pre: "or", parts: [{i:" É", t:"sh"}, {i:"…îÀêr", t:"or"}, {t:"t"}, {t:"s"}] },
        { img: "board.jpg", speak: "board", pre: "or", parts: [{t:"b"}, {i:"…îÀêr", t:"oar"}, {t:"d"}] },
        { img: "door.jpg", speak: "door", pre: "or", parts: [{t:"d"}, {i:"…îÀêr", t:"oor"}] },
        { img: "fork.jpg", speak: "fork", pre: "or", parts: [{t:"f"}, {i:"…îÀêr", t:"or"}, {t:"k"}] },
        { type: "sent", img: "sentence_shark.jpg", speak: "A shark put a star in the jar", parts: [{i:"…ô", t:"A"}, {t:" "}, {i:" É", t:"sh"}, {i:"…ëÀêr", t:"ar"}, {t:"k"}, {t:" "}, {t:"p"}, {i:" ä", t:"u"}, {t:"t"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"s"}, {t:"t"}, {i:"…ëÀêr", t:"ar"}, {t:" "}, {i:"…™", t:"i"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {i:"d í", t:"j"}, {i:"…ëÀêr", t:"ar."}] },
        { type: "sent", img: "sentence_fork.jpg", speak: "A short fork drops on the floor", parts: [{i:"…ô", t:"A"}, {t:" "}, {i:" É", t:"sh"}, {i:"…îÀêr", t:"or"}, {t:"t"}, {t:" "}, {t:"f"}, {i:"…îÀêr", t:"or"}, {t:"k"}, {t:" "}, {t:"d"}, {t:"r"}, {i:"…ë", t:"o"}, {t:"p"}, {t:"s"}, {t:" "}, {i:"…ë", t:"o"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"f"}, {t:"l"}, {i:"…îÀêr", t:"oor."}] },
        { type: "game", title: "Game /…ëÀêr/", pairs: ["shark", "torch", "star", "door", "car"], img: "…ëÀêr_card.jpg" },
        { type: "game", title: "Game /…îÀêr/", pairs: ["torch", "shorts", "board", "door", "fork"], img: "…îÀêr_card.jpg" }
    ],
    lesson15: [
        { img: "salad.jpg", speak: "salad", pre: "schwa", parts: [{t:"s"}, {i:"√¶", t:"a"}, {t:"l"}, {i:"…ô", t:"a"}, {t:"d"}] },
        { img: "lemon.jpg", speak: "lemon", pre: "schwa", parts: [{t:"l"}, {i:"e", t:"e"}, {t:"m"}, {i:"…ô", t:"o"}, {t:"n"}] },
        { img: "chicken.jpg", speak: "chicken", pre: "schwa", parts: [{i:"t É", t:"ch"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}, {i:"…ô", t:"e"}, {t:"n"}] },
        { img: "kitchen.jpg", speak: "kitchen", pre: "schwa", parts: [{t:"k"}, {i:"…™", t:"i"}, {i:"t É", t:"tch"}, {i:"…ô", t:"e"}, {t:"n"}] },
        { img: "panda.jpg", speak: "panda", pre: "schwa", parts: [{t:"p"}, {i:"√¶", t:"a"}, {t:"n"}, {t:"d"}, {i:"…ô", t:"a"}] },
        { img: "banana.jpg", speak: "banana", pre: "schwa", parts: [{t:"b"}, {i:"…ô", t:"a"}, {t:"n"}, {i:"√¶", t:"a"}, {t:"n"}, {i:"…ô", t:"a"}] },
        { img: "badminton.jpg", speak: "badminton", pre: "schwa", parts: [{t:"b"}, {i:"√¶", t:"a"}, {t:"d"}, {t:"m"}, {i:"…™", t:"i"}, {t:"n"}, {t:"t"}, {i:"…ô", t:"o"}, {t:"n"}] },
        { img: "elephant.jpg", speak: "elephant", pre: "schwa", parts: [{i:"e", t:"e"}, {t:"l"}, {i:"…ô", t:"e"}, {i:"f", t:"ph"}, {i:"…ô", t:"a"}, {t:"n"}, {t:"t"}] },
        { img: "teacher.jpg", speak: "teacher", pre: "ur", parts: [{t:"t"}, {i:"iÀê", t:"ea"}, {i:"t É", t:"ch"}, {i:"…ôr", t:"er"}] },
        { img: "doctor.jpg", speak: "doctor", pre: "ur", parts: [{t:"d"}, {i:"…ë", t:"o"}, {i:"k", t:"c"}, {t:"t"}, {i:"…ôr", t:"or"}] },
        { img: "burger.jpg", speak: "burger", pre: "ur", parts: [{t:"b"}, {i:"…úÀêr", t:"ur"}, {t:"g"}, {i:"…ôr", t:"er"}] },
        { img: "sister.jpg", speak: "sister", pre: "ur", parts: [{t:"s"}, {i:"…™", t:"i"}, {t:"s"}, {t:"t"}, {i:"…ôr", t:"er"}] },
        { img: "rubber.jpg", speak: "rubber", pre: "ur", parts: [{t:"r"}, {i:" å", t:"u"}, {t:"bb"}, {i:"…ôr", t:"er"}] },
        { img: "lizard.jpg", speak: "lizard", pre: "ur", parts: [{t:"l"}, {i:"…™", t:"i"}, {t:"z"}, {i:"…ôr", t:"ar"}, {t:"d"}] },
        { img: "under.jpg", speak: "under", pre: "ur", parts: [{i:" å", t:"u"}, {t:"n"}, {t:"d"}, {i:"…ôr", t:"er"}] },
        { img: "superman.jpg", speak: "superman", pre: "ur", parts: [{t:"s"}, {i:"uÀê", t:"u"}, {t:"p"}, {i:"…ôr", t:"er"}, {t:"m"}, {i:"√¶", t:"a"}, {t:"n"}] },
        { type: "game", title: "Game /…ô/", pairs: ["salad", "lemon", "chicken", "kitchen", "panda"], img: "…ô_card.jpg" },
        { type: "game", title: "Game /…úÀêr/", pairs: ["teacher", "doctor", "burger", "sister", "rubber"], img: "…úÀêr_card.jpg" }
    ],
   lesson16: [
        { img: "gear.jpg", speak: "gear", pre: "ir", parts: [{t:"g"}, {i:"…™r", t:"ear"}] },
        { img: "deer.jpg", speak: "deer", pre: "ir", parts: [{t:"d"}, {i:"…™r", t:"eer"}] },
        { img: "cheer.jpg", speak: "cheer", pre: "ir", parts: [{i:"t É", t:"ch"}, {i:"…™r", t:"eer"}] },
        
        // --- S·ª¨A L·ªñI ƒê·ªåC T·ª™ "TEAR" ---
        // Hi·ªÉn th·ªã (parts): V·∫´n l√† ch·ªØ "t" + "ear"
        // ƒê·ªçc (speak): ƒê·ªïi th√†nh "tier" ƒë·ªÉ m√°y lu√¥n ƒë·ªçc √¢m /t…™r/
        { img: "tear.jpg", speak: "tier", pre: "ir", parts: [{t:"t"}, {i:"…™r", t:"ear"}] },
        
        { img: "ear.jpg", speak: "ear", pre: "ir", parts: [{i:"…™r", t:"ear"}] },
        
        // C√°c t·ª´ √¢m /er/
        { img: "bear.jpg", speak: "bear", pre: "er", parts: [{t:"b"}, {i:"er", t:"ear"}] },
        { img: "pear.jpg", speak: "pear", pre: "er", parts: [{t:"p"}, {i:"er", t:"ear"}] },
        { img: "share.jpg", speak: "share", pre: "er", parts: [{i:" É", t:"sh"}, {i:"er", t:"are"}] },
        { img: "stair.jpg", speak: "stair", pre: "er", parts: [{t:"s"}, {t:"t"}, {i:"er", t:"air"}] },
        { img: "chair.jpg", speak: "chair", pre: "er", parts: [{i:"t É", t:"ch"}, {i:"er", t:"air"}] },
        
        // C√¢u
        { type: "sent", img: "sentence_deer.jpg", speak: "The deer is near the chair", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"d"}, {i:"…™r", t:"eer"}, {t:" "}, {i:"…™", t:"i"}, {i:"z", t:"s"}, {t:" "}, {t:"n"}, {i:"…™r", t:"ear"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {i:"t É", t:"ch"}, {i:"er", t:"air."}] },
        { type: "sent", img: "sentence_bear.jpg", speak: "The bear shares the pear", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"b"}, {i:"er", t:"ear"}, {t:" "}, {i:" É", t:"sh"}, {i:"er", t:"are"}, {i:"z", t:"s"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"p"}, {i:"er", t:"ear."}] },
        
        // Game
        { type: "game", title: "Game /…™r/", pairs: ["gear", "deer", "cheer", "tear", "ear"], img: "…™r_card.jpg" },
        { type: "game", title: "Game /er/", pairs: ["bear", "pear", "share", "stair", "chair"], img: "er_card.jpg" }
    ],
    lesson17: [
        { img: "shower.jpg", speak: "shower", pre: "au", parts: [{i:" É", t:"sh"}, {i:"a ä", t:"ow"}, {i:"…ôr", t:"er"}] },
        { img: "shout.jpg", speak: "shout", pre: "au", parts: [{i:" É", t:"sh"}, {i:"a ä", t:"ou"}, {t:"t"}] },
        { img: "cow.jpg", speak: "cow", pre: "au", parts: [{i:"k", t:"c"}, {i:"a ä", t:"ow"}] },
        { img: "brown.jpg", speak: "brown", pre: "au", parts: [{t:"b"}, {t:"r"}, {i:"a ä", t:"ow"}, {t:"n"}] },
        { img: "tower.jpg", speak: "tower", pre: "au", parts: [{t:"t"}, {i:"a ä", t:"ow"}, {i:"…ôr", t:"er"}] },
        { img: "toe.jpg", speak: "toe", pre: "ou", parts: [{t:"t"}, {i:"o ä", t:"oe"}] },
        { img: "boat.jpg", speak: "boat", pre: "ou", parts: [{t:"b"}, {i:"o ä", t:"oa"}, {t:"t"}] },
        { img: "coat.jpg", speak: "coat", pre: "ou", parts: [{i:"k", t:"c"}, {i:"o ä", t:"oa"}, {t:"t"}] },
        { img: "phone.jpg", speak: "phone", pre: "ou", parts: [{i:"f", t:"ph"}, {i:"o ä", t:"o"}, {t:"n"}, {i:"_", t:"e"}] },
        { img: "goat.jpg", speak: "goat", pre: "ou", parts: [{t:"g"}, {i:"o ä", t:"oa"}, {t:"t"}] },
        { type: "sent", img: "sentence_cow.jpg", speak: "The brown cow shouts at the mouse", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"b"}, {t:"r"}, {i:"a ä", t:"ow"}, {t:"n"}, {t:" "}, {i:"k", t:"c"}, {i:"a ä", t:"ow"}, {t:" "}, {i:" É", t:"sh"}, {i:"a ä", t:"ou"}, {t:"t"}, {t:"s"}, {t:" "}, {i:"√¶", t:"a"}, {t:"t"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"m"}, {i:"a ä", t:"ou"}, {t:"s"}, {i:"_", t:"e."}] },
        { type: "sent", img: "sentence_joe.jpg", speak: "Joe shows the slow goat the soap", parts: [{i:"d í", t:"J"}, {i:"o ä", t:"oe"}, {t:" "}, {i:" É", t:"sh"}, {i:"o ä", t:"ow"}, {i:"z", t:"s"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"s"}, {t:"l"}, {i:"o ä", t:"ow"}, {t:" "}, {t:"g"}, {i:"o ä", t:"oa"}, {t:"t"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"s"}, {i:"o ä", t:"oa"}, {t:"p."}] },
        { type: "game", title: "Game /a ä/", pairs: ["cow", "brown", "shout", "tower", "shower"], img: "a ä_card.jpg" },
        { type: "game", title: "Game /o ä/", pairs: ["toe", "boat", "coat", "phone", "goat"], img: "o ä_card.jpg" }
    ],
    lesson18: [
        { img: "face.jpg", speak: "face", pre: "ei", parts: [{t:"f"}, {i:"e…™", t:"a"}, {i:"s", t:"c"}, {i:"_", t:"e"}] },
        { img: "cake.jpg", speak: "cake", pre: "ei", parts: [{i:"k", t:"c"}, {i:"e…™", t:"a"}, {t:"k"}, {i:"_", t:"e"}] },
        { img: "cave.jpg", speak: "cave", pre: "ei", parts: [{i:"k", t:"c"}, {i:"e…™", t:"a"}, {t:"v"}, {i:"_", t:"e"}] },
        { img: "baby.jpg", speak: "baby", pre: "ei", parts: [{t:"b"}, {i:"e…™", t:"a"}, {t:"b"}, {i:"i", t:"y"}] },
        { img: "baker.jpg", speak: "baker", pre: "ei", parts: [{t:"b"}, {i:"e…™", t:"a"}, {t:"k"}, {i:"…ôr", t:"er"}] },
        { img: "kite.jpg", speak: "kite", pre: "ai", parts: [{t:"k"}, {i:"a…™", t:"i"}, {t:"t"}, {i:"_", t:"e"}] },
        { img: "bike.jpg", speak: "bike", pre: "ai", parts: [{t:"b"}, {i:"a…™", t:"i"}, {t:"k"}, {i:"_", t:"e"}] },
        { img: "tie.jpg", speak: "tie", pre: "ai", parts: [{t:"t"}, {i:"a…™", t:"ie"}] },
        { img: "pine.jpg", speak: "pine", pre: "ai", parts: [{t:"p"}, {i:"a…™", t:"i"}, {t:"n"}, {i:"_", t:"e"}] },
        { img: "cry.jpg", speak: "cry", pre: "ai", parts: [{i:"k", t:"c"}, {t:"r"}, {i:"a…™", t:"y"}] },
        { type: "sent", img: "sentence_vase.jpg", speak: "Kate paints a vase", parts: [{t:"K"}, {i:"e…™", t:"a"}, {t:"t"}, {i:"_", t:"e"}, {t:" "}, {t:"p"}, {i:"e…™", t:"ai"}, {t:"n"}, {t:"t"}, {t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"v"}, {i:"e…™", t:"a"}, {t:"s"}, {i:"_", t:"e."}] },
        { type: "sent", img: "sentence_tiger.jpg", speak: "A tiger bites a kite", parts: [{i:"…ô", t:"A"}, {t:" "}, {t:"t"}, {i:"a…™", t:"i"}, {t:"g"}, {i:"…ôr", t:"er"}, {t:" "}, {t:"b"}, {i:"a…™", t:"i"}, {t:"t"}, {i:"_", t:"e"}, {t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"k"}, {i:"a…™", t:"i"}, {t:"t"}, {i:"_", t:"e."}] },
        { type: "game", title: "Game /e…™/ (Mole)", gameType: 'mole', phoneme: "e…™", img: "e…™_card.jpg" },
        { type: "game", title: "Game /a…™/ (Mole)", gameType: 'mole', phoneme: "a…™", img: "a…™_card.jpg" }
    ],
    lesson19: [
        // √Çm /…î…™/ -> pre: "oi" (H·ªá th·ªëng s·∫Ω t√¨m file sound_oi.wav)
        { img: "coin.jpg", speak: "coin", pre: "oi", parts: [{i:"k", t:"c"}, {i:"…î…™", t:"oin"}] },
        { img: "point.jpg", speak: "point", pre: "oi", parts: [{t:"p"}, {i:"…î…™", t:"oi"}, {t:"n"}, {t:"t"}] },
        { img: "joy.jpg", speak: "joy", pre: "oi", parts: [{i:"d í", t:"j"}, {i:"…î…™", t:"oy"}] },
        { img: "boy.jpg", speak: "boy", pre: "oi", parts: [{t:"b"}, {i:"…î…™", t:"oy"}] },
        { img: "toy.jpg", speak: "toy", pre: "oi", parts: [{t:"t"}, {i:"…î…™", t:"oy"}] },

        // √Çm /tÃ¨/ (Flap T) -> pre: "flapt" (H·ªá th·ªëng s·∫Ω t√¨m file sound_flapt.wav)
        { img: "otter.jpg", speak: "otter", pre: "flapt", parts: [{i:"…ë", t:"o"}, {i:"tÃ¨", t:"tt"}, {i:"…ôr", t:"er"}] },
        { img: "butter.jpg", speak: "butter", pre: "flapt", parts: [{t:"b"}, {i:" å", t:"u"}, {i:"tÃ¨", t:"tt"}, {i:"…ôr", t:"er"}] },
        { img: "kitty.jpg", speak: "kitty", pre: "flapt", parts: [{t:"k"}, {i:"…™", t:"i"}, {i:"tÃ¨", t:"tt"}, {i:"i", t:"y"}] },
        { img: "party.jpg", speak: "party", pre: "flapt", parts: [{t:"p"}, {i:"…ëÀêr", t:"ar"}, {i:"tÃ¨", t:"t"}, {i:"i", t:"y"}] },
        { img: "city.jpg", speak: "city", pre: "flapt", parts: [{i:"s", t:"c"}, {i:"…™", t:"i"}, {i:"tÃ¨", t:"t"}, {i:"i", t:"y"}] },

        // C√¢u (Gi·ªØ nguy√™n)
        { type: "sent", img: "sentence_boy.jpg", speak: "A boy drops a coin and a toy", parts: [{i:"…ô", t:"A"}, {t:" "}, {t:"b"}, {i:"…î…™", t:"oy"}, {t:" "}, {t:"d"}, {t:"r"}, {i:"…ë", t:"o"}, {t:"p"}, {t:"s"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"k", t:"c"}, {i:"…î…™", t:"oi"}, {t:"n"}, {t:" "}, {i:"√¶", t:"a"}, {t:"n"}, {t:"d"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"t"}, {i:"…î…™", t:"oy."}] },
        { type: "sent", img: "sentence_peter.jpg", speak: "Peter got butter in the party", parts: [{t:"P"}, {i:"iÀê", t:"e"}, {i:"tÃ¨", t:"t"}, {i:"…ôr", t:"er"}, {t:" "}, {t:"g"}, {i:"…ë", t:"o"}, {t:"t"}, {t:" "}, {t:"b"}, {i:" å", t:"u"}, {i:"tÃ¨", t:"tt"}, {i:"…ôr", t:"er"}, {t:" "}, {i:"…™", t:"i"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"p"}, {i:"…ëÀêr", t:"ar"}, {i:"tÃ¨", t:"t"}, {i:"i", t:"y."}] },

        // Game (Gi·ªØ nguy√™n)
        { type: "game", title: "Game /…î…™/ (Snake)", gameType: 'snake', phoneme: "…î…™", img: "…î…™_card.jpg" },
        { type: "game", title: "Game /tÃ¨/ (Snake)", gameType: 'snake', phoneme: "tÃ¨", img: "tÃ¨_card.jpg" }
    ],
    lesson20: [
        { img: "mat.jpg", speak: "mat", pre: "m", parts: [{t:"m"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "game.jpg", speak: "game", pre: "m", parts: [{t:"g"}, {i:"e…™", t:"a"}, {t:"m"}, {i:"_", t:"e"}] },
        { img: "mad.jpg", speak: "mad", pre: "m", parts: [{t:"m"}, {i:"√¶", t:"a"}, {t:"d"}] },
        { img: "time.jpg", speak: "time", pre: "m", parts: [{t:"t"}, {i:"a…™", t:"i"}, {t:"m"}, {i:"_", t:"e"}] },
        { img: "mouse.jpg", speak: "mouse", pre: "m", parts: [{t:"m"}, {i:"a ä", t:"ou"}, {t:"s"}, {i:"_", t:"e"}] },
        { img: "net.jpg", speak: "net", pre: "n", parts: [{t:"n"}, {i:"e", t:"e"}, {t:"t"}] },
        { img: "sun.jpg", speak: "sun", pre: "n", parts: [{t:"s"}, {i:" å", t:"u"}, {t:"n"}] },
        { img: "note.jpg", speak: "note", pre: "n", parts: [{t:"n"}, {i:"o ä", t:"o"}, {t:"t"}, {i:"_", t:"e"}] },
        { img: "nine.jpg", speak: "nine", pre: "n", parts: [{t:"n"}, {i:"a…™", t:"i"}, {t:"n"}, {i:"_", t:"e"}] },
        { img: "fun.jpg", speak: "fun", pre: "n", parts: [{t:"f"}, {i:" å", t:"u"}, {t:"n"}] },
        { type: "sent", img: "sentence_mom.jpg", speak: "Mom is sick. Mika makes milk for mom", parts: [{t:"M"}, {i:"…ë", t:"o"}, {t:"m"}, {t:" "}, {i:"…™", t:"i"}, {t:"s"}, {t:" "}, {t:"s"}, {i:"…™", t:"i"}, {i:"k", t:"ck."}, {t:" "}, {t:"M"}, {i:"iÀê", t:"i"}, {t:"k"}, {i:"…ô", t:"a"}, {t:" "}, {t:"m"}, {i:"e…™", t:"a"}, {t:"k"}, {i:"_", t:"e"}, {t:"s"}, {t:" "}, {t:"m"}, {i:"…™", t:"i"}, {t:"l"}, {t:"k"}, {t:" "}, {t:"f"}, {i:"…îÀêr", t:"or"}, {t:" "}, {t:"m"}, {i:"…ë", t:"o"}, {t:"m."}] },
        { type: "sent", img: "sentence_nina.jpg", speak: "Nina can run fast and she never gives up", parts: [{t:"N"}, {i:"iÀê", t:"i"}, {t:"n"}, {i:"…ô", t:"a"}, {t:" "}, {i:"k", t:"c"}, {i:"√¶", t:"a"}, {t:"n"}, {t:" "}, {t:"r"}, {i:" å", t:"u"}, {t:"n"}, {t:" "}, {t:"f"}, {i:"√¶", t:"a"}, {t:"s"}, {t:"t"}, {t:" "}, {i:"√¶", t:"a"}, {t:"n"}, {t:"d"}, {t:" "}, {i:" É", t:"sh"}, {i:"iÀê", t:"e"}, {t:" "}, {t:"n"}, {i:"e", t:"e"}, {t:"v"}, {i:"…ôr", t:"er"}, {t:" "}, {t:"g"}, {i:"…™", t:"i"}, {t:"v"}, {i:"_", t:"e"}, {i:"z", t:"s"}, {t:" "}, {i:" å", t:"u"}, {t:"p."}] },
        { type: "game", title: "Game /m/", pairs: ["mat", "game", "mad", "time", "mouse"], img: "m_card.jpg" },
        { type: "game", title: "Game /n/", pairs: ["net", "sun", "note", "nine", "fun"], img: "n_card.jpg" }
    ],
    lesson21: [
        { img: "sing.jpg", speak: "sing", pre: "ng", parts: [{t:"s"}, {i:"…™ ≈ã", t:"ing"}] },
        { img: "finger.jpg", speak: "finger", pre: "ng", parts: [{t:"f"}, {i:"…™ ≈ã", t:"in"}, {t:"g"}, {i:"…ôr", t:"er"}] },
        { img: "king.jpg", speak: "king", pre: "ng", parts: [{t:"k"}, {i:"…™ ≈ã", t:"ing"}] },
        { img: "kingfisher.jpg", speak: "kingfisher", pre: "ng", parts: [{t:"k"}, {i:"…™ ≈ã", t:"ing"}, {t:"f"}, {i:"…™", t:"i"}, {i:" É", t:"sh"}, {i:"…ôr", t:"er"}] },
        { img: "monkey.jpg", speak: "monkey", pre: "ng", parts: [{t:"m"}, {i:" å ≈ã", t:"on"}, {t:"k"}, {i:"i", t:"ey"}] },
        { img: "hat.jpg", speak: "hat", pre: "h", parts: [{t:"h"}, {i:"√¶", t:"a"}, {t:"t"}] },
        { img: "hen.jpg", speak: "hen", pre: "h", parts: [{t:"h"}, {i:"e", t:"e"}, {t:"n"}] },
        { img: "hippo.jpg", speak: "hippo", pre: "h", parts: [{t:"h"}, {i:"…™", t:"i"}, {t:"pp"}, {i:"o ä", t:"o"}] },
        { img: "heart.jpg", speak: "heart", pre: "h", parts: [{t:"h"}, {i:"…ë:r", t:"ear"}, {t:"t"}] },
        { img: "horse.jpg", speak: "horse", pre: "h", parts: [{t:"h"}, {i:"…î:r", t:"or"}, {t:"s"}, {i:"_", t:"e"}] },
        { type: "sent", img: "sentence_monkey.jpg", speak: "The monkey is making an amazing gift for the flamingo", parts: [{i:"√∞", t:"Th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"m"}, {i:" å ≈ã", t:"on"}, {t:"k"}, {i:"i", t:"ey"}, {t:" "}, {i:"…™", t:"i"}, {i:"z", t:"s"}, {t:" "}, {t:"m"}, {i:"e…™", t:"a"}, {t:"k"}, {i:"…™ ≈ã", t:"ing"}, {t:" "}, {i:"…ô", t:"a"}, {t:"n"}, {t:" "}, {i:"…ô", t:"a"}, {t:"m"}, {i:"e…™", t:"a"}, {t:"z"}, {i:"…™ ≈ã", t:"ing"}, {t:" "}, {t:"g"}, {i:"…™", t:"i"}, {t:"f"}, {t:"t"}, {t:" "}, {t:"f"}, {i:"…îÀêr", t:"or"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"f"}, {t:"l"}, {i:"…ô", t:"a"}, {t:"m"}, {i:"…™ ≈ã", t:"in"}, {t:"g"}, {i:"o ä", t:"o."}] },
        { type: "sent", img: "sentence_he.jpg", speak: "He hopes his sister is happy", parts: [{t:"H"}, {i:"iÀê", t:"e"}, {t:" "}, {t:"h"}, {i:"o ä", t:"o"}, {t:"p"}, {i:"_", t:"e"}, {t:"s"}, {t:" "}, {t:"h"}, {i:"…™", t:"i"}, {t:"s"}, {t:" "}, {t:"s"}, {i:"…™", t:"i"}, {t:"s"}, {t:"t"}, {i:"…ôr", t:"er"}, {t:" "}, {i:"…™", t:"i"}, {i:"z", t:"s"}, {t:" "}, {t:"h"}, {i:"√¶", t:"a"}, {t:"pp"}, {i:"i", t:"y."}] },
        { type: "game", title: "Game /≈ã/", pairs: ["sing", "finger", "king", "kingfisher", "monkey"], img: "≈ã_card.jpg" },
        { type: "game", title: "Game /h/", pairs: ["hat", "hen", "hippo", "heart", "horse"], img: "h_card.jpg" }
    ],
    lesson22: [
        { img: "red.jpg", speak: "red", pre: "r", parts: [{t:"r"}, {i:"e", t:"e"}, {t:"d"}] },
        { img: "run.jpg", speak: "run", pre: "r", parts: [{t:"r"}, {i:" å", t:"u"}, {t:"n"}] },
        { img: "carrot.jpg", speak: "carrot", pre: "r", parts: [{i:"k", t:"c"}, {i:"√¶", t:"a"}, {t:"rr"}, {i:"…ô", t:"o"}, {t:"t"}] },
        { img: "ring.jpg", speak: "ring", pre: "r", parts: [{t:"r"}, {i:"…™ ≈ã", t:"ing"}] },
        { img: "rabbit.jpg", speak: "rabbit", pre: "r", parts: [{t:"r"}, {i:"√¶", t:"a"}, {t:"bb"}, {i:"…™", t:"i"}, {t:"t"}] },
        { img: "lion.jpg", speak: "lion", pre: "l", parts: [{t:"l"}, {i:"a…™", t:"i"}, {i:"…ô", t:"o"}, {t:"n"}] },
        { img: "ladder.jpg", speak: "ladder", pre: "l", parts: [{t:"l"}, {i:"√¶", t:"a"}, {t:"dd"}, {i:"…ôr", t:"er"}] },
        { img: "ball.jpg", speak: "ball", pre: "l", parts: [{t:"b"}, {i:"…ëÀê", t:"a"}, {t:"ll"}] },
        { img: "lips.jpg", speak: "lips", pre: "l", parts: [{t:"l"}, {i:"…™", t:"i"}, {t:"p"}, {t:"s"}] },
        { img: "lamp.jpg", speak: "lamp", pre: "l", parts: [{t:"l"}, {i:"√¶", t:"a"}, {t:"m"}, {t:"p"}] },
        { type: "sent", img: "sentence_rick.jpg", speak: "Rick is ready to read a good story for Sarah", parts: [{t:"R"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}, {t:" "}, {i:"…™", t:"i"}, {i:"z", t:"s"}, {t:" "}, {t:"r"}, {i:"e", t:"ea"}, {t:"d"}, {i:"i", t:"y"}, {t:" "}, {t:"t"}, {i:"uÀê", t:"o"}, {t:" "}, {t:"r"}, {i:"iÀê", t:"ea"}, {t:"d"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"g"}, {i:" ä", t:"oo"}, {t:"d"}, {t:" "}, {t:"s"}, {t:"t"}, {i:"…îÀêr", t:"or"}, {i:"i", t:"y"}, {t:" "}, {t:"f"}, {i:"…îÀêr", t:"or"}, {t:" "}, {t:"S"}, {i:"√¶", t:"a"}, {t:"r"}, {i:"…ô", t:"a"}, {i:"_", t:"h."}] },
        { type: "sent", img: "sentence_lily.jpg", speak: "Lily likes to look at her Mom smiling", parts: [{t:"L"}, {i:"…™", t:"i"}, {t:"l"}, {i:"i", t:"y"}, {t:" "}, {t:"l"}, {i:"a…™", t:"i"}, {t:"k"}, {i:"_", t:"e"}, {t:"s"}, {t:" "}, {t:"t"}, {i:"uÀê", t:"o"}, {t:" "}, {t:"l"}, {i:" ä", t:"oo"}, {t:"k"}, {t:" "}, {i:"√¶", t:"a"}, {t:"t"}, {t:" "}, {t:"h"}, {i:"…ôr", t:"er"}, {t:" "}, {t:"M"}, {i:"…ë", t:"o"}, {t:"m"}, {t:" "}, {t:"s"}, {t:"m"}, {i:"a…™", t:"i"}, {t:"l"}, {i:"…™ ≈ã", t:"ing."}] },
        { type: "game", title: "Game /r/", pairs: ["red", "run", "carrot", "ring", "rabbit"], img: "r_card.jpg" },
        { type: "game", title: "Game /l/", pairs: ["lion", "ladder", "ball", "lips", "lamp"], img: "l_card.jpg" }
    ],
    lesson23: [
        { img: "yellow.jpg", speak: "yellow", pre: "y", parts: [{i:"j", t:"y"}, {i:"e", t:"e"}, {t:"ll"}, {i:"o ä", t:"ow"}] },
        { img: "yoyo.jpg", speak: "yoyo", pre: "y", parts: [{i:"j", t:"y"}, {i:"o ä", t:"o"}, {i:"j", t:"y"}, {i:"o ä", t:"o"}] },
        { img: "yogurt.jpg", speak: "yogurt", pre: "y", parts: [{i:"j", t:"y"}, {i:"o ä", t:"o"}, {t:"g"}, {i:"…ôr", t:"ur"}, {t:"t"}] },
        { img: "yam.jpg", speak: "yam", pre: "y", parts: [{i:"j", t:"y"}, {i:"√¶", t:"a"}, {t:"m"}] },
        { img: "yak.jpg", speak: "yak", pre: "y", parts: [{i:"j", t:"y"}, {i:"√¶", t:"a"}, {t:"k"}] },
        { img: "web.jpg", speak: "web", pre: "w", parts: [{t:"w"}, {i:"e", t:"e"}, {t:"b"}] },
        { img: "wolf.jpg", speak: "wolf", pre: "w", parts: [{t:"w"}, {i:" ä", t:"o"}, {t:"l"}, {t:"f"}] },
        { img: "walk.jpg", speak: "walk", pre: "w", parts: [{t:"w"}, {i:"…ëÀê", t:"a"}, {i:"_", t:"l"}, {t:"k"}] },
        { img: "winter.jpg", speak: "winter", pre: "w", parts: [{t:"w"}, {i:"…™", t:"i"}, {t:"n"}, {t:"t"}, {i:"…ôr", t:"er"}] },
        { img: "water.jpg", speak: "water", pre: "w", parts: [{t:"w"}, {i:"…ëÀê", t:"a"}, {i:"tÃ¨", t:"t"}, {i:"…ôr", t:"er"}] },
        { type: "sent", img: "sentence_your.jpg", speak: "Your kindness makes you a young hero", parts: [{i:"J", t:"Y"}, {i:"…îÀêr", t:"our"}, {t:" "}, {t:"k"}, {i:"a…™", t:"i"}, {t:"n"}, {t:"d"}, {t:"n"}, {i:"…ô", t:"e"}, {t:"ss"}, {t:" "}, {t:"m"}, {i:"e…™", t:"a"}, {t:"k"}, {i:"_", t:"e"}, {t:"s"}, {t:" "}, {i:"j", t:"y"}, {i:"uÀê", t:"ou"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"j", t:"y"}, {i:" å ≈ã", t:"oung"}, {t:" "}, {t:"h"}, {i:"…™", t:"e"}, {t:"r"}, {i:"o ä", t:"o."}] },
        { type: "sent", img: "sentence_we.jpg", speak: "We work well to win the race", parts: [{t:"W"}, {i:"iÀê", t:"e"}, {t:" "}, {t:"w"}, {i:"…úÀêr", t:"or"}, {t:"k"}, {t:" "}, {t:"w"}, {i:"e", t:"e"}, {t:"ll"}, {t:" "}, {t:"t"}, {i:"uÀê", t:"o"}, {t:" "}, {t:"w"}, {i:"…™", t:"i"}, {t:"n"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"r"}, {i:"e…™", t:"a"}, {i:"s", t:"c"}, {i:"_", t:"e."}] },
        { type: "game", title: "Game /j/", pairs: ["yellow", "web", "yoyo", "wolf", "yogurt"], img: "j_card.jpg" },
        { type: "game", title: "Game /w/", pairs: ["web", "wolf", "walk", "winter", "water"], img: "w_card.jpg" }
    ],
    lesson24: [
        { img: "thin.jpg", speak: "thin", pre: "th", parts: [{i:"Œ∏", t:"th"}, {i:"…™", t:"i"}, {t:"n"}] },
        { img: "teeth.jpg", speak: "teeth", pre: "t", parts: [{t:"t"}, {i:"iÀê", t:"ee"}, {i:"Œ∏", t:"th"}] },
        { img: "thumb.jpg", speak: "thumb", pre: "th", parts: [{i:"Œ∏", t:"th"}, {i:" å", t:"u"}, {t:"m"}, {i:"_", t:"b"}] },
        { img: "earth.jpg", speak: "earth", pre: "th", parts: [{i:"…úÀêr", t:"ear"}, {i:"Œ∏", t:"th"}] },
        { img: "birthday.jpg", speak: "birthday", pre: "th", parts: [{t:"b"}, {i:"…úÀêr", t:"ir"}, {i:"Œ∏", t:"th"}, {t:"d"}, {i:"e…™", t:"ay"}] },
        { img: "father.jpg", speak: "father", pre: "dh", parts: [{t:"f"}, {i:"…ëÀê", t:"a"}, {i:"√∞", t:"th"}, {i:"…ôr", t:"er"}] },
        { img: "together.jpg", speak: "together", pre: "dh", parts: [{t:"t"}, {i:"…ô", t:"o"}, {t:"g"}, {i:"e", t:"e"}, {i:"√∞", t:"th"}, {i:"…ôr", t:"er"}] },
        { img: "clothing.jpg", speak: "clothing", pre: "dh", parts: [{i:"k", t:"c"}, {t:"l"}, {i:"o ä", t:"o"}, {i:"√∞", t:"th"}, {i:"…™ ≈ã", t:"ing"}] },
        { img: "feather.jpg", speak: "feather", pre: "dh", parts: [{t:"f"}, {i:"e", t:"ea"}, {i:"√∞", t:"th"}, {i:"…ôr", t:"er"}] },
        { img: "weather.jpg", speak: "weather", pre: "dh", parts: [{t:"w"}, {i:"e", t:"ea"}, {i:"√∞", t:"th"}, {i:"…ôr", t:"er"}] },
        { type: "sent", img: "sentence_think.jpg", speak: "Think good things and say thank you to have a happy heart", parts: [{i:"Œ∏", t:"Th"}, {i:"…™ ≈ã", t:"in"}, {t:"k"}, {t:" "}, {t:"g"}, {i:" ä", t:"oo"}, {t:"d"}, {t:" "}, {i:"Œ∏", t:"th"}, {i:"…™ ≈ã", t:"ing"}, {i:"z", t:"s"}, {t:" "}, {i:"√¶", t:"a"}, {t:"n"}, {t:"d"}, {t:" "}, {t:"s"}, {i:"e…™", t:"ay"}, {t:" "}, {i:"Œ∏", t:"th"}, {i:"√¶", t:"a"}, {i:"≈ã", t:"n"}, {t:"k"}, {t:" "}, {i:"j", t:"y"}, {i:"uÀê", t:"ou"}, {t:" "}, {t:"t"}, {i:"u:", t:"o"}, {t:" "}, {t:"h"}, {i:"√¶", t:"a"}, {t:"v"}, {i:"_", t:"e"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"h"}, {i:"√¶", t:"a"}, {t:"pp"}, {i:"i", t:"y"}, {t:" "}, {t:"h"}, {i:"…ëÀêr", t:"ear"}, {t:"t."}] },
        { type: "sent", img: "sentence_they.jpg", speak: "They help their mother with the dishes", parts: [{i:"√∞", t:"Th"}, {i:"e…™", t:"ey"}, {t:" "}, {t:"h"}, {i:"e", t:"e"}, {t:"l"}, {t:"p"}, {t:" "}, {i:"√∞", t:"th"}, {i:"e", t:"ei"}, {t:"r"}, {t:" "}, {t:"m"}, {i:" å", t:"o"}, {i:"√∞", t:"th"}, {i:"…ôr", t:"er"}, {t:" "}, {t:"w"}, {i:"…™", t:"i"}, {i:"√∞", t:"th"}, {t:" "}, {i:"√∞", t:"th"}, {i:"…ô", t:"e"}, {t:" "}, {t:"d"}, {i:"…™", t:"i"}, {i:" É", t:"sh"}, {i:"…™", t:"e"}, {i:"z", t:"s."}] },
        { type: "game", title: "Game /Œ∏/", pairs: ["thin", "father", "thumb", "feather", "teeth"], img: "Œ∏_card.jpg" },
        { type: "game", title: "Game /√∞/", pairs: ["father", "together", "clothing", "feather", "weather"], img: "√∞_card.jpg" }
    ],
    lesson25: [
        { img: "queen.jpg", speak: "queen", pre: "kw", parts: [{i:"k w", t:"qu"}, {i:"iÀê", t:"een"}] },
        { img: "question.jpg", speak: "question", pre: "kw", parts: [{i:"k w", t:"qu"}, {i:"e", t:"es"}, {i:"t É …ô", t:"tio"}, {t:"n"}] },
        { img: "quiet.jpg", speak: "quiet", pre: "kw", parts: [{i:"k w", t:"qu"}, {i:"a…™", t:"i"}, {i:"…ô", t:"e"}, {t:"t"}] },
        { img: "quail.jpg", speak: "quail", pre: "kw", parts: [{i:"k w", t:"qu"}, {i:"e…™", t:"ail"}] },
        { img: "quill.jpg", speak: "quill", pre: "kw", parts: [{i:"k w", t:"qu"}, {i:"…™", t:"i"}, {t:"ll"}] },
        { img: "axe.jpg", speak: "axe", pre: "ks", parts: [{i:"√¶", t:"a"}, {i:"k s", t:"x"}, {i:"_", t:"e"}] },
        { img: "taxi.jpg", speak: "taxi", pre: "ks", parts: [{t:"t"}, {i:"√¶", t:"a"}, {i:"k s", t:"x"}, {i:"i", t:"i"}] },
        { img: "six.jpg", speak: "six", pre: "ks", parts: [{t:"s"}, {i:"…™", t:"i"}, {i:"k s", t:"x"}] },
        { img: "box.jpg", speak: "box", pre: "ks", parts: [{t:"b"}, {i:"…ë", t:"o"}, {i:"k s", t:"x"}] },
        { img: "fox.jpg", speak: "fox", pre: "ks", parts: [{t:"f"}, {i:"…ë", t:"o"}, {i:"k s", t:"x"}] },
        { type: "sent", img: "sentence_quiet.jpg", speak: "Be quiet and ask a quick question to learn", parts: [{t:"B"}, {i:"i:", t:"e"}, {t:" "}, {i:"k w", t:"qu"}, {i:"a…™", t:"i"}, {i:"…ô", t:"e"}, {t:"t"}, {t:" "}, {i:"√¶", t:"a"}, {t:"n"}, {t:"d"}, {t:" "}, {i:"√¶", t:"a"}, {t:"s"}, {t:"k"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {i:"k w", t:"qu"}, {i:"…™", t:"i"}, {i:"k", t:"ck"}, {t:" "}, {i:"k w", t:"qu"}, {i:"e", t:"es"}, {i:"t É …ô", t:"tio"}, {t:"n"}, {t:" "}, {t:"t"}, {i:"u:", t:"o"}, {t:" "}, {t:"l"}, {i:"…úÀêr", t:"ear"}, {t:"n."}] },
        { type: "sent", img: "sentence_six.jpg", speak: "Six kids and one fox relax around a box of toys", parts: [{t:"S"}, {i:"…™", t:"i"}, {i:"k s", t:"x"}, {t:" "}, {t:"k"}, {i:"…™", t:"i"}, {t:"d"}, {i:"z", t:"s"}, {t:" "}, {i:"√¶", t:"a"}, {t:"n"}, {t:"d"}, {t:" "}, {i:"w  å n", t:"one"}, {t:" "}, {t:"f"}, {i:"…ë", t:"o"}, {i:"k s", t:"x"}, {t:" "}, {t:"r"}, {i:"…™", t:"e"}, {t:"l"}, {i:"√¶", t:"a"}, {i:"k s", t:"x"}, {t:" "}, {i:"…ô", t:"a"}, {t:"r"}, {i:"a ä", t:"ou"}, {t:"n"}, {t:"d"}, {t:" "}, {i:"…ô", t:"a"}, {t:" "}, {t:"b"}, {i:"…ë", t:"o"}, {i:"k s", t:"x"}, {t:" "}, {i:" å", t:"o"}, {t:"f"}, {t:" "}, {t:"t"}, {i:"…î…™", t:"oy"}, {i:"z", t:"s."}] },
        { type: "game", title: "Game /kw/", pairs: ["queen", "question", "quiet", "quail", "quill"], img: "kw_card.jpg" },
        { type: "game", title: "Game /ks/", pairs: ["axe", "taxi", "six", "box", "fox"], img: "ks_card.jpg" }
    ],

    getLesson: function(num) {
        if(this["lesson" + num]) return this["lesson" + num];
        return [];
    }
};
/* --- D·ªÆ LI·ªÜU B·∫¢NG IPA (M·ªöI) --- */
const IPA_DATA = {
    "Single Vowels": [
        "sound_i", "sound_ii", "sound_u", 
        "sound_uu", "sound_e", "sound_schwa", 
        "sound_ae", "sound_uh", "sound_aa"
    ],
    "Double Vowels": [
        "sound_ei", "sound_oi", "sound_ai", "sound_ou", "sound_au"
    ],
    "R-controlled Vowels": [
        "sound_ur", "sound_or", "sound_ar", "sound_ir", "sound_er"
    ],
    "Unvoiced Consonants": [
        "sound_p", "sound_f", "sound_th", 
        "sound_t", "sound_s", "sound_sh", 
        "sound_ch", "sound_k", "sound_h", "sound_ks"
    ],
    "Voiced Consonants": [
        "sound_b", "sound_v", "sound_dh", 
        "sound_d", "sound_z", "sound_zh", 
        "sound_j", "sound_g", "sound_m", 
        "sound_n", "sound_ng", "sound_w", 
        "sound_l", "sound_r", "sound_y", 
        "sound_kw", "sound_flapt"
    ]
};

    // --- H√ÄM T·∫†O ƒê·ªÄ THI NG·∫™U NHI√äN (40 C√ÇU) ---
    getMockTest: function() {
        let testSet = [];
        
        // 1. L·∫•y 10 h√¨nh IPA ng·∫´u nhi√™n
        let allIPAs = [];
        for (const key in IPA_DATA) {
            IPA_DATA[key].forEach(sound => {
                // T·∫°o object c√¢u h·ªèi IPA: Ch·ªâ c√≥ h√¨nh (img) v√† √¢m thanh (speak=wav file)
                allIPAs.push({ 
                    type: 'exam-ipa', 
                    img: sound + ".jpg", 
                    speak: sound + ".wav", // Khi check s·∫Ω ph√°t file n√†y
                    text: "" // Kh√¥ng hi·ªán ch·ªØ
                });
            });
        }
        allIPAs.sort(() => 0.5 - Math.random());
        testSet = testSet.concat(allIPAs.slice(0, 10));

        // 2. L·∫•y 25 t·ª´ ng·∫´u nhi√™n (c√≥ h√¨nh + ch·ªØ + ipa ƒë·ªè)
        let allWords = [];
        for (let i=1; i<=25; i++) {
            let lesson = this["lesson"+i];
            if(lesson) {
                // L·ªçc ra c√°c item l√† t·ª´ (c√≥ img, kh√¥ng ph·∫£i game, kh√¥ng ph·∫£i sent)
                let words = lesson.filter(item => item.img && item.type !== 'game' && item.type !== 'sent');
                allWords = allWords.concat(words);
            }
        }
        allWords.sort(() => 0.5 - Math.random());
        testSet = testSet.concat(allWords.slice(0, 25));

        // 3. L·∫•y 5 c√¢u ng·∫´u nhi√™n
        let allSents = [];
        for (let i=1; i<=25; i++) {
            let lesson = this["lesson"+i];
            if(lesson) {
                let sents = lesson.filter(item => item.type === 'sent');
                allSents = allSents.concat(sents);
            }
        }
        allSents.sort(() => 0.5 - Math.random());
        testSet = testSet.concat(allSents.slice(0, 5));

        return testSet;
    },

    getLesson: function(num) {
        if (num === 26) return this.getMockTest(); // N·∫øu l√† b√†i 26 -> T·∫°o ƒë·ªÅ thi
        if(this["lesson" + num]) return this["lesson" + num];
        return [];
    }
};

const IPA_DATA = {
    "Single Vowels": ["sound_i", "sound_ii", "sound_u", "sound_uu", "sound_e", "sound_schwa", "sound_ae", "sound_uh", "sound_aa"],
    "Double Vowels": ["sound_ei", "sound_oi", "sound_ai", "sound_ou", "sound_au"],
    "R-controlled Vowels": ["sound_ur", "sound_or", "sound_ar", "sound_ir", "sound_er"],
    "Unvoiced Consonants": ["sound_p", "sound_f", "sound_th", "sound_t", "sound_s", "sound_sh", "sound_ch", "sound_k", "sound_h", "sound_ks"],
    "Voiced Consonants": ["sound_b", "sound_v", "sound_dh", "sound_d", "sound_z", "sound_zh", "sound_j", "sound_g", "sound_m", "sound_n", "sound_ng", "sound_w", "sound_l", "sound_r", "sound_y", "sound_kw", "sound_flapt"]
};
/* ==========================================================================
   PH·∫¶N 3: LOGIC ENGINES
   ========================================================================== */
const AudioEngine = {
    isAudioAllowed: false, audioWin: new Audio("win.mp3"), audioCorrect: new Audio("correct.mp3"), audioWrong: new Audio("wrong.mp3"), currentUtterance: null,
    unlock: function() { this.isAudioAllowed = true; if ('speechSynthesis' in window) { const u = new SpeechSynthesisUtterance(''); window.speechSynthesis.speak(u); window.speechSynthesis.cancel(); } },
    stopAllAndBlock: function() { this.isAudioAllowed = false; window.speechSynthesis.cancel(); this.audioWin.pause(); this.audioWin.currentTime = 0; this.audioCorrect.pause(); this.audioCorrect.currentTime = 0; this.audioWrong.pause(); this.audioWrong.currentTime = 0; },
    stopCurrentSound: function() { window.speechSynthesis.cancel(); },
    playTTS: function(text) { if (!this.isAudioAllowed) return; this.stopCurrentSound(); if ('speechSynthesis' in window) { window.currentUtterance = new SpeechSynthesisUtterance(text); window.currentUtterance.lang = 'en-US'; window.currentUtterance.rate = 0.9; window.speechSynthesis.speak(window.currentUtterance); } },
    playSequence: function(soundFile, textToRead) {
        if (!this.isAudioAllowed) return; this.stopCurrentSound(); const audio = new Audio(soundFile);
        audio.onended = () => { if (textToRead) setTimeout(() => { this.playTTS(textToRead); }, 300); };
        audio.onerror = () => { if (textToRead) this.playTTS(textToRead); };
        audio.play().catch(e => { if (textToRead) this.playTTS(textToRead); });
    },
    playEffect: function(type) { if (!this.isAudioAllowed) return; if (type === 'correct') this.audioCorrect.play().catch(e=>{}); if (type === 'wrong') this.audioWrong.play().catch(e=>{}); if (type === 'win') this.audioWin.play().catch(e=>{}); }
};

// ... (Gi·ªØ nguy√™n GameEngine v√† SnakeEngine c≈©) ...
/* --- 3.3 GAME ENGINE (WHACK-A-MOLE & FLIP) --- */
const GameEngine = {
    active: false, moleLoop: null, moleAudioLoop: null, hammerTimeout: null, timerInt: null, 
    score: 0, sec: 0, moles: [], moleRemainingWords: [], moleTarget: null,
    currentConfig: null, currentDataPool: [],
    
    WINNING_SCORE: 1000, 

    start: function(config, dataPool) {
        this.currentConfig = config; this.currentDataPool = dataPool;
        if (config.gameType === 'snake') { SnakeEngine.start(config, dataPool); return; }
        if (config.gameType === 'mole') { this.startMoleGame(); return; } 
        // M·∫∑c ƒë·ªãnh l√† FLIP
        this.startFlipGame();
    },
    restart: function() { if(this.currentConfig) this.start(this.currentConfig, this.currentDataPool); },
    stop: function() {
        this.active = false; clearInterval(this.moleAudioLoop); clearTimeout(this.moleLoop); clearInterval(this.timerInt); clearTimeout(this.hammerTimeout);
        const allMoles = document.querySelectorAll('.mole'); allMoles.forEach(m => m.classList.remove('up', 'bonked'));
        const hammer = document.getElementById('cursor-hammer'); if(hammer) hammer.classList.remove('active');
        SnakeEngine.stop();
    },
    // MOLE Logic
    startMoleGame: function() {
        this.stop(); this.active = true; this.score = 0; this.sec = 0; this.updateScore(0);
        this.moles = document.querySelectorAll('.mole');
        document.getElementById('tower').style.display = 'none'; document.getElementById('whack-wrapper').style.display = 'flex'; document.getElementById('win-modal').style.display = 'none'; document.getElementById('snake-game-container').style.display = 'none';
        this.refillMoleWords();
        if(this.moleRemainingWords.length === 0) return alert("Kh√¥ng c√≥ d·ªØ li·ªáu t·ª´ v·ª±ng!");
        this.startTimer(); this.nextMoleRound();
    },
    refillMoleWords: function() { const targetPhoneme = this.currentConfig.phoneme; this.moleRemainingWords = this.currentDataPool.filter(w => w.parts && w.parts.some(p => p.i && p.i.includes(targetPhoneme))).sort(() => 0.5 - Math.random()); },
    nextMoleRound: function() {
        if (!this.active) return;
        if (this.score >= this.WINNING_SCORE) { this.win(); return; }
        if (this.moleRemainingWords.length === 0) { this.refillMoleWords(); }
        this.moleTarget = this.moleRemainingWords.pop();
        let html = ''; this.moleTarget.parts.forEach(p => { const ipaHtml = p.i ? p.i : "&nbsp;"; html += `<div class="target-char"><div class="target-ipa">${ipaHtml}</div><div class="target-txt">${p.t}</div></div>`; });
        document.getElementById('target-word-container').innerHTML = html;
        AudioEngine.playTTS(this.moleTarget.speak); clearInterval(this.moleAudioLoop);
        this.moleAudioLoop = setInterval(() => { if(this.active) AudioEngine.playTTS(this.moleTarget.speak); }, 2000);
        this.peep();
    },
    peep: function() {
        if (!this.active) return;
        let speed = Math.max(600, 1500 - (this.score * 0.8)); const time = speed + Math.random() * 400; 
        const hole = this.moles[Math.floor(Math.random() * this.moles.length)];
        let isTarget = Math.random() < 0.4; let moleImgData = isTarget ? this.moleTarget : this.currentDataPool[Math.floor(Math.random() * this.currentDataPool.length)];
        const imgEl = hole.querySelector('img'); imgEl.src = moleImgData.img; hole.dataset.speak = moleImgData.speak;
        hole.classList.add('up');
        this.moleLoop = setTimeout(() => { hole.classList.remove('up'); if (this.active) this.peep(); }, time);
    },
    bonk: function(moleEl, event) {
        if(!moleEl.classList.contains('up') || !this.active) return;
        let touchX = event.clientX || event.pageX; let touchY = event.clientY || event.pageY; this.spawnHammer(touchX, touchY);
        const clickedWord = moleEl.dataset.speak;
        if (clickedWord === this.moleTarget.speak) { AudioEngine.playEffect('correct'); moleEl.classList.add('bonked'); this.updateScore(100); this.showFloatingText(touchX, touchY, "+100", "yellow"); setTimeout(() => { moleEl.classList.remove('up', 'bonked'); clearTimeout(this.moleLoop); this.nextMoleRound(); }, 300); }
        else { AudioEngine.playEffect('wrong'); moleEl.classList.remove('up'); this.updateScore(-50); this.showFloatingText(touchX, touchY, "-50", "red"); }
    },
    spawnHammer: function(x, y) { const hammer = document.getElementById('cursor-hammer'); hammer.style.left = (x - 60) + 'px'; hammer.style.top = (y - 70) + 'px'; hammer.classList.remove('active'); void hammer.offsetWidth; hammer.classList.add('active'); clearTimeout(this.hammerTimeout); this.hammerTimeout = setTimeout(() => { hammer.classList.remove('active'); }, 150); },
    // FLIP Logic
    startFlipGame: function() {
        this.stop(); this.active = true; this.sec = 0; this.matches = 0;
        document.getElementById('tower').style.display = 'flex'; document.getElementById('whack-wrapper').style.display = 'none'; document.getElementById('win-modal').style.display = 'none'; document.getElementById('snake-game-container').style.display = 'none';
        const tower = document.getElementById('tower'); tower.innerHTML = '';
        let cards = [];
        
        // L·ªåC T·ª™ THEO DANH S√ÅCH PAIRS C·ª¶A GAME HI·ªÜN T·∫†I
        const validWords = this.currentConfig.pairs;
        
        validWords.forEach(key => {
            let original = this.currentDataPool.find(d => { 
                if(d.type === 'game' || d.type === 'sent') return false; 
                let fullWord = d.parts.map(p => p.t).join(""); 
                return fullWord === key; 
            });
            if(original) { 
                cards.push({ id: key, type: 'img', content: `<img src="${original.img}">`, speak: original.speak }); 
                
                // T·∫†O HTML TEXT V·ªöI C·∫§U TR√öC M·ªöI (Fix l·ªói xu·ªëng d√≤ng)
                let htmlText = `<div class="game-card-text">`; 
                original.parts.forEach(p => { 
                    htmlText += `<div class="gc-block"><div class="gc-ipa">${p.i || "&nbsp;"}</div><div class="gc-word">${p.t}</div></div>`; 
                }); 
                htmlText += `</div>`; 
                
                cards.push({ id: key, type: 'text', content: htmlText, speak: original.speak }); 
            }
        });
        
        cards.sort(() => 0.5 - Math.random());
        let cCount = 0; let num = 1; const rows = [3, 2, 3, 2];
        rows.forEach(cnt => {
            const rowDiv = document.createElement('div'); rowDiv.className = 'tower-row';
            for(let k=0; k<cnt; k++) {
                if(cCount >= cards.length) break; // Ch·ªâ l·∫•y ƒë·ªß s·ªë th·∫ª
                const c = cards[cCount]; const el = document.createElement('div'); el.className = 'card-flip'; el.dataset.speak = c.speak; el.dataset.id = c.id;
                el.innerHTML = `<div class="card-inner"><div class="face front">${num}</div><div class="face back">${c.content}</div></div>`;
                el.onclick = function() { GameEngine.cardClick(this); }; rowDiv.appendChild(el); cCount++; num++;
            }
            tower.appendChild(rowDiv);
        });
        this.startTimer();
    },
    cardClick: function(el) {
        if(el.classList.contains('flipped') || el.classList.contains('matched')) return;
        el.classList.add('flipped'); AudioEngine.playTTS(el.dataset.speak);
        if(!this.c1) { this.c1 = el; } else { this.c2 = el;
            if(this.c1.dataset.id === this.c2.dataset.id) { setTimeout(() => { this.c1.classList.add('matched'); this.c2.classList.add('matched'); this.c1 = null; this.c2 = null; this.matches++; AudioEngine.playEffect('correct'); if(this.matches === 5) this.win(); }, 600); }
            else { setTimeout(() => { this.c1.classList.remove('flipped'); this.c2.classList.remove('flipped'); this.c1 = null; this.c2 = null; AudioEngine.playEffect('wrong'); }, 1000); }
        }
    },
    startTimer: function() { clearInterval(this.timerInt); document.getElementById('timer').innerText = "00:00"; this.timerInt = setInterval(() => { this.sec++; let m=Math.floor(this.sec/60).toString().padStart(2,'0'); let s=(this.sec%60).toString().padStart(2,'0'); document.getElementById('timer').innerText = `${m}:${s}`; }, 1000); },
    updateScore: function(val) { this.score += val; if(this.score < 0) this.score = 0; document.getElementById('score-display').innerText = this.score; },
    showFloatingText: function(x, y, text, color) { const el = document.createElement('div'); el.className = 'floating-text'; el.innerText = text; el.style.left = x + 'px'; el.style.top = y + 'px'; el.style.color = color; document.body.appendChild(el); setTimeout(() => el.remove(), 800); },
    win: function() { this.stop(); AudioEngine.playEffect('win'); AudioEngine.playTTS("Excellent job!"); document.getElementById('win-msg').innerText = "Th·ªùi gian: " + document.getElementById('timer').innerText; document.getElementById('final-score').innerText = this.score; document.getElementById('win-modal').style.display = 'flex'; }
};

const SnakeEngine = {
    active: false, paused: false, gameLoopId: null, audioLoopId: null, boardSize: 15, snake: [], direction: {x: 0, y: 0}, nextDirection: {x: 0, y: 0}, 
    foods: [], score: 0, speed: 300, targetPhoneme: "", currentTargetWord: null, poolCorrect: [], poolWrong: [],
    lives: 3,

    start: function(config, dataPool) {
        this.stop(); this.active = true; this.paused = false; this.score = 0; this.speed = 550; this.lives = 3; this.targetPhoneme = config.phoneme;
        this.poolCorrect = dataPool.filter(w => w.parts && w.parts.some(p => p.i && p.i.includes(this.targetPhoneme)));
        this.poolWrong = dataPool.filter(w => !w.parts || !w.parts.some(p => p.i && p.i.includes(this.targetPhoneme)));
        if (this.poolCorrect.length === 0) return alert("Thi·∫øu d·ªØ li·ªáu √¢m /" + this.targetPhoneme + "/");

        document.getElementById('tower').style.display = 'none'; document.getElementById('whack-wrapper').style.display = 'none'; document.getElementById('snake-game-container').style.display = 'flex'; document.getElementById('win-modal').style.display = 'none'; document.getElementById('pause-modal').style.display = 'none'; document.getElementById('snake-score').innerText = this.score;
        this.updateLivesUI();
        
        const center = Math.floor(this.boardSize / 2);
        this.snake = [{x: center, y: center}, {x: center, y: center + 1}, {x: center, y: center + 2}];
        this.direction = {x: 0, y: -1}; this.nextDirection = {x: 0, y: -1};
        this.createBoard(); this.spawnFoods(); this.gameLoop(); this.startAudioLoop();
    },
    stop: function() { this.active = false; clearTimeout(this.gameLoopId); clearInterval(this.audioLoopId); },
    togglePause: function() { if (!this.active) return; this.paused = !this.paused; const modal = document.getElementById('pause-modal'); if (this.paused) { modal.style.display = 'flex'; clearInterval(this.audioLoopId); } else { modal.style.display = 'none'; this.gameLoop(); this.startAudioLoop(); } },
    startAudioLoop: function() { clearInterval(this.audioLoopId); if(this.currentTargetWord) AudioEngine.playTTS(this.currentTargetWord.speak); this.audioLoopId = setInterval(() => { if (this.active && !this.paused && this.currentTargetWord) { AudioEngine.playTTS(this.currentTargetWord.speak); } }, 4000); },
    createBoard: function() { const board = document.getElementById('snake-board'); board.innerHTML = ''; board.style.gridTemplateColumns = `repeat(${this.boardSize}, 1fr)`; board.style.gridTemplateRows = `repeat(${this.boardSize}, 1fr)`; for(let i=0; i < this.boardSize * this.boardSize; i++) { const cell = document.createElement('div'); cell.className = 'grid-cell'; board.appendChild(cell); } },
    updateLivesUI: function() {
        let hearts = "";
        for(let i=0; i<this.lives; i++) hearts += "‚ù§Ô∏è";
        for(let i=this.lives; i<3; i++) hearts += "üñ§";
        document.getElementById('snake-lives').innerText = hearts;
    },
    handleDeath: function(msg) {
        this.lives--;
        this.updateLivesUI();
        AudioEngine.playEffect('wrong');
        
        if (this.lives <= 0) {
            this.showGameOver(msg + " H·∫øt m·∫°ng r·ªìi!");
        } else {
            const center = Math.floor(this.boardSize / 2);
            this.snake = [{x: center, y: center}, {x: center, y: center + 1}, {x: center, y: center + 2}];
            this.direction = {x: 0, y: -1}; this.nextDirection = {x: 0, y: -1};
        }
    },
    gameLoop: function() {
        if (!this.active || this.paused) return;
        this.direction = this.nextDirection;
        const head = { ...this.snake[0] }; head.x += this.direction.x; head.y += this.direction.y;
        if (this.isCollision(head)) { 
            this.handleDeath("R·∫Øn ƒë·ª•ng t∆∞·ªùng!"); 
            if(this.lives > 0) { this.draw(); this.gameLoopId = setTimeout(() => { if(this.active) this.gameLoop(); }, this.speed); return; }
            else return;
        }
        this.snake.unshift(head);
        let ate = false;
        const foodIndex = this.foods.findIndex(f => f.x === head.x && f.y === head.y);
        if (foodIndex !== -1) {
            const food = this.foods[foodIndex];
            if (food.isCorrect) {
                ate = true; this.score += 10; document.getElementById('snake-score').innerText = this.score;
                AudioEngine.playEffect('correct'); 
                if (this.speed > 150) this.speed -= 20; 
                
                this.foods.splice(foodIndex, 1); this.spawnFoods(); this.startAudioLoop();
                if (this.score >= 100) { this.win(); return; }
            } else { 
                this.handleDeath(`Sai r·ªìi! "${food.word}" kh√¥ng ph·∫£i t·ª´ c·∫ßn t√¨m!`);
                if(this.lives > 0) {
                     this.foods.splice(foodIndex, 1);
                     this.snake.pop(); 
                     this.draw();
                     this.gameLoopId = setTimeout(() => { if(this.active) this.gameLoop(); }, this.speed); 
                     return;
                } else return;
            }
        }
        if (!ate) this.snake.pop();
        this.draw();
        this.gameLoopId = setTimeout(() => { if(this.active) this.gameLoop(); }, this.speed);
    },
    isCollision: function(pos) { if (pos.x < 0 || pos.x >= this.boardSize || pos.y < 0 || pos.y >= this.boardSize) return true; for (let i = 1; i < this.snake.length; i++) if (pos.x === this.snake[i].x && pos.y === this.snake[i].y) return true; return false; },
    spawnFoods: function() {
        this.foods = [];
        const correctWord = this.poolCorrect[Math.floor(Math.random() * this.poolCorrect.length)];
        this.currentTargetWord = correctWord; 
        
        const validWrongPool = this.poolWrong.filter(w => !w.img.includes("card.jpg"));
        const wrongWords = validWrongPool.sort(() => 0.5 - Math.random()).slice(0, 2); 
        
        const itemsToSpawn = [{ ...correctWord, isCorrect: true, icon: 'üçé' }, { ...wrongWords[0], isCorrect: false, icon: 'üçÑ' }];
        if (wrongWords[1]) itemsToSpawn.push({ ...wrongWords[1], isCorrect: false, icon: 'üí£' });
        itemsToSpawn.forEach(item => {
            let pos; do { 
                pos = { x: Math.floor(Math.random() * (this.boardSize - 2)) + 1, y: Math.floor(Math.random() * (this.boardSize - 2)) + 1 }; 
                
                // --- LOGIC TR√ÅNH V√ôNG N√öT B·∫§M (SAFE ZONE) ---
                let isSafeZone = (pos.y >= 11 && pos.x >= 4 && pos.x <= 10);
                if (isSafeZone) continue; 
                
                let isTooClose = this.foods.some(f => Math.abs(f.x - pos.x) <= 1 && Math.abs(f.y - pos.y) <= 1);
                if (isTooClose) continue; 
                
            } while (this.isOccupied(pos) || this.foods.some(f => Math.abs(f.x - pos.x) <= 1 && Math.abs(f.y - pos.y) <= 1));
            
            this.foods.push({ x: pos.x, y: pos.y, img: item.img, word: item.speak, isCorrect: item.isCorrect, icon: item.icon });
        });
        
        // --- S·ª¨A ƒê·ªîI VERSION 1.1: ·∫®n phi√™n √¢m n·∫øu l√† C√ÇU ---
        let ipaHtml = "";
        // N·∫øu kh√¥ng ph·∫£i lo·∫°i 'sent' (c√¢u) V√Ä ƒë·ªô d√†i t·ª´ < 2 (t·ª©c l√† t·ª´ ƒë∆°n) th√¨ m·ªõi hi·ªán IPA
        if (correctWord.type !== 'sent' && correctWord.speak.split(' ').length < 2) {
             let ipaStr = "";
             if (correctWord.parts) { ipaStr = correctWord.parts.map(p => p.i).join("").replace(/&nbsp;/g, ""); }
             ipaHtml = `<div style="color:red; font-size:14px;">/${ipaStr}/</div>`;
        }
        
        let fontSize = (correctWord.type === 'sent') ? '18px' : '24px';
        
        document.getElementById('snake-target-content').innerHTML = 
            `${ipaHtml}<div style="color:#d35400; font-size:${fontSize}; font-weight:900;">${correctWord.speak}</div>`;
    },
    isOccupied: function(pos) { if (this.snake.some(s => s.x === pos.x && s.y === pos.y)) return true; if (this.foods.some(f => f.x === pos.x && f.y === pos.y)) return true; const head = this.snake[0]; if (Math.abs(pos.x - head.x) < 3 && Math.abs(pos.y - head.y) < 3) return true; return false; },
    draw: function() {
        const cells = document.querySelectorAll('.grid-cell'); cells.forEach(c => { c.className = 'grid-cell'; c.innerHTML = ''; });
        this.foods.forEach(f => {
            const idx = f.y * this.boardSize + f.x;
            if (cells[idx]) { 
                const zIndex = 10; 
                cells[idx].innerHTML = `<div class="food-item" style="z-index:${zIndex}"><img class="food-img" src="${f.img}" onerror="this.style.display='none'"><div class="food-core">${f.icon}</div></div>`; 
            }
        });
        this.snake.forEach((part, index) => {
            const idx = part.y * this.boardSize + part.x;
            if (cells[idx]) {
                const div = document.createElement('div'); div.classList.add('snake-part');
                if (index === 0) {
                    div.classList.add('snake-head');
                    if (this.direction.y === -1) div.classList.add('head-down'); else if (this.direction.y === 1) div.classList.add('head-up'); else if (this.direction.x === -1) div.classList.add('head-left'); else if (this.direction.x === 1) div.classList.add('head-right');
                }
                cells[idx].appendChild(div);
            }
        });
    },
    changeDirection: function(newDirName) {
        if (this.paused) return; 
        let newDir = {x:0, y:0};
        if (newDirName === 'up') newDir = {x: 0, y: -1}; if (newDirName === 'down') newDir = {x: 0, y: 1};
        if (newDirName === 'left') newDir = {x: -1, y: 0}; if (newDirName === 'right') newDir = {x: 1, y: 0};
        if (this.direction.x + newDir.x === 0 && this.direction.y + newDir.y === 0) return;
        this.nextDirection = newDir;
    },
    showGameOver: function(msg) { this.stop(); AudioEngine.playTTS("Game Over!"); document.getElementById('win-msg').innerText = msg; document.getElementById('final-score').innerText = this.score; document.getElementById('win-modal').style.display = 'flex'; },
    win: function() { this.stop(); AudioEngine.playEffect('win'); AudioEngine.playTTS("You Win!"); document.getElementById('win-msg').innerText = "Tuy·ªát v·ªùi!"; document.getElementById('final-score').innerText = this.score; document.getElementById('win-modal').style.display = 'flex'; }
};
const LearningEngine = {
    currentData: [], idx: 0, currentLessonId: 0, // Th√™m bi·∫øn theo d√µi ID b√†i h·ªçc
    initLesson: function(lessonNum) { 
        this.currentLessonId = lessonNum;
        this.currentData = DataEngine.getLesson(lessonNum); 
        this.idx = 0; this.preload(); 
    },
    preload: function() { this.currentData.forEach(item => { if(item.img) new Image().src = item.img; }); },
    
    render: function() {
        const item = this.currentData[this.idx]; if(!item) return; AudioEngine.stopCurrentSound();
        document.getElementById('game-screen').style.display = 'none'; document.getElementById('learning-screen').style.display = 'flex'; document.getElementById('win-modal').style.display = 'none'; 
        
        // Reset UI
        document.getElementById('stars').style.display = (this.currentLessonId === 26) ? 'none' : 'block'; // ·∫®n sao khi thi
        document.getElementById('feedback').innerText = (this.currentLessonId === 26) ? `C√¢u ${this.idx + 1} / 40` : "...";
        const imgEl = document.getElementById('learn-img'); const btnContainer = document.getElementById('action-container'); const infoDisplay = document.getElementById('info-display');
        
        // --- X·ª¨ L√ù HI·ªÇN TH·ªä (LEARN vs EXAM) ---
        if(item.type === 'game') {
            // ... (Logic game c≈©) ...
        } 
        else if (item.type === 'exam-ipa') {
            // Hi·ªÉn th·ªã cho c√¢u h·ªèi IPA (ch·ªâ c√≥ h√¨nh to)
            imgEl.src = item.img;
            infoDisplay.innerHTML = ""; // Kh√¥ng c√≥ ch·ªØ d∆∞·ªõi
            this.renderExamButtons(btnContainer);
        }
        else {
            // Hi·ªÉn th·ªã t·ª´/c√¢u (Word/Sentence)
            imgEl.src = item.img;
            
            // Render ch·ªØ (Word Grouping Logic)
            let html = '';
            let currentWordBuffer = [];
            if(item.parts) {
                item.parts.forEach((p, index) => {
                    if (p.t === " ") {
                        if (currentWordBuffer.length > 0) {
                            html += `<div class="word-group">`;
                            currentWordBuffer.forEach(subP => {
                                const ipaHtml = subP.i || "&nbsp;";
                                html += `<div class="char-block"><div class="${(item.type === 'sent') ? 'sent-ipa' : 'cb-ipa'}">${ipaHtml}</div><div class="${(item.type === 'sent') ? 'sent-text' : 'cb-text'}">${subP.t}</div></div>`;
                            });
                            html += `</div>`;
                            currentWordBuffer = [];
                        }
                    } else { currentWordBuffer.push(p); }
                });
                if (currentWordBuffer.length > 0) {
                    html += `<div class="word-group">`;
                    currentWordBuffer.forEach(subP => {
                        const ipaHtml = subP.i || "&nbsp;";
                        html += `<div class="char-block"><div class="${(item.type === 'sent') ? 'sent-ipa' : 'cb-ipa'}">${ipaHtml}</div><div class="${(item.type === 'sent') ? 'sent-text' : 'cb-text'}">${subP.t}</div></div>`;
                    });
                    html += `</div>`;
                }
            }
            infoDisplay.innerHTML = html;

            // Render Buttons
            if (this.currentLessonId === 26) {
                this.renderExamButtons(btnContainer);
            } else {
                btnContainer.innerHTML = ` <button class="btn-action btn-mic" id="mic-btn" onclick="LearningEngine.startListening()"> üé§ ƒê·ªçc Ngay</button> <button class="btn-action btn-listen" id="btn-replay" onclick="LearningEngine.onUserClickSpeak()"> üîä Nghe L·∫°i</button> `;
            }
        }
        
        // ·∫®n hi·ªán n√∫t Nav hai b√™n
        if(this.currentLessonId === 26) {
             document.querySelector('.nav-row').style.display = 'none'; // ·∫®n nav c≈© khi thi
        } else {
             document.querySelector('.nav-row').style.display = 'flex';
        }
    },

    renderExamButtons: function(container) {
        // N√∫t Ki·ªÉm Tra & C√¢u Ti·∫øp
        container.innerHTML = `
            <button class="btn-action btn-check" onclick="LearningEngine.checkExamAnswer()"> ‚úÖ Ki·ªÉm tra</button>
            <button class="btn-action btn-next" onclick="LearningEngine.nextExamQuestion()"> ‚û° C√¢u Ti·∫øp</button>
        `;
    },

    checkExamAnswer: function() {
        // Ph√°t √¢m thanh ƒë√∫ng
        const item = this.currentData[this.idx];
        if (item.type === 'exam-ipa') {
            // Ch·ªâ ph√°t file wav
            const audio = new Audio(item.speak);
            audio.play();
        } else {
            // D√πng logic ph√°t √¢m chu·∫©n (pre + speak)
            this.onUserClickSpeak();
        }
    },

    nextExamQuestion: function() {
        if (this.idx < this.currentData.length - 1) {
            this.idx++;
            this.render();
        } else {
            alert("Ch√∫c m·ª´ng con ƒë√£ ho√†n th√†nh b√†i thi! üéâ");
            App.goHome();
        }
    },

    nav: function(d) { if(this.idx + d >= 0 && this.idx + d < this.currentData.length) { this.idx += d; this.render(); } }, nextItem: function() { this.nav(1); },
    onUserClickSpeak: function() { 
        const item = this.currentData[this.idx]; 
        if(item) { 
            let soundFile = null;
            let textToRead = item.speak; 
            if(item.pre && item.type !== 'sent') { soundFile = "sound_" + item.pre + ".wav"; }
            
            // X·ª≠ l√Ω ri√™ng cho B√†i thi IPA
            if(item.type === 'exam-ipa') { soundFile = item.speak; textToRead = null; }

            if (soundFile) { AudioEngine.playSequence(soundFile, textToRead); } 
            else { AudioEngine.playTTS(textToRead); }
        } 
    },
startListening: function() { const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition; if (!SpeechRecognition) return alert("Thi·∫øt b·ªã kh√¥ng h·ªó tr·ª£ thu √¢m"); const btn = document.getElementById('mic-btn'); btn.disabled = true; btn.innerText = "  üëÇ   ƒêang nghe..."; btn.style.backgroundColor = "#e74c3c"; const recognition = new SpeechRecognition(); recognition.lang = 'en-US'; recognition.start(); recognition.onresult = (e) => { let heard = []; for(let i=0; i<e.results[0].length; i++) heard.push(e.results[0][i].transcript.toLowerCase()); this.checkResult(heard); }; recognition.onerror = () => { this.resetMic(); }; recognition.onend = () => { if(btn.disabled) this.resetMic(); }; },
    resetMic: function() { const btn = document.getElementById('mic-btn'); if(btn) { btn.disabled = false; btn.innerText = "  üé§   ƒê·ªçc Ngay"; btn.style.backgroundColor = "#27ae60"; } },
    
    checkResult: function(heardArray) { 
        const item = this.currentData[this.idx]; 
        const targetRaw = item.speak.toLowerCase().replace(/[.,!?]/g, "").trim(); 
        let validAnswers = [targetRaw]; 
        if (item.pre) { 
            // Ch·∫•p nh·∫≠n c·∫£ c√°ch ƒë·ªçc k√®m √¢m ƒë·ªám (d√π b√© kh√≥ ƒë·ªçc ƒë√∫ng √¢m ƒë·ªám nh∆∞ng v·∫´n t√≠nh l√† ƒë√∫ng)
            validAnswers.push((item.pre + " " + targetRaw).toLowerCase()); 
        } 
        
        let maxScore = 0; 
        for (let text of heardArray) { 
            let userText = text.trim(); 
            for (let target of validAnswers) { 
                if (userText.includes(target) || target.includes(userText)) maxScore = 100; 
            } 
        } 
        
        let finalStars = 2; 
        let msg = "Try again!"; 
        if (maxScore >= 90) { 
            finalStars = 5; 
            msg = "Excellent!  üéâ "; 
            AudioEngine.playEffect('win'); 
        } else { 
            AudioEngine.playEffect('wrong'); 
        } 
        
        let s = ""; 
        for(let i=0; i<5; i++) s += (i < finalStars) ? "  ‚≠ê  " : "‚òÜ"; 
        document.getElementById('stars').innerText = s; 
        document.getElementById('stars').className = (finalStars === 5) ? "stars active" : "stars"; 
        document.getElementById('feedback').innerText = msg; 
        this.resetMic(); 
    }
};
const App = {
    // ... (Gi·ªØ nguy√™n initMenu, openIPA, closeIPA) ...
    initMenu: function() { /* ... code c≈© (nh·ªõ th√™m n√∫t B√†i 26 n·∫øu ch∆∞a c√≥ trong loop) ... */ 
        /* LevelMap loop t·ª± ƒë·ªông render b√†i 26 r·ªìi */
        const menuContainer = document.getElementById('menu-screen');
        menuContainer.innerHTML = '<div class="menu-title"> üìö  CH·ªåN B√ÄI H·ªåC</div>';
        const btnIPA = document.createElement('button');
        btnIPA.className = 'btn-menu'; btnIPA.innerText = "üî†  B·∫£ng Phi√™n √Çm (IPA)";
        btnIPA.style.borderColor = "#9C27B0"; btnIPA.style.color = "#9C27B0";
        btnIPA.onclick = function() { App.openIPA(); };
        menuContainer.appendChild(btnIPA);
        LevelMap.forEach(level => {
            if (level.type === 'learn') {
                const btn = document.createElement('button');
                btn.className = 'btn-menu'; btn.innerText = level.label;
                if (level.label.includes("√în t·∫≠p")) { btn.style.borderColor = "#ff9600"; btn.style.color = "#d35400"; }
                if (level.label.includes("THI TH·ª¨")) { btn.style.borderColor = "#e74c3c"; btn.style.color = "#c0392b"; btn.style.borderWidth = "4px"; }
                btn.onclick = function() { App.startLesson(level.id); };
                menuContainer.appendChild(btn);
            }
        });
    },
// --- LOGIC B·∫¢NG IPA ---
    openIPA: function() {
        document.getElementById('menu-screen').style.display = 'none';
        document.getElementById('ipa-screen').style.display = 'flex';
        
        const content = document.getElementById('ipa-content');
        content.innerHTML = ''; // Clear c≈©

        for (const [sectionName, soundFiles] of Object.entries(IPA_DATA)) {
            // T·∫°o ti√™u ƒë·ªÅ Section
            const secTitle = document.createElement('div');
            secTitle.className = 'ipa-sec-title';
            secTitle.innerText = sectionName;
            
            // ƒê·ªïi m√†u theo lo·∫°i
            if (sectionName.includes("Vowels")) secTitle.classList.add("bg-blue");
            else secTitle.classList.add("bg-green");
            
            content.appendChild(secTitle);

            // T·∫°o Grid
            const grid = document.createElement('div');
            grid.className = 'ipa-grid';

            soundFiles.forEach(fileName => {
                const item = document.createElement('div');
                item.className = 'ipa-item';
                // H√¨nh ·∫£nh: fileName + .jpg
                item.innerHTML = `<img src="${fileName}.jpg" onerror="this.style.display='none'">`;
                // Click -> Ph√°t √¢m thanh .wav
                item.onclick = function() {
                    const audio = new Audio(fileName + ".wav");
                    audio.play();
                    // Hi·ªáu ·ª©ng scale nh·∫π
                    this.style.transform = "scale(0.9)";
                    setTimeout(() => this.style.transform = "scale(1)", 150);
                };
                grid.appendChild(item);
            });

            content.appendChild(grid);
            content.appendChild(document.createElement('br'));
        }
    },

    closeIPA: function() {
        document.getElementById('ipa-screen').style.display = 'none';
        document.getElementById('menu-screen').style.display = 'flex';
    },
    startLesson: function(num) { AudioEngine.unlock(); document.getElementById('menu-screen').style.display = 'none'; document.getElementById('main-container').style.display = 'block'; LearningEngine.initLesson(num); LearningEngine.render(); },
enterGame: function() { document.getElementById('learning-screen').style.display = 'none'; document.getElementById('game-screen').style.display = 'flex'; const item = LearningEngine.currentData[LearningEngine.idx]; 
    let vocabList = [];
    // Qu√©t t√¨m b√†i h·ªçc ch·ª©a item hi·ªán t·∫°i
    for(let i=1; i<=25; i++) { 
        if(!DataEngine["lesson"+i]) continue;
        const lesson = DataEngine.getLesson(i); 
        if (lesson.includes(item)) { 
            vocabList = lesson.filter(l => l.img && l.type !== 'game'); 
            break; 
        } 
    }
    GameEngine.start(item, vocabList); },
    exitGame: function() { GameEngine.stop(); LearningEngine.render(); },
    goHome: function() { AudioEngine.stopAllAndBlock(); GameEngine.stop(); document.getElementById('main-container').style.display = 'none'; document.getElementById('menu-screen').style.display = 'flex'; }
};

window.onload = function() { AudioEngine.stopAllAndBlock(); App.initMenu(); };
window.addEventListener('keydown', (e) => { if (!SnakeEngine.active) return; if (e.key === 'ArrowUp') SnakeEngine.changeDirection('up'); else if (e.key === 'ArrowDown') SnakeEngine.changeDirection('down'); else if (e.key === 'ArrowLeft') SnakeEngine.changeDirection('left'); else if (e.key === 'ArrowRight') SnakeEngine.changeDirection('right'); });
</script>
</body>
</html>
